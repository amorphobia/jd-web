import{i as Od,a as Uo,r as K,b as Wn,h as Dd,e as ba,f as or,g as dn,d as xe,j as Fg,k as $g,l as m,m as lc,n as Yi,p as Lt,q as ys,s as Hg,t as Ko,v as Td,x as jg,y as Ii,z as ee,A as T,B as Pd,C as U,D as ge,E as Ld,F as Wg,G as ei,H as ct,I as Vg,J as ya,K as fe,L as qe,M as Bd,N as Ni,O as vi,P as ws,Q as wa,R as je,S as Ug,T as ri,V as _e,W as wi,X as qo,Y as Ir,Z as xs,_ as ks,$ as Cs,a0 as li,a1 as pe,a2 as rt,a3 as Ed,a4 as Ti,a5 as It,a6 as Kg,a7 as qg,a8 as _g,a9 as Gg,aa as Id,ab as Nd,ac as zd,ad as vn,ae as Nr,af as Fd,ag as Xg,ah as Dr,ai as Yg,aj as _o,ak as Al,al as $d,am as Jg,an as Hd,ao as jd,ap as Wd,aq as Zg,ar as Qg,as as xa,at as Ji,au as zr,av as Vd,aw as Sn,ax as em,ay as tm,az as im,aA as an,aB as nm,aC as Ud,aD as rm,aE as om,aF as sm,aG as Oi,aH as Fr,aI as Tr,aJ as lm,aK as ka,aL as Kd,aM as Ss,aN as qd,aO as am,aP as Tn,aQ as cm,aR as hm,aS as ac,aT as Ks,aU as Nn,aV as dm,aW as cc,aX as um,aY as fm,aZ as yt,a_ as pm,a$ as hc,b0 as gm,b1 as mm,b2 as vm,b3 as dc,b4 as bm,b5 as ym,b6 as uc,b7 as wm,b8 as xm,b9 as km,ba as Cm,bb as As,bc as _d,o as si,c as Rs,bd as Vt,be as it,u as we,bf as Gd,bg as Xd,bh as Ms,bi as Sm,bj as Gn,bk as Am,bl as bn,bm as qs,bn as Rm,bo as Mm,bp as Om,U as Dm,bq as Tm,br as Pm,bs as fc,bt as Lm,bu as Bm,bv as Em,bw as Im}from"./index-3b85ace0.js";function Yd(i){return typeof i=="string"?`s-${i}`:`n-${i}`}const Sr=K(null);function pc(i){if(i.clientX>0||i.clientY>0)Sr.value={x:i.clientX,y:i.clientY};else{const{target:e}=i;if(e instanceof Element){const{left:t,top:n,width:r,height:o}=e.getBoundingClientRect();t>0||n>0?Sr.value={x:t+r/2,y:n+o/2}:Sr.value={x:0,y:0}}else Sr.value=null}}let co=0,gc=!0;function Jd(){if(!Od)return Uo(K(null));co===0&&Wn("click",document,pc,!0);const i=()=>{co+=1};return gc&&(gc=Dd())?(ba(i),or(()=>{co-=1,co===0&&dn("click",document,pc,!0)})):i(),Uo(Sr)}const Nm=K(void 0);let ho=0;function mc(){Nm.value=Date.now()}let vc=!0;function Zd(i){if(!Od)return Uo(K(!1));const e=K(!1);let t=null;function n(){t!==null&&window.clearTimeout(t)}function r(){n(),e.value=!0,t=window.setTimeout(()=>{e.value=!1},i)}ho===0&&Wn("click",window,mc,!0);const o=()=>{ho+=1,Wn("click",window,r,!0)};return vc&&(vc=Dd())?(ba(o),or(()=>{ho-=1,ho===0&&dn("click",window,mc,!0),dn("click",window,r,!0),n()})):o(),Uo(e)}const zm=lc(".v-x-scroll",{overflow:"auto",scrollbarWidth:"none"},[lc("&::-webkit-scrollbar",{width:0,height:0})]),Fm=xe({name:"XScroll",props:{disabled:Boolean,onScroll:Function},setup(){const i=K(null);function e(r){!(r.currentTarget.offsetWidth<r.currentTarget.scrollWidth)||r.deltaY===0||(r.currentTarget.scrollLeft+=r.deltaY+r.deltaX,r.preventDefault())}const t=Fg();return zm.mount({id:"vueuc/x-scroll",head:!0,anchorMetaName:$g,ssr:t}),Object.assign({selfRef:i,handleWheel:e},{scrollTo(...r){var o;(o=i.value)===null||o===void 0||o.scrollTo(...r)}})},render(){return m("div",{ref:"selfRef",onScroll:this.onScroll,onWheel:this.disabled?void 0:this.handleWheel,class:"v-x-scroll"},this.$slots)}});let Pn=0,bc="",yc="",wc="",xc="";const kc=K("0px");function $m(i){if(typeof document>"u")return;const e=document.documentElement;let t,n=!1;const r=()=>{e.style.marginRight=bc,e.style.overflow=yc,e.style.overflowX=wc,e.style.overflowY=xc,kc.value="0px"};Yi(()=>{t=Lt(i,o=>{if(o){if(!Pn){const s=window.innerWidth-e.offsetWidth;s>0&&(bc=e.style.marginRight,e.style.marginRight=`${s}px`,kc.value=`${s}px`),yc=e.style.overflow,wc=e.style.overflowX,xc=e.style.overflowY,e.style.overflow="hidden",e.style.overflowX="hidden",e.style.overflowY="hidden"}n=!0,Pn++}else Pn--,Pn||r(),n=!1},{immediate:!0})}),or(()=>{t==null||t(),n&&(Pn--,Pn||r(),n=!1)})}const Ca=K(!1),Cc=()=>{Ca.value=!0},Sc=()=>{Ca.value=!1};let br=0;const Hm=()=>(ys&&(ba(()=>{br||(window.addEventListener("compositionstart",Cc),window.addEventListener("compositionend",Sc)),br++}),or(()=>{br<=1?(window.removeEventListener("compositionstart",Cc),window.removeEventListener("compositionend",Sc),br=0):br--})),Ca);var jm=/\s/;function Wm(i){for(var e=i.length;e--&&jm.test(i.charAt(e)););return e}var Vm=/^\s+/;function Um(i){return i&&i.slice(0,Wm(i)+1).replace(Vm,"")}var Ac=0/0,Km=/^[-+]0x[0-9a-f]+$/i,qm=/^0b[01]+$/i,_m=/^0o[0-7]+$/i,Gm=parseInt;function Rc(i){if(typeof i=="number")return i;if(Hg(i))return Ac;if(Ko(i)){var e=typeof i.valueOf=="function"?i.valueOf():i;i=Ko(e)?e+"":e}if(typeof i!="string")return i===0?i:+i;i=Um(i);var t=qm.test(i);return t||_m.test(i)?Gm(i.slice(2),t?2:8):Km.test(i)?Ac:+i}function Xm(i,e,t,n){var r=-1,o=i==null?0:i.length;for(n&&o&&(t=i[++r]);++r<o;)t=e(t,i[r],r,i);return t}function Ym(i){return function(e){return i==null?void 0:i[e]}}var Jm={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Zm=Ym(Jm);const Qm=Zm;var e0=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,t0="\\u0300-\\u036f",i0="\\ufe20-\\ufe2f",n0="\\u20d0-\\u20ff",r0=t0+i0+n0,o0="["+r0+"]",s0=RegExp(o0,"g");function l0(i){return i=Td(i),i&&i.replace(e0,Qm).replace(s0,"")}var a0=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function c0(i){return i.match(a0)||[]}var h0=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function d0(i){return h0.test(i)}var Qd="\\ud800-\\udfff",u0="\\u0300-\\u036f",f0="\\ufe20-\\ufe2f",p0="\\u20d0-\\u20ff",g0=u0+f0+p0,eu="\\u2700-\\u27bf",tu="a-z\\xdf-\\xf6\\xf8-\\xff",m0="\\xac\\xb1\\xd7\\xf7",v0="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",b0="\\u2000-\\u206f",y0=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",iu="A-Z\\xc0-\\xd6\\xd8-\\xde",w0="\\ufe0e\\ufe0f",nu=m0+v0+b0+y0,ru="['’]",Mc="["+nu+"]",x0="["+g0+"]",ou="\\d+",k0="["+eu+"]",su="["+tu+"]",lu="[^"+Qd+nu+ou+eu+tu+iu+"]",C0="\\ud83c[\\udffb-\\udfff]",S0="(?:"+x0+"|"+C0+")",A0="[^"+Qd+"]",au="(?:\\ud83c[\\udde6-\\uddff]){2}",cu="[\\ud800-\\udbff][\\udc00-\\udfff]",Bn="["+iu+"]",R0="\\u200d",Oc="(?:"+su+"|"+lu+")",M0="(?:"+Bn+"|"+lu+")",Dc="(?:"+ru+"(?:d|ll|m|re|s|t|ve))?",Tc="(?:"+ru+"(?:D|LL|M|RE|S|T|VE))?",hu=S0+"?",du="["+w0+"]?",O0="(?:"+R0+"(?:"+[A0,au,cu].join("|")+")"+du+hu+")*",D0="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",T0="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",P0=du+hu+O0,L0="(?:"+[k0,au,cu].join("|")+")"+P0,B0=RegExp([Bn+"?"+su+"+"+Dc+"(?="+[Mc,Bn,"$"].join("|")+")",M0+"+"+Tc+"(?="+[Mc,Bn+Oc,"$"].join("|")+")",Bn+"?"+Oc+"+"+Dc,Bn+"+"+Tc,T0,D0,ou,L0].join("|"),"g");function E0(i){return i.match(B0)||[]}function I0(i,e,t){return i=Td(i),e=t?void 0:e,e===void 0?d0(i)?E0(i):c0(i):i.match(e)||[]}var N0="['’]",z0=RegExp(N0,"g");function F0(i){return function(e){return Xm(I0(l0(e).replace(z0,"")),i,"")}}var $0=function(){return jg.Date.now()};const _s=$0;var H0="Expected a function",j0=Math.max,W0=Math.min;function V0(i,e,t){var n,r,o,s,l,a,c=0,h=!1,d=!1,u=!0;if(typeof i!="function")throw new TypeError(H0);e=Rc(e)||0,Ko(t)&&(h=!!t.leading,d="maxWait"in t,o=d?j0(Rc(t.maxWait)||0,e):o,u="trailing"in t?!!t.trailing:u);function f(C){var w=n,D=r;return n=r=void 0,c=C,s=i.apply(D,w),s}function g(C){return c=C,l=setTimeout(S,e),h?f(C):s}function x(C){var w=C-a,D=C-c,v=e-w;return d?W0(v,o-D):v}function b(C){var w=C-a,D=C-c;return a===void 0||w>=e||w<0||d&&D>=o}function S(){var C=_s();if(b(C))return A(C);l=setTimeout(S,x(C))}function A(C){return l=void 0,u&&n?f(C):(n=r=void 0,s)}function O(){l!==void 0&&clearTimeout(l),c=0,n=a=r=l=void 0}function R(){return l===void 0?s:A(_s())}function k(){var C=_s(),w=b(C);if(n=arguments,r=this,a=C,w){if(l===void 0)return g(a);if(d)return clearTimeout(l),l=setTimeout(S,e),f(a)}return l===void 0&&(l=setTimeout(S,e)),s}return k.cancel=O,k.flush=R,k}var U0=F0(function(i,e,t){return i+(t?"-":"")+e.toLowerCase()});const K0=U0;var q0="Expected a function";function Gs(i,e,t){var n=!0,r=!0;if(typeof i!="function")throw new TypeError(q0);return Ko(t)&&(n="leading"in t?!!t.leading:n,r="trailing"in t?!!t.trailing:r),V0(i,e,{leading:n,maxWait:e,trailing:r})}const uu=xe({name:"Add",render(){return m("svg",{width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},m("path",{d:"M256 112V400M400 256H112",stroke:"currentColor","stroke-width":"32","stroke-linecap":"round","stroke-linejoin":"round"}))}}),_0=Ii("attach",m("svg",{viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},m("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},m("g",{fill:"currentColor","fill-rule":"nonzero"},m("path",{d:"M3.25735931,8.70710678 L7.85355339,4.1109127 C8.82986412,3.13460197 10.4127766,3.13460197 11.3890873,4.1109127 C12.365398,5.08722343 12.365398,6.67013588 11.3890873,7.64644661 L6.08578644,12.9497475 C5.69526215,13.3402718 5.06209717,13.3402718 4.67157288,12.9497475 C4.28104858,12.5592232 4.28104858,11.9260582 4.67157288,11.5355339 L9.97487373,6.23223305 C10.1701359,6.0369709 10.1701359,5.72038841 9.97487373,5.52512627 C9.77961159,5.32986412 9.4630291,5.32986412 9.26776695,5.52512627 L3.96446609,10.8284271 C3.18341751,11.6094757 3.18341751,12.8758057 3.96446609,13.6568542 C4.74551468,14.4379028 6.01184464,14.4379028 6.79289322,13.6568542 L12.0961941,8.35355339 C13.4630291,6.98671837 13.4630291,4.77064094 12.0961941,3.40380592 C10.7293591,2.0369709 8.51328163,2.0369709 7.14644661,3.40380592 L2.55025253,8 C2.35499039,8.19526215 2.35499039,8.51184464 2.55025253,8.70710678 C2.74551468,8.90236893 3.06209717,8.90236893 3.25735931,8.70710678 Z"}))))),G0=Ii("trash",m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},m("path",{d:"M432,144,403.33,419.74A32,32,0,0,1,371.55,448H140.46a32,32,0,0,1-31.78-28.26L80,144",style:"fill: none; stroke: currentcolor; stroke-linecap: round; stroke-linejoin: round; stroke-width: 32px;"}),m("rect",{x:"32",y:"64",width:"448",height:"80",rx:"16",ry:"16",style:"fill: none; stroke: currentcolor; stroke-linecap: round; stroke-linejoin: round; stroke-width: 32px;"}),m("line",{x1:"312",y1:"240",x2:"200",y2:"352",style:"fill: none; stroke: currentcolor; stroke-linecap: round; stroke-linejoin: round; stroke-width: 32px;"}),m("line",{x1:"312",y1:"352",x2:"200",y2:"240",style:"fill: none; stroke: currentcolor; stroke-linecap: round; stroke-linejoin: round; stroke-width: 32px;"}))),X0=Ii("download",m("svg",{viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},m("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},m("g",{fill:"currentColor","fill-rule":"nonzero"},m("path",{d:"M3.5,13 L12.5,13 C12.7761424,13 13,13.2238576 13,13.5 C13,13.7454599 12.8231248,13.9496084 12.5898756,13.9919443 L12.5,14 L3.5,14 C3.22385763,14 3,13.7761424 3,13.5 C3,13.2545401 3.17687516,13.0503916 3.41012437,13.0080557 L3.5,13 L12.5,13 L3.5,13 Z M7.91012437,1.00805567 L8,1 C8.24545989,1 8.44960837,1.17687516 8.49194433,1.41012437 L8.5,1.5 L8.5,10.292 L11.1819805,7.6109127 C11.3555469,7.43734635 11.6249713,7.4180612 11.8198394,7.55305725 L11.8890873,7.6109127 C12.0626536,7.78447906 12.0819388,8.05390346 11.9469427,8.2487716 L11.8890873,8.31801948 L8.35355339,11.8535534 C8.17998704,12.0271197 7.91056264,12.0464049 7.7156945,11.9114088 L7.64644661,11.8535534 L4.1109127,8.31801948 C3.91565056,8.12275734 3.91565056,7.80617485 4.1109127,7.6109127 C4.28447906,7.43734635 4.55390346,7.4180612 4.7487716,7.55305725 L4.81801948,7.6109127 L7.5,10.292 L7.5,1.5 C7.5,1.25454011 7.67687516,1.05039163 7.91012437,1.00805567 L8,1 L7.91012437,1.00805567 Z"}))))),Y0=xe({name:"Switcher",render(){return m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},m("path",{d:"M12 8l10 8l-10 8z"}))}}),J0=Ii("cancel",m("svg",{viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},m("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},m("g",{fill:"currentColor","fill-rule":"nonzero"},m("path",{d:"M2.58859116,2.7156945 L2.64644661,2.64644661 C2.82001296,2.47288026 3.08943736,2.45359511 3.2843055,2.58859116 L3.35355339,2.64644661 L8,7.293 L12.6464466,2.64644661 C12.8417088,2.45118446 13.1582912,2.45118446 13.3535534,2.64644661 C13.5488155,2.84170876 13.5488155,3.15829124 13.3535534,3.35355339 L8.707,8 L13.3535534,12.6464466 C13.5271197,12.820013 13.5464049,13.0894374 13.4114088,13.2843055 L13.3535534,13.3535534 C13.179987,13.5271197 12.9105626,13.5464049 12.7156945,13.4114088 L12.6464466,13.3535534 L8,8.707 L3.35355339,13.3535534 C3.15829124,13.5488155 2.84170876,13.5488155 2.64644661,13.3535534 C2.45118446,13.1582912 2.45118446,12.8417088 2.64644661,12.6464466 L7.293,8 L2.64644661,3.35355339 C2.47288026,3.17998704 2.45359511,2.91056264 2.58859116,2.7156945 L2.64644661,2.64644661 L2.58859116,2.7156945 Z"}))))),Z0=Ii("retry",m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},m("path",{d:"M320,146s24.36-12-64-12A160,160,0,1,0,416,294",style:"fill: none; stroke: currentcolor; stroke-linecap: round; stroke-miterlimit: 10; stroke-width: 32px;"}),m("polyline",{points:"256 58 336 138 256 218",style:"fill: none; stroke: currentcolor; stroke-linecap: round; stroke-linejoin: round; stroke-width: 32px;"}))),Q0=Ii("rotateClockwise",m("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},m("path",{d:"M3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10C17 12.7916 15.3658 15.2026 13 16.3265V14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5V17.5C12 17.7761 12.2239 18 12.5 18H15.5C15.7761 18 16 17.7761 16 17.5C16 17.2239 15.7761 17 15.5 17H13.8758C16.3346 15.6357 18 13.0128 18 10C18 5.58172 14.4183 2 10 2C5.58172 2 2 5.58172 2 10C2 10.2761 2.22386 10.5 2.5 10.5C2.77614 10.5 3 10.2761 3 10Z",fill:"currentColor"}),m("path",{d:"M10 12C11.1046 12 12 11.1046 12 10C12 8.89543 11.1046 8 10 8C8.89543 8 8 8.89543 8 10C8 11.1046 8.89543 12 10 12ZM10 11C9.44772 11 9 10.5523 9 10C9 9.44772 9.44772 9 10 9C10.5523 9 11 9.44772 11 10C11 10.5523 10.5523 11 10 11Z",fill:"currentColor"}))),ev=Ii("rotateClockwise",m("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},m("path",{d:"M17 10C17 6.13401 13.866 3 10 3C6.13401 3 3 6.13401 3 10C3 12.7916 4.63419 15.2026 7 16.3265V14.5C7 14.2239 7.22386 14 7.5 14C7.77614 14 8 14.2239 8 14.5V17.5C8 17.7761 7.77614 18 7.5 18H4.5C4.22386 18 4 17.7761 4 17.5C4 17.2239 4.22386 17 4.5 17H6.12422C3.66539 15.6357 2 13.0128 2 10C2 5.58172 5.58172 2 10 2C14.4183 2 18 5.58172 18 10C18 10.2761 17.7761 10.5 17.5 10.5C17.2239 10.5 17 10.2761 17 10Z",fill:"currentColor"}),m("path",{d:"M10 12C8.89543 12 8 11.1046 8 10C8 8.89543 8.89543 8 10 8C11.1046 8 12 8.89543 12 10C12 11.1046 11.1046 12 10 12ZM10 11C10.5523 11 11 10.5523 11 10C11 9.44772 10.5523 9 10 9C9.44772 9 9 9.44772 9 10C9 10.5523 9.44772 11 10 11Z",fill:"currentColor"}))),tv=Ii("zoomIn",m("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},m("path",{d:"M11.5 8.5C11.5 8.22386 11.2761 8 11 8H9V6C9 5.72386 8.77614 5.5 8.5 5.5C8.22386 5.5 8 5.72386 8 6V8H6C5.72386 8 5.5 8.22386 5.5 8.5C5.5 8.77614 5.72386 9 6 9H8V11C8 11.2761 8.22386 11.5 8.5 11.5C8.77614 11.5 9 11.2761 9 11V9H11C11.2761 9 11.5 8.77614 11.5 8.5Z",fill:"currentColor"}),m("path",{d:"M8.5 3C11.5376 3 14 5.46243 14 8.5C14 9.83879 13.5217 11.0659 12.7266 12.0196L16.8536 16.1464C17.0488 16.3417 17.0488 16.6583 16.8536 16.8536C16.68 17.0271 16.4106 17.0464 16.2157 16.9114L16.1464 16.8536L12.0196 12.7266C11.0659 13.5217 9.83879 14 8.5 14C5.46243 14 3 11.5376 3 8.5C3 5.46243 5.46243 3 8.5 3ZM8.5 4C6.01472 4 4 6.01472 4 8.5C4 10.9853 6.01472 13 8.5 13C10.9853 13 13 10.9853 13 8.5C13 6.01472 10.9853 4 8.5 4Z",fill:"currentColor"}))),iv=Ii("zoomOut",m("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},m("path",{d:"M11 8C11.2761 8 11.5 8.22386 11.5 8.5C11.5 8.77614 11.2761 9 11 9H6C5.72386 9 5.5 8.77614 5.5 8.5C5.5 8.22386 5.72386 8 6 8H11Z",fill:"currentColor"}),m("path",{d:"M14 8.5C14 5.46243 11.5376 3 8.5 3C5.46243 3 3 5.46243 3 8.5C3 11.5376 5.46243 14 8.5 14C9.83879 14 11.0659 13.5217 12.0196 12.7266L16.1464 16.8536L16.2157 16.9114C16.4106 17.0464 16.68 17.0271 16.8536 16.8536C17.0488 16.6583 17.0488 16.3417 16.8536 16.1464L12.7266 12.0196C13.5217 11.0659 14 9.83879 14 8.5ZM4 8.5C4 6.01472 6.01472 4 8.5 4C10.9853 4 13 6.01472 13 8.5C13 10.9853 10.9853 13 8.5 13C6.01472 13 4 10.9853 4 8.5Z",fill:"currentColor"}))),nv=xe({name:"ResizeSmall",render(){return m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},m("g",{fill:"none"},m("path",{d:"M5.5 4A1.5 1.5 0 0 0 4 5.5v1a.5.5 0 0 1-1 0v-1A2.5 2.5 0 0 1 5.5 3h1a.5.5 0 0 1 0 1h-1zM16 5.5A1.5 1.5 0 0 0 14.5 4h-1a.5.5 0 0 1 0-1h1A2.5 2.5 0 0 1 17 5.5v1a.5.5 0 0 1-1 0v-1zm0 9a1.5 1.5 0 0 1-1.5 1.5h-1a.5.5 0 0 0 0 1h1a2.5 2.5 0 0 0 2.5-2.5v-1a.5.5 0 0 0-1 0v1zm-12 0A1.5 1.5 0 0 0 5.5 16h1.25a.5.5 0 0 1 0 1H5.5A2.5 2.5 0 0 1 3 14.5v-1.25a.5.5 0 0 1 1 0v1.25zM8.5 7A1.5 1.5 0 0 0 7 8.5v3A1.5 1.5 0 0 0 8.5 13h3a1.5 1.5 0 0 0 1.5-1.5v-3A1.5 1.5 0 0 0 11.5 7h-3zM8 8.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-3z",fill:"currentColor"})))}}),Xs=ys&&"loading"in document.createElement("img"),rv=(i={})=>{var e;const{root:t=null}=i;return{hash:`${i.rootMargin||"0px 0px 0px 0px"}-${Array.isArray(i.threshold)?i.threshold.join(","):(e=i.threshold)!==null&&e!==void 0?e:"0"}`,options:Object.assign(Object.assign({},i),{root:(typeof t=="string"?document.querySelector(t):t)||document.documentElement})}},Ys=new WeakMap,Js=new WeakMap,Zs=new WeakMap,ov=(i,e,t)=>{if(!i)return()=>{};const n=rv(e),{root:r}=n.options;let o;const s=Ys.get(r);s?o=s:(o=new Map,Ys.set(r,o));let l,a;o.has(n.hash)?(a=o.get(n.hash),a[1].has(i)||(l=a[0],a[1].add(i),l.observe(i))):(l=new IntersectionObserver(d=>{d.forEach(u=>{if(u.isIntersecting){const f=Js.get(u.target),g=Zs.get(u.target);f&&f(),g&&(g.value=!0)}})},n.options),l.observe(i),a=[l,new Set([i])],o.set(n.hash,a));let c=!1;const h=()=>{c||(Js.delete(i),Zs.delete(i),c=!0,a[1].has(i)&&(a[0].unobserve(i),a[1].delete(i)),a[1].size<=0&&o.delete(n.hash),o.size||Ys.delete(r))};return Js.set(i,h),Zs.set(i,t),h},sv=ee([T("card",`
 font-size: var(--n-font-size);
 line-height: var(--n-line-height);
 display: flex;
 flex-direction: column;
 width: 100%;
 box-sizing: border-box;
 position: relative;
 border-radius: var(--n-border-radius);
 background-color: var(--n-color);
 color: var(--n-text-color);
 word-break: break-word;
 transition: 
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[Pd({background:"var(--n-color-modal)"}),U("hoverable",[ee("&:hover","box-shadow: var(--n-box-shadow);")]),U("content-segmented",[ee(">",[ge("content",{paddingTop:"var(--n-padding-bottom)"})])]),U("content-soft-segmented",[ee(">",[ge("content",`
 margin: 0 var(--n-padding-left);
 padding: var(--n-padding-bottom) 0;
 `)])]),U("footer-segmented",[ee(">",[ge("footer",{paddingTop:"var(--n-padding-bottom)"})])]),U("footer-soft-segmented",[ee(">",[ge("footer",`
 padding: var(--n-padding-bottom) 0;
 margin: 0 var(--n-padding-left);
 `)])]),ee(">",[T("card-header",`
 box-sizing: border-box;
 display: flex;
 align-items: center;
 font-size: var(--n-title-font-size);
 padding:
 var(--n-padding-top)
 var(--n-padding-left)
 var(--n-padding-bottom)
 var(--n-padding-left);
 `,[ge("main",`
 font-weight: var(--n-title-font-weight);
 transition: color .3s var(--n-bezier);
 flex: 1;
 min-width: 0;
 color: var(--n-title-text-color);
 `),ge("extra",`
 display: flex;
 align-items: center;
 font-size: var(--n-font-size);
 font-weight: 400;
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 `),ge("close",`
 margin: 0 0 0 8px;
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `)]),ge("action",`
 box-sizing: border-box;
 transition:
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 background-clip: padding-box;
 background-color: var(--n-action-color);
 `),ge("content","flex: 1; min-width: 0;"),ge("content, footer",`
 box-sizing: border-box;
 padding: 0 var(--n-padding-left) var(--n-padding-bottom) var(--n-padding-left);
 font-size: var(--n-font-size);
 `,[ee("&:first-child",{paddingTop:"var(--n-padding-bottom)"})]),ge("action",`
 background-color: var(--n-action-color);
 padding: var(--n-padding-bottom) var(--n-padding-left);
 border-bottom-left-radius: var(--n-border-radius);
 border-bottom-right-radius: var(--n-border-radius);
 `)]),T("card-cover",`
 overflow: hidden;
 width: 100%;
 border-radius: var(--n-border-radius) var(--n-border-radius) 0 0;
 `,[ee("img",`
 display: block;
 width: 100%;
 `)]),U("bordered",`
 border: 1px solid var(--n-border-color);
 `,[ee("&:target","border-color: var(--n-color-target);")]),U("action-segmented",[ee(">",[ge("action",[ee("&:not(:first-child)",{borderTop:"1px solid var(--n-border-color)"})])])]),U("content-segmented, content-soft-segmented",[ee(">",[ge("content",{transition:"border-color 0.3s var(--n-bezier)"},[ee("&:not(:first-child)",{borderTop:"1px solid var(--n-border-color)"})])])]),U("footer-segmented, footer-soft-segmented",[ee(">",[ge("footer",{transition:"border-color 0.3s var(--n-bezier)"},[ee("&:not(:first-child)",{borderTop:"1px solid var(--n-border-color)"})])])]),U("embedded",`
 background-color: var(--n-color-embedded);
 `)]),Ld(T("card",`
 background: var(--n-color-modal);
 `,[U("embedded",`
 background-color: var(--n-color-embedded-modal);
 `)])),Wg(T("card",`
 background: var(--n-color-popover);
 `,[U("embedded",`
 background-color: var(--n-color-embedded-popover);
 `)]))]),Sa={title:String,contentStyle:[Object,String],headerStyle:[Object,String],headerExtraStyle:[Object,String],footerStyle:[Object,String],embedded:Boolean,segmented:{type:[Boolean,Object],default:!1},size:{type:String,default:"medium"},bordered:{type:Boolean,default:!0},closable:Boolean,hoverable:Boolean,role:String,onClose:[Function,Array],tag:{type:String,default:"div"}},lv=wa(Sa),av=Object.assign(Object.assign({},ct.props),Sa),cv=xe({name:"Card",props:av,setup(i){const e=()=>{const{onClose:c}=i;c&&je(c)},{inlineThemeDisabled:t,mergedClsPrefixRef:n,mergedRtlRef:r}=ei(i),o=ct("Card","-card",sv,Vg,i,n),s=ya("Card",r,n),l=fe(()=>{const{size:c}=i,{self:{color:h,colorModal:d,colorTarget:u,textColor:f,titleTextColor:g,titleFontWeight:x,borderColor:b,actionColor:S,borderRadius:A,lineHeight:O,closeIconColor:R,closeIconColorHover:k,closeIconColorPressed:C,closeColorHover:w,closeColorPressed:D,closeBorderRadius:v,closeIconSize:W,closeSize:q,boxShadow:ne,colorPopover:Y,colorEmbedded:re,colorEmbeddedModal:oe,colorEmbeddedPopover:$,[qe("padding",c)]:te,[qe("fontSize",c)]:E,[qe("titleFontSize",c)]:V},common:{cubicBezierEaseInOut:H}}=o.value,{top:G,left:ue,bottom:ke}=Bd(te);return{"--n-bezier":H,"--n-border-radius":A,"--n-color":h,"--n-color-modal":d,"--n-color-popover":Y,"--n-color-embedded":re,"--n-color-embedded-modal":oe,"--n-color-embedded-popover":$,"--n-color-target":u,"--n-text-color":f,"--n-line-height":O,"--n-action-color":S,"--n-title-text-color":g,"--n-title-font-weight":x,"--n-close-icon-color":R,"--n-close-icon-color-hover":k,"--n-close-icon-color-pressed":C,"--n-close-color-hover":w,"--n-close-color-pressed":D,"--n-border-color":b,"--n-box-shadow":ne,"--n-padding-top":G,"--n-padding-bottom":ke,"--n-padding-left":ue,"--n-font-size":E,"--n-title-font-size":V,"--n-close-size":q,"--n-close-icon-size":W,"--n-close-border-radius":v}}),a=t?Ni("card",fe(()=>i.size[0]),l,i):void 0;return{rtlEnabled:s,mergedClsPrefix:n,mergedTheme:o,handleCloseClick:e,cssVars:t?void 0:l,themeClass:a==null?void 0:a.themeClass,onRender:a==null?void 0:a.onRender}},render(){const{segmented:i,bordered:e,hoverable:t,mergedClsPrefix:n,rtlEnabled:r,onRender:o,embedded:s,tag:l,$slots:a}=this;return o==null||o(),m(l,{class:[`${n}-card`,this.themeClass,s&&`${n}-card--embedded`,{[`${n}-card--rtl`]:r,[`${n}-card--content${typeof i!="boolean"&&i.content==="soft"?"-soft":""}-segmented`]:i===!0||i!==!1&&i.content,[`${n}-card--footer${typeof i!="boolean"&&i.footer==="soft"?"-soft":""}-segmented`]:i===!0||i!==!1&&i.footer,[`${n}-card--action-segmented`]:i===!0||i!==!1&&i.action,[`${n}-card--bordered`]:e,[`${n}-card--hoverable`]:t}],style:this.cssVars,role:this.role},vi(a.cover,c=>c&&m("div",{class:`${n}-card-cover`,role:"none"},c)),vi(a.header,c=>c||this.title||this.closable?m("div",{class:`${n}-card-header`,style:this.headerStyle},m("div",{class:`${n}-card-header__main`,role:"heading"},c||this.title),vi(a["header-extra"],h=>h&&m("div",{class:`${n}-card-header__extra`,style:this.headerExtraStyle},h)),this.closable?m(ws,{clsPrefix:n,class:`${n}-card-header__close`,onClick:this.handleCloseClick,absolute:!0}):null):null),vi(a.default,c=>c&&m("div",{class:`${n}-card__content`,style:this.contentStyle,role:"none"},c)),vi(a.footer,c=>c&&[m("div",{class:`${n}-card__footer`,style:this.footerStyle,role:"none"},c)]),vi(a.action,c=>c&&m("div",{class:`${n}-card__action`,role:"none"},c)))}}),Os={icon:Function,type:{type:String,default:"default"},title:[String,Function],closable:{type:Boolean,default:!0},negativeText:String,positiveText:String,positiveButtonProps:Object,negativeButtonProps:Object,content:[String,Function],action:Function,showIcon:{type:Boolean,default:!0},loading:Boolean,bordered:Boolean,iconPlacement:String,onPositiveClick:Function,onNegativeClick:Function,onClose:Function},fu=wa(Os),hv=ee([T("dialog",`
 word-break: break-word;
 line-height: var(--n-line-height);
 position: relative;
 background: var(--n-color);
 color: var(--n-text-color);
 box-sizing: border-box;
 margin: auto;
 border-radius: var(--n-border-radius);
 padding: var(--n-padding);
 transition: 
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `,[ge("icon",{color:"var(--n-icon-color)"}),U("bordered",{border:"var(--n-border)"}),U("icon-top",[ge("close",{margin:"var(--n-close-margin)"}),ge("icon",{margin:"var(--n-icon-margin)"}),ge("content",{textAlign:"center"}),ge("title",{justifyContent:"center"}),ge("action",{justifyContent:"center"})]),U("icon-left",[ge("icon",{margin:"var(--n-icon-margin)"}),U("closable",[ge("title",`
 padding-right: calc(var(--n-close-size) + 6px);
 `)])]),ge("close",`
 position: absolute;
 right: 0;
 top: 0;
 margin: var(--n-close-margin);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 z-index: 1;
 `),ge("content",`
 font-size: var(--n-font-size);
 margin: var(--n-content-margin);
 position: relative;
 word-break: break-word;
 `,[U("last","margin-bottom: 0;")]),ge("action",`
 display: flex;
 justify-content: flex-end;
 `,[ee("> *:not(:last-child)",{marginRight:"var(--n-action-space)"})]),ge("icon",{fontSize:"var(--n-icon-size)",transition:"color .3s var(--n-bezier)"}),ge("title",`
 transition: color .3s var(--n-bezier);
 display: flex;
 align-items: center;
 font-size: var(--n-title-font-size);
 font-weight: var(--n-title-font-weight);
 color: var(--n-title-text-color);
 `),T("dialog-icon-container",{display:"flex",justifyContent:"center"})]),Ld(T("dialog",`
 width: 446px;
 max-width: calc(100vw - 32px);
 `)),T("dialog",[Pd(`
 width: 446px;
 max-width: calc(100vw - 32px);
 `)])]),dv={default:()=>m(Ir,null),info:()=>m(Ir,null),success:()=>m(xs,null),warning:()=>m(ks,null),error:()=>m(Cs,null)},pu=xe({name:"Dialog",alias:["NimbusConfirmCard","Confirm"],props:Object.assign(Object.assign({},ct.props),Os),setup(i){const{mergedComponentPropsRef:e,mergedClsPrefixRef:t,inlineThemeDisabled:n}=ei(i),r=fe(()=>{var d,u;const{iconPlacement:f}=i;return f||((u=(d=e==null?void 0:e.value)===null||d===void 0?void 0:d.Dialog)===null||u===void 0?void 0:u.iconPlacement)||"left"});function o(d){const{onPositiveClick:u}=i;u&&u(d)}function s(d){const{onNegativeClick:u}=i;u&&u(d)}function l(){const{onClose:d}=i;d&&d()}const a=ct("Dialog","-dialog",hv,Ug,i,t),c=fe(()=>{const{type:d}=i,u=r.value,{common:{cubicBezierEaseInOut:f},self:{fontSize:g,lineHeight:x,border:b,titleTextColor:S,textColor:A,color:O,closeBorderRadius:R,closeColorHover:k,closeColorPressed:C,closeIconColor:w,closeIconColorHover:D,closeIconColorPressed:v,closeIconSize:W,borderRadius:q,titleFontWeight:ne,titleFontSize:Y,padding:re,iconSize:oe,actionSpace:$,contentMargin:te,closeSize:E,[u==="top"?"iconMarginIconTop":"iconMargin"]:V,[u==="top"?"closeMarginIconTop":"closeMargin"]:H,[qe("iconColor",d)]:G}}=a.value;return{"--n-font-size":g,"--n-icon-color":G,"--n-bezier":f,"--n-close-margin":H,"--n-icon-margin":V,"--n-icon-size":oe,"--n-close-size":E,"--n-close-icon-size":W,"--n-close-border-radius":R,"--n-close-color-hover":k,"--n-close-color-pressed":C,"--n-close-icon-color":w,"--n-close-icon-color-hover":D,"--n-close-icon-color-pressed":v,"--n-color":O,"--n-text-color":A,"--n-border-radius":q,"--n-padding":re,"--n-line-height":x,"--n-border":b,"--n-content-margin":te,"--n-title-font-size":Y,"--n-title-font-weight":ne,"--n-title-text-color":S,"--n-action-space":$}}),h=n?Ni("dialog",fe(()=>`${i.type[0]}${r.value[0]}`),c,i):void 0;return{mergedClsPrefix:t,mergedIconPlacement:r,mergedTheme:a,handlePositiveClick:o,handleNegativeClick:s,handleCloseClick:l,cssVars:n?void 0:c,themeClass:h==null?void 0:h.themeClass,onRender:h==null?void 0:h.onRender}},render(){var i;const{bordered:e,mergedIconPlacement:t,cssVars:n,closable:r,showIcon:o,title:s,content:l,action:a,negativeText:c,positiveText:h,positiveButtonProps:d,negativeButtonProps:u,handlePositiveClick:f,handleNegativeClick:g,mergedTheme:x,loading:b,type:S,mergedClsPrefix:A}=this;(i=this.onRender)===null||i===void 0||i.call(this);const O=o?m(_e,{clsPrefix:A,class:`${A}-dialog__icon`},{default:()=>vi(this.$slots.icon,k=>k||(this.icon?ri(this.icon):dv[this.type]()))}):null,R=vi(this.$slots.action,k=>k||h||c||a?m("div",{class:`${A}-dialog__action`},k||(a?[ri(a)]:[this.negativeText&&m(wi,Object.assign({theme:x.peers.Button,themeOverrides:x.peerOverrides.Button,ghost:!0,size:"small",onClick:g},u),{default:()=>ri(this.negativeText)}),this.positiveText&&m(wi,Object.assign({theme:x.peers.Button,themeOverrides:x.peerOverrides.Button,size:"small",type:S==="default"?"primary":S,disabled:b,loading:b,onClick:f},d),{default:()=>ri(this.positiveText)})])):null);return m("div",{class:[`${A}-dialog`,this.themeClass,this.closable&&`${A}-dialog--closable`,`${A}-dialog--icon-${t}`,e&&`${A}-dialog--bordered`],style:n,role:"dialog"},r?m(ws,{clsPrefix:A,class:`${A}-dialog__close`,onClick:this.handleCloseClick}):null,o&&t==="top"?m("div",{class:`${A}-dialog-icon-container`},O):null,m("div",{class:`${A}-dialog__title`},o&&t==="left"?O:null,qo(this.$slots.header,()=>[ri(s)])),m("div",{class:[`${A}-dialog__content`,R?"":`${A}-dialog__content--last`]},qo(this.$slots.default,()=>[ri(l)])),R)}}),gu=li("n-dialog-provider"),mu=li("n-dialog-api"),uv=li("n-dialog-reactive-list"),Aa=Object.assign(Object.assign({},Sa),Os),fv=wa(Aa),pv=xe({name:"ModalBody",inheritAttrs:!1,props:Object.assign(Object.assign({show:{type:Boolean,required:!0},preset:String,displayDirective:{type:String,required:!0},trapFocus:{type:Boolean,default:!0},autoFocus:{type:Boolean,default:!0},blockScroll:Boolean},Aa),{renderMask:Function,onClickoutside:Function,onBeforeLeave:{type:Function,required:!0},onAfterLeave:{type:Function,required:!0},onPositiveClick:{type:Function,required:!0},onNegativeClick:{type:Function,required:!0},onClose:{type:Function,required:!0},onAfterEnter:Function,onEsc:Function}),setup(i){const e=K(null),t=K(null),n=K(i.show),r=K(null),o=K(null);Lt(pe(i,"show"),b=>{b&&(n.value=!0)}),$m(fe(()=>i.blockScroll&&n.value));const s=rt(Ed);function l(){if(s.transformOriginRef.value==="center")return"";const{value:b}=r,{value:S}=o;if(b===null||S===null)return"";if(t.value){const A=t.value.containerScrollTop;return`${b}px ${S+A}px`}return""}function a(b){if(s.transformOriginRef.value==="center")return;const S=s.getMousePosition();if(!S||!t.value)return;const A=t.value.containerScrollTop,{offsetLeft:O,offsetTop:R}=b;if(S){const k=S.y,C=S.x;r.value=-(O-C),o.value=-(R-k-A)}b.style.transformOrigin=l()}function c(b){Ti(()=>{a(b)})}function h(b){b.style.transformOrigin=l(),i.onBeforeLeave()}function d(){n.value=!1,r.value=null,o.value=null,i.onAfterLeave()}function u(){const{onClose:b}=i;b&&b()}function f(){i.onNegativeClick()}function g(){i.onPositiveClick()}const x=K(null);return Lt(x,b=>{b&&Ti(()=>{const S=b.el;S&&e.value!==S&&(e.value=S)})}),It(Kg,e),It(qg,null),It(_g,null),{mergedTheme:s.mergedThemeRef,appear:s.appearRef,isMounted:s.isMountedRef,mergedClsPrefix:s.mergedClsPrefixRef,bodyRef:e,scrollbarRef:t,displayed:n,childNodeRef:x,handlePositiveClick:g,handleNegativeClick:f,handleCloseClick:u,handleAfterLeave:d,handleBeforeLeave:h,handleEnter:c}},render(){const{$slots:i,$attrs:e,handleEnter:t,handleAfterLeave:n,handleBeforeLeave:r,preset:o,mergedClsPrefix:s}=this;let l=null;if(!o){if(l=Gg(i),!l){Id("modal","default slot is empty");return}l=Nd(l),l.props=zd({class:`${s}-modal`},e,l.props||{})}return this.displayDirective==="show"||this.displayed||this.show?vn(m("div",{role:"none",class:`${s}-modal-body-wrapper`},m(Fd,{ref:"scrollbarRef",theme:this.mergedTheme.peers.Scrollbar,themeOverrides:this.mergedTheme.peerOverrides.Scrollbar,contentClass:`${s}-modal-scroll-content`},{default:()=>{var a;return[(a=this.renderMask)===null||a===void 0?void 0:a.call(this),m(Xg,{disabled:!this.trapFocus,active:this.show,onEsc:this.onEsc,autoFocus:this.autoFocus},{default:()=>{var c;return m(Dr,{name:"fade-in-scale-up-transition",appear:(c=this.appear)!==null&&c!==void 0?c:this.isMounted,onEnter:t,onAfterEnter:this.onAfterEnter,onAfterLeave:n,onBeforeLeave:r},{default:()=>{const h=[[Nr,this.show]],{onClickoutside:d}=this;return d&&h.push([Yg,this.onClickoutside,void 0,{capture:!0}]),vn(this.preset==="confirm"||this.preset==="dialog"?m(pu,Object.assign({},this.$attrs,{class:[`${s}-modal`,this.$attrs.class],ref:"bodyRef",theme:this.mergedTheme.peers.Dialog,themeOverrides:this.mergedTheme.peerOverrides.Dialog},_o(this.$props,fu),{"aria-modal":"true"}),i):this.preset==="card"?m(cv,Object.assign({},this.$attrs,{ref:"bodyRef",class:[`${s}-modal`,this.$attrs.class],theme:this.mergedTheme.peers.Card,themeOverrides:this.mergedTheme.peerOverrides.Card},_o(this.$props,lv),{"aria-modal":"true",role:"dialog"}),i):this.childNodeRef=l,h)}})}})]}})),[[Nr,this.displayDirective==="if"||this.displayed||this.show]]):null}}),gv=ee([T("modal-container",`
 position: fixed;
 left: 0;
 top: 0;
 height: 0;
 width: 0;
 display: flex;
 `),T("modal-mask",`
 position: fixed;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 background-color: rgba(0, 0, 0, .4);
 `,[Al({enterDuration:".25s",leaveDuration:".25s",enterCubicBezier:"var(--n-bezier-ease-out)",leaveCubicBezier:"var(--n-bezier-ease-out)"})]),T("modal-body-wrapper",`
 position: fixed;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 overflow: visible;
 `,[T("modal-scroll-content",`
 min-height: 100%;
 display: flex;
 position: relative;
 `)]),T("modal",`
 position: relative;
 align-self: center;
 color: var(--n-text-color);
 margin: auto;
 box-shadow: var(--n-box-shadow);
 `,[$d({duration:".25s",enterScale:".5"})])]),mv=Object.assign(Object.assign(Object.assign(Object.assign({},ct.props),{show:Boolean,unstableShowMask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},preset:String,to:[String,Object],displayDirective:{type:String,default:"if"},transformOrigin:{type:String,default:"mouse"},zIndex:Number,autoFocus:{type:Boolean,default:!0},trapFocus:{type:Boolean,default:!0},closeOnEsc:{type:Boolean,default:!0},blockScroll:{type:Boolean,default:!0}}),Aa),{onEsc:Function,"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],onAfterEnter:Function,onBeforeLeave:Function,onAfterLeave:Function,onClose:Function,onPositiveClick:Function,onNegativeClick:Function,onMaskClick:Function,internalDialog:Boolean,internalAppear:{type:Boolean,default:void 0},overlayStyle:[String,Object],onBeforeHide:Function,onAfterHide:Function,onHide:Function}),vv=xe({name:"Modal",inheritAttrs:!1,props:mv,setup(i){const e=K(null),{mergedClsPrefixRef:t,namespaceRef:n,inlineThemeDisabled:r}=ei(i),o=ct("Modal","-modal",gv,Jg,i,t),s=Zd(64),l=Jd(),a=Hd(),c=i.internalDialog?rt(gu,null):null,h=Hm();function d(k){const{onUpdateShow:C,"onUpdate:show":w,onHide:D}=i;C&&je(C,k),w&&je(w,k),D&&!k&&D(k)}function u(){const{onClose:k}=i;k?Promise.resolve(k()).then(C=>{C!==!1&&d(!1)}):d(!1)}function f(){const{onPositiveClick:k}=i;k?Promise.resolve(k()).then(C=>{C!==!1&&d(!1)}):d(!1)}function g(){const{onNegativeClick:k}=i;k?Promise.resolve(k()).then(C=>{C!==!1&&d(!1)}):d(!1)}function x(){const{onBeforeLeave:k,onBeforeHide:C}=i;k&&je(k),C&&C()}function b(){const{onAfterLeave:k,onAfterHide:C}=i;k&&je(k),C&&C()}function S(k){var C;const{onMaskClick:w}=i;w&&w(k),i.maskClosable&&!((C=e.value)===null||C===void 0)&&C.contains(Zg(k))&&d(!1)}function A(k){var C;(C=i.onEsc)===null||C===void 0||C.call(i),i.show&&i.closeOnEsc&&Qg(k)&&!h.value&&d(!1)}It(Ed,{getMousePosition:()=>{if(c){const{clickedRef:k,clickPositionRef:C}=c;if(k.value&&C.value)return C.value}return s.value?l.value:null},mergedClsPrefixRef:t,mergedThemeRef:o,isMountedRef:a,appearRef:pe(i,"internalAppear"),transformOriginRef:pe(i,"transformOrigin")});const O=fe(()=>{const{common:{cubicBezierEaseOut:k},self:{boxShadow:C,color:w,textColor:D}}=o.value;return{"--n-bezier-ease-out":k,"--n-box-shadow":C,"--n-color":w,"--n-text-color":D}}),R=r?Ni("theme-class",void 0,O,i):void 0;return{mergedClsPrefix:t,namespace:n,isMounted:a,containerRef:e,presetProps:fe(()=>_o(i,fv)),handleEsc:A,handleAfterLeave:b,handleClickoutside:S,handleBeforeLeave:x,doUpdateShow:d,handleNegativeClick:g,handlePositiveClick:f,handleCloseClick:u,cssVars:r?void 0:O,themeClass:R==null?void 0:R.themeClass,onRender:R==null?void 0:R.onRender}},render(){const{mergedClsPrefix:i}=this;return m(Wd,{to:this.to,show:this.show},{default:()=>{var e;(e=this.onRender)===null||e===void 0||e.call(this);const{unstableShowMask:t}=this;return vn(m("div",{role:"none",ref:"containerRef",class:[`${i}-modal-container`,this.themeClass,this.namespace],style:this.cssVars},m(pv,Object.assign({style:this.overlayStyle},this.$attrs,{ref:"bodyWrapper",displayDirective:this.displayDirective,show:this.show,preset:this.preset,autoFocus:this.autoFocus,trapFocus:this.trapFocus,blockScroll:this.blockScroll},this.presetProps,{onEsc:this.handleEsc,onClose:this.handleCloseClick,onNegativeClick:this.handleNegativeClick,onPositiveClick:this.handlePositiveClick,onBeforeLeave:this.handleBeforeLeave,onAfterEnter:this.onAfterEnter,onAfterLeave:this.handleAfterLeave,onClickoutside:t?void 0:this.handleClickoutside,renderMask:t?()=>{var n;return m(Dr,{name:"fade-in-transition",key:"mask",appear:(n=this.internalAppear)!==null&&n!==void 0?n:this.isMounted},{default:()=>this.show?m("div",{"aria-hidden":!0,ref:"containerRef",class:`${i}-modal-mask`,onClick:this.handleClickoutside}):null})}:void 0}),this.$slots)),[[jd,{zIndex:this.zIndex,enabled:this.show}]])}})}}),bv=Object.assign(Object.assign({},Os),{onAfterEnter:Function,onAfterLeave:Function,transformOrigin:String,blockScroll:{type:Boolean,default:!0},closeOnEsc:{type:Boolean,default:!0},onEsc:Function,autoFocus:{type:Boolean,default:!0},internalStyle:[String,Object],maskClosable:{type:Boolean,default:!0},onPositiveClick:Function,onNegativeClick:Function,onClose:Function,onMaskClick:Function}),yv=xe({name:"DialogEnvironment",props:Object.assign(Object.assign({},bv),{internalKey:{type:String,required:!0},to:[String,Object],onInternalAfterLeave:{type:Function,required:!0}}),setup(i){const e=K(!0);function t(){const{onInternalAfterLeave:h,internalKey:d,onAfterLeave:u}=i;h&&h(d),u&&u()}function n(h){const{onPositiveClick:d}=i;d?Promise.resolve(d(h)).then(u=>{u!==!1&&a()}):a()}function r(h){const{onNegativeClick:d}=i;d?Promise.resolve(d(h)).then(u=>{u!==!1&&a()}):a()}function o(){const{onClose:h}=i;h?Promise.resolve(h()).then(d=>{d!==!1&&a()}):a()}function s(h){const{onMaskClick:d,maskClosable:u}=i;d&&(d(h),u&&a())}function l(){const{onEsc:h}=i;h&&h()}function a(){e.value=!1}function c(h){e.value=h}return{show:e,hide:a,handleUpdateShow:c,handleAfterLeave:t,handleCloseClick:o,handleNegativeClick:r,handlePositiveClick:n,handleMaskClick:s,handleEsc:l}},render(){const{handlePositiveClick:i,handleUpdateShow:e,handleNegativeClick:t,handleCloseClick:n,handleAfterLeave:r,handleMaskClick:o,handleEsc:s,to:l,maskClosable:a,show:c}=this;return m(vv,{show:c,onUpdateShow:e,onMaskClick:o,onEsc:s,to:l,maskClosable:a,onAfterEnter:this.onAfterEnter,onAfterLeave:r,closeOnEsc:this.closeOnEsc,blockScroll:this.blockScroll,autoFocus:this.autoFocus,transformOrigin:this.transformOrigin,internalAppear:!0,internalDialog:!0},{default:()=>m(pu,Object.assign({},_o(this.$props,fu),{style:this.internalStyle,onClose:n,onNegativeClick:t,onPositiveClick:i}))})}}),wv={injectionKey:String,to:[String,Object]},xv=xe({name:"DialogProvider",props:wv,setup(){const i=K([]),e={};function t(l={}){const a=zr(),c=Vd(Object.assign(Object.assign({},l),{key:a,destroy:()=>{e[`n-dialog-${a}`].hide()}}));return i.value.push(c),c}const n=["info","success","warning","error"].map(l=>a=>t(Object.assign(Object.assign({},a),{type:l})));function r(l){const{value:a}=i;a.splice(a.findIndex(c=>c.key===l),1)}function o(){Object.values(e).forEach(l=>l.hide())}const s={create:t,destroyAll:o,info:n[0],success:n[1],warning:n[2],error:n[3]};return It(mu,s),It(gu,{clickedRef:Zd(64),clickPositionRef:Jd()}),It(uv,i),Object.assign(Object.assign({},s),{dialogList:i,dialogInstRefs:e,handleAfterLeave:r})},render(){var i,e;return m(Ji,null,[this.dialogList.map(t=>m(yv,xa(t,["destroy","style"],{internalStyle:t.style,to:this.to,ref:n=>{n===null?delete this.dialogInstRefs[`n-dialog-${t.key}`]:this.dialogInstRefs[`n-dialog-${t.key}`]=n},internalKey:t.key,onInternalAfterLeave:this.handleAfterLeave}))),(e=(i=this.$slots).default)===null||e===void 0?void 0:e.call(i)])}});function kv(){const i=rt(mu,null);return i===null&&Sn("use-dialog","No outer <n-dialog-provider /> founded."),i}const Ra=Object.assign(Object.assign({},ct.props),{showToolbar:{type:Boolean,default:!0},showToolbarTooltip:Boolean}),vu=li("n-image");function Cv(){return{toolbarIconColor:"rgba(255, 255, 255, .9)",toolbarColor:"rgba(0, 0, 0, .35)",toolbarBoxShadow:"none",toolbarBorderRadius:"24px"}}const Sv=em({name:"Image",common:tm,peers:{Tooltip:im},self:Cv}),Av=m("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},m("path",{d:"M6 5C5.75454 5 5.55039 5.17688 5.50806 5.41012L5.5 5.5V14.5C5.5 14.7761 5.72386 15 6 15C6.24546 15 6.44961 14.8231 6.49194 14.5899L6.5 14.5V5.5C6.5 5.22386 6.27614 5 6 5ZM13.8536 5.14645C13.68 4.97288 13.4106 4.9536 13.2157 5.08859L13.1464 5.14645L8.64645 9.64645C8.47288 9.82001 8.4536 10.0894 8.58859 10.2843L8.64645 10.3536L13.1464 14.8536C13.3417 15.0488 13.6583 15.0488 13.8536 14.8536C14.0271 14.68 14.0464 14.4106 13.9114 14.2157L13.8536 14.1464L9.70711 10L13.8536 5.85355C14.0488 5.65829 14.0488 5.34171 13.8536 5.14645Z",fill:"currentColor"})),Rv=m("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},m("path",{d:"M13.5 5C13.7455 5 13.9496 5.17688 13.9919 5.41012L14 5.5V14.5C14 14.7761 13.7761 15 13.5 15C13.2545 15 13.0504 14.8231 13.0081 14.5899L13 14.5V5.5C13 5.22386 13.2239 5 13.5 5ZM5.64645 5.14645C5.82001 4.97288 6.08944 4.9536 6.28431 5.08859L6.35355 5.14645L10.8536 9.64645C11.0271 9.82001 11.0464 10.0894 10.9114 10.2843L10.8536 10.3536L6.35355 14.8536C6.15829 15.0488 5.84171 15.0488 5.64645 14.8536C5.47288 14.68 5.4536 14.4106 5.58859 14.2157L5.64645 14.1464L9.79289 10L5.64645 5.85355C5.45118 5.65829 5.45118 5.34171 5.64645 5.14645Z",fill:"currentColor"})),Mv=m("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},m("path",{d:"M4.089 4.216l.057-.07a.5.5 0 0 1 .638-.057l.07.057L10 9.293l5.146-5.147a.5.5 0 0 1 .638-.057l.07.057a.5.5 0 0 1 .057.638l-.057.07L10.707 10l5.147 5.146a.5.5 0 0 1 .057.638l-.057.07a.5.5 0 0 1-.638.057l-.07-.057L10 10.707l-5.146 5.147a.5.5 0 0 1-.638.057l-.07-.057a.5.5 0 0 1-.057-.638l.057-.07L9.293 10L4.146 4.854a.5.5 0 0 1-.057-.638l.057-.07l-.057.07z",fill:"currentColor"})),Ov=ee([ee("body >",[T("image-container","position: fixed;")]),T("image-preview-container",`
 position: fixed;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 display: flex;
 `),T("image-preview-overlay",`
 z-index: -1;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 background: rgba(0, 0, 0, .3);
 `,[Al()]),T("image-preview-toolbar",`
 z-index: 1;
 position: absolute;
 left: 50%;
 transform: translateX(-50%);
 border-radius: var(--n-toolbar-border-radius);
 height: 48px;
 bottom: 40px;
 padding: 0 12px;
 background: var(--n-toolbar-color);
 box-shadow: var(--n-toolbar-box-shadow);
 color: var(--n-toolbar-icon-color);
 transition: color .3s var(--n-bezier);
 display: flex;
 align-items: center;
 `,[T("base-icon",`
 padding: 0 8px;
 font-size: 28px;
 cursor: pointer;
 `),Al()]),T("image-preview-wrapper",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 display: flex;
 pointer-events: none;
 `,[$d()]),T("image-preview",`
 user-select: none;
 -webkit-user-select: none;
 pointer-events: all;
 margin: auto;
 max-height: calc(100vh - 32px);
 max-width: calc(100vw - 32px);
 transition: transform .3s var(--n-bezier);
 `),T("image",`
 display: inline-flex;
 max-height: 100%;
 max-width: 100%;
 `,[an("preview-disabled",`
 cursor: pointer;
 `),ee("img",`
 border-radius: inherit;
 `)])]),uo=32,bu=xe({name:"ImagePreview",props:Object.assign(Object.assign({},Ra),{onNext:Function,onPrev:Function,clsPrefix:{type:String,required:!0}}),setup(i){const e=ct("Image","-image",Ov,Sv,i,pe(i,"clsPrefix"));let t=null;const n=K(null),r=K(null),o=K(void 0),s=K(!1),l=K(!1),{localeRef:a}=nm("Image");function c(){const{value:J}=r;if(!t||!J)return;const{style:me}=J,Q=t.getBoundingClientRect(),Se=Q.left+Q.width/2,N=Q.top+Q.height/2;me.transformOrigin=`${Se}px ${N}px`}function h(J){var me,Q;switch(J.key){case" ":J.preventDefault();break;case"ArrowLeft":(me=i.onPrev)===null||me===void 0||me.call(i);break;case"ArrowRight":(Q=i.onNext)===null||Q===void 0||Q.call(i);break;case"Escape":Me();break}}Lt(s,J=>{J?Wn("keydown",document,h):dn("keydown",document,h)}),or(()=>{dn("keydown",document,h)});let d=0,u=0,f=0,g=0,x=0,b=0,S=0,A=0,O=!1;function R(J){const{clientX:me,clientY:Q}=J;f=me-d,g=Q-u,om($e)}function k(J){const{mouseUpClientX:me,mouseUpClientY:Q,mouseDownClientX:Se,mouseDownClientY:N}=J,j=Se-me,L=N-Q,I=`vertical${L>0?"Top":"Bottom"}`,le=`horizontal${j>0?"Left":"Right"}`;return{moveVerticalDirection:I,moveHorizontalDirection:le,deltaHorizontal:j,deltaVertical:L}}function C(J){const{value:me}=n;if(!me)return{offsetX:0,offsetY:0};const Q=me.getBoundingClientRect(),{moveVerticalDirection:Se,moveHorizontalDirection:N,deltaHorizontal:j,deltaVertical:L}=J||{};let I=0,le=0;return Q.width<=window.innerWidth?I=0:Q.left>0?I=(Q.width-window.innerWidth)/2:Q.right<window.innerWidth?I=-(Q.width-window.innerWidth)/2:N==="horizontalRight"?I=Math.min((Q.width-window.innerWidth)/2,x-(j??0)):I=Math.max(-((Q.width-window.innerWidth)/2),x-(j??0)),Q.height<=window.innerHeight?le=0:Q.top>0?le=(Q.height-window.innerHeight)/2:Q.bottom<window.innerHeight?le=-(Q.height-window.innerHeight)/2:Se==="verticalBottom"?le=Math.min((Q.height-window.innerHeight)/2,b-(L??0)):le=Math.max(-((Q.height-window.innerHeight)/2),b-(L??0)),{offsetX:I,offsetY:le}}function w(J){dn("mousemove",document,R),dn("mouseup",document,w);const{clientX:me,clientY:Q}=J;O=!1;const Se=k({mouseUpClientX:me,mouseUpClientY:Q,mouseDownClientX:S,mouseDownClientY:A}),N=C(Se);f=N.offsetX,g=N.offsetY,$e()}const D=rt(vu,null);function v(J){var me,Q;if((Q=(me=D==null?void 0:D.previewedImgPropsRef.value)===null||me===void 0?void 0:me.onMousedown)===null||Q===void 0||Q.call(me,J),J.button!==0)return;const{clientX:Se,clientY:N}=J;O=!0,d=Se-f,u=N-g,x=f,b=g,S=Se,A=N,$e(),Wn("mousemove",document,R),Wn("mouseup",document,w)}function W(J){var me,Q;(Q=(me=D==null?void 0:D.previewedImgPropsRef.value)===null||me===void 0?void 0:me.onDblclick)===null||Q===void 0||Q.call(me,J);const Se=G();Y=Y===Se?1:Se,$e()}const q=1.5;let ne=0,Y=1,re=0;function oe(){Y=1,ne=0}function $(){var J;oe(),re=0,(J=i.onPrev)===null||J===void 0||J.call(i)}function te(){var J;oe(),re=0,(J=i.onNext)===null||J===void 0||J.call(i)}function E(){re-=90,$e()}function V(){re+=90,$e()}function H(){const{value:J}=n;if(!J)return 1;const{innerWidth:me,innerHeight:Q}=window,Se=Math.max(1,J.naturalHeight/(Q-uo)),N=Math.max(1,J.naturalWidth/(me-uo));return Math.max(3,Se*2,N*2)}function G(){const{value:J}=n;if(!J)return 1;const{innerWidth:me,innerHeight:Q}=window,Se=J.naturalHeight/(Q-uo),N=J.naturalWidth/(me-uo);return Se<1&&N<1?1:Math.max(Se,N)}function ue(){const J=H();Y<J&&(ne+=1,Y=Math.min(J,Math.pow(q,ne)),$e())}function ke(){if(Y>.5){const J=Y;ne-=1,Y=Math.max(.5,Math.pow(q,ne));const me=J-Y;$e(!1);const Q=C();Y+=me,$e(!1),Y-=me,f=Q.offsetX,g=Q.offsetY,$e()}}function $e(J=!0){var me;const{value:Q}=n;if(!Q)return;const{style:Se}=Q,N=Ud((me=D==null?void 0:D.previewedImgPropsRef.value)===null||me===void 0?void 0:me.style);let j="";if(typeof N=="string")j=N+";";else for(const I in N)j+=`${K0(I)}: ${N[I]};`;const L=`transform-origin: center; transform: translateX(${f}px) translateY(${g}px) rotate(${re}deg) scale(${Y});`;O?Se.cssText=j+"cursor: grabbing; transition: none;"+L:Se.cssText=j+"cursor: grab;"+L+(J?"":"transition: none;"),J||Q.offsetHeight}function Me(){s.value=!s.value,l.value=!0}function Ee(){Y=G(),ne=Math.ceil(Math.log(Y)/Math.log(q)),f=0,g=0,$e()}const Ot={setPreviewSrc:J=>{o.value=J},setThumbnailEl:J=>{t=J},toggleShow:Me};function Dt(J,me){if(i.showToolbarTooltip){const{value:Q}=e;return m(rm,{to:!1,theme:Q.peers.Tooltip,themeOverrides:Q.peerOverrides.Tooltip,keepAliveOnHover:!1},{default:()=>a.value[me],trigger:()=>J})}else return J}const ot=fe(()=>{const{common:{cubicBezierEaseInOut:J},self:{toolbarIconColor:me,toolbarBorderRadius:Q,toolbarBoxShadow:Se,toolbarColor:N}}=e.value;return{"--n-bezier":J,"--n-toolbar-icon-color":me,"--n-toolbar-color":N,"--n-toolbar-border-radius":Q,"--n-toolbar-box-shadow":Se}}),{inlineThemeDisabled:Ye}=ei(),tt=Ye?Ni("image-preview",void 0,ot,i):void 0;return Object.assign({previewRef:n,previewWrapperRef:r,previewSrc:o,show:s,appear:Hd(),displayed:l,previewedImgProps:D==null?void 0:D.previewedImgPropsRef,handleWheel(J){J.preventDefault()},handlePreviewMousedown:v,handlePreviewDblclick:W,syncTransformOrigin:c,handleAfterLeave:()=>{oe(),re=0,l.value=!1},handleDragStart:J=>{var me,Q;(Q=(me=D==null?void 0:D.previewedImgPropsRef.value)===null||me===void 0?void 0:me.onDragstart)===null||Q===void 0||Q.call(me,J),J.preventDefault()},zoomIn:ue,zoomOut:ke,rotateCounterclockwise:E,rotateClockwise:V,handleSwitchPrev:$,handleSwitchNext:te,withTooltip:Dt,resizeToOrignalImageSize:Ee,cssVars:Ye?void 0:ot,themeClass:tt==null?void 0:tt.themeClass,onRender:tt==null?void 0:tt.onRender},Ot)},render(){var i,e;const{clsPrefix:t}=this;return m(Ji,null,(e=(i=this.$slots).default)===null||e===void 0?void 0:e.call(i),m(Wd,{show:this.show},{default:()=>{var n;return this.show||this.displayed?((n=this.onRender)===null||n===void 0||n.call(this),vn(m("div",{class:[`${t}-image-preview-container`,this.themeClass],style:this.cssVars,onWheel:this.handleWheel},m(Dr,{name:"fade-in-transition",appear:this.appear},{default:()=>this.show?m("div",{class:`${t}-image-preview-overlay`,onClick:this.toggleShow}):null}),this.showToolbar?m(Dr,{name:"fade-in-transition",appear:this.appear},{default:()=>{if(!this.show)return null;const{withTooltip:r}=this;return m("div",{class:`${t}-image-preview-toolbar`},this.onPrev?m(Ji,null,r(m(_e,{clsPrefix:t,onClick:this.handleSwitchPrev},{default:()=>Av}),"tipPrevious"),r(m(_e,{clsPrefix:t,onClick:this.handleSwitchNext},{default:()=>Rv}),"tipNext")):null,r(m(_e,{clsPrefix:t,onClick:this.rotateCounterclockwise},{default:()=>m(ev,null)}),"tipCounterclockwise"),r(m(_e,{clsPrefix:t,onClick:this.rotateClockwise},{default:()=>m(Q0,null)}),"tipClockwise"),r(m(_e,{clsPrefix:t,onClick:this.resizeToOrignalImageSize},{default:()=>m(nv,null)}),"tipOriginalSize"),r(m(_e,{clsPrefix:t,onClick:this.zoomOut},{default:()=>m(iv,null)}),"tipZoomOut"),r(m(_e,{clsPrefix:t,onClick:this.zoomIn},{default:()=>m(tv,null)}),"tipZoomIn"),r(m(_e,{clsPrefix:t,onClick:this.toggleShow},{default:()=>Mv}),"tipClose"))}}):null,m(Dr,{name:"fade-in-scale-up-transition",onAfterLeave:this.handleAfterLeave,appear:this.appear,onEnter:this.syncTransformOrigin,onBeforeLeave:this.syncTransformOrigin},{default:()=>{const{previewedImgProps:r={}}=this;return vn(m("div",{class:`${t}-image-preview-wrapper`,ref:"previewWrapperRef"},m("img",Object.assign({},r,{draggable:!1,onMousedown:this.handlePreviewMousedown,onDblclick:this.handlePreviewDblclick,class:[`${t}-image-preview`,r.class],key:this.previewSrc,src:this.previewSrc,ref:"previewRef",onDragstart:this.handleDragStart}))),[[Nr,this.show]])}})),[[jd,{enabled:this.show}]])):null}}))}}),yu=li("n-image-group"),Dv=Ra,Tv=xe({name:"ImageGroup",props:Dv,setup(i){let e;const{mergedClsPrefixRef:t}=ei(i),n=`c${zr()}`,r=sm(),o=a=>{var c;e=a,(c=l.value)===null||c===void 0||c.setPreviewSrc(a)};function s(a){if(!(r!=null&&r.proxy))return;const h=r.proxy.$el.parentElement.querySelectorAll(`[data-group-id=${n}]:not([data-error=true])`);if(!h.length)return;const d=Array.from(h).findIndex(u=>u.dataset.previewSrc===e);~d?o(h[(d+a+h.length)%h.length].dataset.previewSrc):o(h[0].dataset.previewSrc)}It(yu,{mergedClsPrefixRef:t,setPreviewSrc:o,setThumbnailEl:a=>{var c;(c=l.value)===null||c===void 0||c.setThumbnailEl(a)},toggleShow:()=>{var a;(a=l.value)===null||a===void 0||a.toggleShow()},groupId:n});const l=K(null);return{mergedClsPrefix:t,previewInstRef:l,next:()=>s(1),prev:()=>s(-1)}},render(){return m(bu,{theme:this.theme,themeOverrides:this.themeOverrides,clsPrefix:this.mergedClsPrefix,ref:"previewInstRef",onPrev:this.prev,onNext:this.next,showToolbar:this.showToolbar,showToolbarTooltip:this.showToolbarTooltip},this.$slots)}}),Pv=Object.assign({alt:String,height:[String,Number],imgProps:Object,previewedImgProps:Object,lazy:Boolean,intersectionObserverOptions:Object,objectFit:{type:String,default:"fill"},previewSrc:String,fallbackSrc:String,width:[String,Number],src:String,previewDisabled:Boolean,loadDescription:String,onError:Function,onLoad:Function},Ra),Lv=xe({name:"Image",props:Pv,inheritAttrs:!1,setup(i){const e=K(null),t=K(!1),n=K(null),r=rt(yu,null),{mergedClsPrefixRef:o}=r||ei(i),s={click:()=>{if(i.previewDisabled||t.value)return;const c=i.previewSrc||i.src;if(r){r.setPreviewSrc(c),r.setThumbnailEl(e.value),r.toggleShow();return}const{value:h}=n;h&&(h.setPreviewSrc(c),h.setThumbnailEl(e.value),h.toggleShow())}},l=K(!i.lazy);Yi(()=>{var c;(c=e.value)===null||c===void 0||c.setAttribute("data-group-id",(r==null?void 0:r.groupId)||"")}),Yi(()=>{if(Xs)return;let c;const h=Oi(()=>{c==null||c(),c=void 0,i.lazy&&(c=ov(e.value,i.intersectionObserverOptions,l))});or(()=>{h(),c==null||c()})}),Oi(()=>{var c;i.src,(c=i.imgProps)===null||c===void 0||c.src,t.value=!1});const a=K(!1);return It(vu,{previewedImgPropsRef:pe(i,"previewedImgProps")}),Object.assign({mergedClsPrefix:o,groupId:r==null?void 0:r.groupId,previewInstRef:n,imageRef:e,showError:t,shouldStartLoading:l,loaded:a,mergedOnClick:c=>{var h,d;s.click(),(d=(h=i.imgProps)===null||h===void 0?void 0:h.onClick)===null||d===void 0||d.call(h,c)},mergedOnError:c=>{if(!l.value)return;t.value=!0;const{onError:h,imgProps:{onError:d}={}}=i;h==null||h(c),d==null||d(c)},mergedOnLoad:c=>{const{onLoad:h,imgProps:{onLoad:d}={}}=i;h==null||h(c),d==null||d(c),a.value=!0}},s)},render(){var i,e;const{mergedClsPrefix:t,imgProps:n={},loaded:r,$attrs:o,lazy:s}=this,l=(e=(i=this.$slots).placeholder)===null||e===void 0?void 0:e.call(i),a=this.src||n.src||"",c=m("img",Object.assign(Object.assign({},n),{ref:"imageRef",width:this.width||n.width,height:this.height||n.height,src:Xs?a:this.showError?this.fallbackSrc:this.shouldStartLoading?a:void 0,alt:this.alt||n.alt,"aria-label":this.alt||n.alt,onClick:this.mergedOnClick,onError:this.mergedOnError,onLoad:this.mergedOnLoad,loading:Xs&&s&&!this.intersectionObserverOptions?"lazy":"eager",style:[n.style||"",l&&!r?{height:"0",width:"0",visibility:"hidden"}:"",{objectFit:this.objectFit}],"data-error":this.showError,"data-preview-src":this.previewSrc||this.src}));return m("div",Object.assign({},o,{role:"none",class:[o.class,`${t}-image`,(this.previewDisabled||this.showError)&&`${t}-image--preview-disabled`]}),this.groupId?c:m(bu,{theme:this.theme,themeOverrides:this.themeOverrides,clsPrefix:t,ref:"previewInstRef",showToolbar:this.showToolbar,showToolbarTooltip:this.showToolbarTooltip},{default:()=>c}),!r&&l)}}),wu={icon:Function,type:{type:String,default:"info"},content:[String,Number,Function],showIcon:{type:Boolean,default:!0},closable:Boolean,keepAliveOnHover:Boolean,onClose:Function,onMouseenter:Function,onMouseleave:Function},xu=li("n-message-api"),ku=li("n-message-provider"),Bv=ee([T("message-wrapper",`
 margin: var(--n-margin);
 z-index: 0;
 transform-origin: top center;
 display: flex;
 `,[Fr({overflow:"visible",originalTransition:"transform .3s var(--n-bezier)",enterToProps:{transform:"scale(1)"},leaveToProps:{transform:"scale(0.85)"}})]),T("message",`
 box-sizing: border-box;
 display: flex;
 align-items: center;
 transition:
 color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 opacity .3s var(--n-bezier),
 transform .3s var(--n-bezier),
 margin-bottom .3s var(--n-bezier);
 padding: var(--n-padding);
 border-radius: var(--n-border-radius);
 flex-wrap: nowrap;
 overflow: hidden;
 max-width: var(--n-max-width);
 color: var(--n-text-color);
 background-color: var(--n-color);
 box-shadow: var(--n-box-shadow);
 `,[ge("content",`
 display: inline-block;
 line-height: var(--n-line-height);
 font-size: var(--n-font-size);
 `),ge("icon",`
 position: relative;
 margin: var(--n-icon-margin);
 height: var(--n-icon-size);
 width: var(--n-icon-size);
 font-size: var(--n-icon-size);
 flex-shrink: 0;
 `,[["default","info","success","warning","error","loading"].map(i=>U(`${i}-type`,[ee("> *",`
 color: var(--n-icon-color-${i});
 transition: color .3s var(--n-bezier);
 `)])),ee("> *",`
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 `,[Tr()])]),ge("close",`
 margin: var(--n-close-margin);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 flex-shrink: 0;
 `,[ee("&:hover",`
 color: var(--n-close-icon-color-hover);
 `),ee("&:active",`
 color: var(--n-close-icon-color-pressed);
 `)])]),T("message-container",`
 z-index: 6000;
 position: fixed;
 height: 0;
 overflow: visible;
 display: flex;
 flex-direction: column;
 align-items: center;
 `,[U("top",`
 top: 12px;
 left: 0;
 right: 0;
 `),U("top-left",`
 top: 12px;
 left: 12px;
 right: 0;
 align-items: flex-start;
 `),U("top-right",`
 top: 12px;
 left: 0;
 right: 12px;
 align-items: flex-end;
 `),U("bottom",`
 bottom: 4px;
 left: 0;
 right: 0;
 justify-content: flex-end;
 `),U("bottom-left",`
 bottom: 4px;
 left: 12px;
 right: 0;
 justify-content: flex-end;
 align-items: flex-start;
 `),U("bottom-right",`
 bottom: 4px;
 left: 0;
 right: 12px;
 justify-content: flex-end;
 align-items: flex-end;
 `)])]),Ev={info:()=>m(Ir,null),success:()=>m(xs,null),warning:()=>m(ks,null),error:()=>m(Cs,null),default:()=>null},Iv=xe({name:"Message",props:Object.assign(Object.assign({},wu),{render:Function}),setup(i){const{inlineThemeDisabled:e,mergedRtlRef:t}=ei(i),{props:n,mergedClsPrefixRef:r}=rt(ku),o=ya("Message",t,r),s=ct("Message","-message",Bv,lm,n,r),l=fe(()=>{const{type:c}=i,{common:{cubicBezierEaseInOut:h},self:{padding:d,margin:u,maxWidth:f,iconMargin:g,closeMargin:x,closeSize:b,iconSize:S,fontSize:A,lineHeight:O,borderRadius:R,iconColorInfo:k,iconColorSuccess:C,iconColorWarning:w,iconColorError:D,iconColorLoading:v,closeIconSize:W,closeBorderRadius:q,[qe("textColor",c)]:ne,[qe("boxShadow",c)]:Y,[qe("color",c)]:re,[qe("closeColorHover",c)]:oe,[qe("closeColorPressed",c)]:$,[qe("closeIconColor",c)]:te,[qe("closeIconColorPressed",c)]:E,[qe("closeIconColorHover",c)]:V}}=s.value;return{"--n-bezier":h,"--n-margin":u,"--n-padding":d,"--n-max-width":f,"--n-font-size":A,"--n-icon-margin":g,"--n-icon-size":S,"--n-close-icon-size":W,"--n-close-border-radius":q,"--n-close-size":b,"--n-close-margin":x,"--n-text-color":ne,"--n-color":re,"--n-box-shadow":Y,"--n-icon-color-info":k,"--n-icon-color-success":C,"--n-icon-color-warning":w,"--n-icon-color-error":D,"--n-icon-color-loading":v,"--n-close-color-hover":oe,"--n-close-color-pressed":$,"--n-close-icon-color":te,"--n-close-icon-color-pressed":E,"--n-close-icon-color-hover":V,"--n-line-height":O,"--n-border-radius":R}}),a=e?Ni("message",fe(()=>i.type[0]),l,{}):void 0;return{mergedClsPrefix:r,rtlEnabled:o,messageProviderProps:n,handleClose(){var c;(c=i.onClose)===null||c===void 0||c.call(i)},cssVars:e?void 0:l,themeClass:a==null?void 0:a.themeClass,onRender:a==null?void 0:a.onRender,placement:n.placement}},render(){const{render:i,type:e,closable:t,content:n,mergedClsPrefix:r,cssVars:o,themeClass:s,onRender:l,icon:a,handleClose:c,showIcon:h}=this;l==null||l();let d;return m("div",{class:[`${r}-message-wrapper`,s],onMouseenter:this.onMouseenter,onMouseleave:this.onMouseleave,style:[{alignItems:this.placement.startsWith("top")?"flex-start":"flex-end"},o]},i?i(this.$props):m("div",{class:[`${r}-message ${r}-message--${e}-type`,this.rtlEnabled&&`${r}-message--rtl`]},(d=Nv(a,e,r))&&h?m("div",{class:`${r}-message__icon ${r}-message__icon--${e}-type`},m(ka,null,{default:()=>d})):null,m("div",{class:`${r}-message__content`},ri(n)),t?m(ws,{clsPrefix:r,class:`${r}-message__close`,onClick:c,absolute:!0}):null))}});function Nv(i,e,t){if(typeof i=="function")return i();{const n=e==="loading"?m(Kd,{clsPrefix:t,strokeWidth:24,scale:.85}):Ev[e]();return n?m(_e,{clsPrefix:t,key:e},{default:()=>n}):null}}const zv=xe({name:"MessageEnvironment",props:Object.assign(Object.assign({},wu),{duration:{type:Number,default:3e3},onAfterLeave:Function,onLeave:Function,internalKey:{type:String,required:!0},onInternalAfterLeave:Function,onHide:Function,onAfterHide:Function}),setup(i){let e=null;const t=K(!0);Yi(()=>{n()});function n(){const{duration:h}=i;h&&(e=window.setTimeout(s,h))}function r(h){h.currentTarget===h.target&&e!==null&&(window.clearTimeout(e),e=null)}function o(h){h.currentTarget===h.target&&n()}function s(){const{onHide:h}=i;t.value=!1,e&&(window.clearTimeout(e),e=null),h&&h()}function l(){const{onClose:h}=i;h&&h(),s()}function a(){const{onAfterLeave:h,onInternalAfterLeave:d,onAfterHide:u,internalKey:f}=i;h&&h(),d&&d(f),u&&u()}function c(){s()}return{show:t,hide:s,handleClose:l,handleAfterLeave:a,handleMouseleave:o,handleMouseenter:r,deactivate:c}},render(){return m(Ss,{appear:!0,onAfterLeave:this.handleAfterLeave,onLeave:this.onLeave},{default:()=>[this.show?m(Iv,{content:this.content,type:this.type,icon:this.icon,showIcon:this.showIcon,closable:this.closable,onClose:this.handleClose,onMouseenter:this.keepAliveOnHover?this.handleMouseenter:void 0,onMouseleave:this.keepAliveOnHover?this.handleMouseleave:void 0}):null]})}}),Fv=Object.assign(Object.assign({},ct.props),{to:[String,Object],duration:{type:Number,default:3e3},keepAliveOnHover:Boolean,max:Number,placement:{type:String,default:"top"},closable:Boolean,containerStyle:[String,Object]}),$v=xe({name:"MessageProvider",props:Fv,setup(i){const{mergedClsPrefixRef:e}=ei(i),t=K([]),n=K({}),r={create(a,c){return o(a,Object.assign({type:"default"},c))},info(a,c){return o(a,Object.assign(Object.assign({},c),{type:"info"}))},success(a,c){return o(a,Object.assign(Object.assign({},c),{type:"success"}))},warning(a,c){return o(a,Object.assign(Object.assign({},c),{type:"warning"}))},error(a,c){return o(a,Object.assign(Object.assign({},c),{type:"error"}))},loading(a,c){return o(a,Object.assign(Object.assign({},c),{type:"loading"}))},destroyAll:l};It(ku,{props:i,mergedClsPrefixRef:e}),It(xu,r);function o(a,c){const h=zr(),d=Vd(Object.assign(Object.assign({},c),{content:a,key:h,destroy:()=>{var f;(f=n.value[h])===null||f===void 0||f.hide()}})),{max:u}=i;return u&&t.value.length>=u&&t.value.shift(),t.value.push(d),d}function s(a){t.value.splice(t.value.findIndex(c=>c.key===a),1),delete n.value[a]}function l(){Object.values(n.value).forEach(a=>{a.hide()})}return Object.assign({mergedClsPrefix:e,messageRefs:n,messageList:t,handleAfterLeave:s},r)},render(){var i,e,t;return m(Ji,null,(e=(i=this.$slots).default)===null||e===void 0?void 0:e.call(i),this.messageList.length?m(qd,{to:(t=this.to)!==null&&t!==void 0?t:"body"},m("div",{class:[`${this.mergedClsPrefix}-message-container`,`${this.mergedClsPrefix}-message-container--${this.placement}`],key:"message-container",style:this.containerStyle},this.messageList.map(n=>m(zv,Object.assign({ref:r=>{r&&(this.messageRefs[n.key]=r)},internalKey:n.key,onInternalAfterLeave:this.handleAfterLeave},xa(n,["destroy"],void 0),{duration:n.duration===void 0?this.duration:n.duration,keepAliveOnHover:n.keepAliveOnHover===void 0?this.keepAliveOnHover:n.keepAliveOnHover,closable:n.closable===void 0?this.closable:n.closable}))))):null)}});function Hv(){const i=rt(xu,null);return i===null&&Sn("use-message","No outer <n-message-provider /> founded. See prerequisite in https://www.naiveui.com/en-US/os-theme/components/message for more details. If you want to use `useMessage` outside setup, please check https://www.naiveui.com/zh-CN/os-theme/components/message#Q-&-A."),i}function jv(){const i=rt(am,null);return i===null&&Sn("use-notification","No outer `n-notification-provider` found."),i}const Wv=ee([T("progress",{display:"inline-block"},[T("progress-icon",`
 color: var(--n-icon-color);
 transition: color .3s var(--n-bezier);
 `),U("line",`
 width: 100%;
 display: block;
 `,[T("progress-content",`
 display: flex;
 align-items: center;
 `,[T("progress-graph",{flex:1})]),T("progress-custom-content",{marginLeft:"14px"}),T("progress-icon",`
 width: 30px;
 padding-left: 14px;
 height: var(--n-icon-size-line);
 line-height: var(--n-icon-size-line);
 font-size: var(--n-icon-size-line);
 `,[U("as-text",`
 color: var(--n-text-color-line-outer);
 text-align: center;
 width: 40px;
 font-size: var(--n-font-size);
 padding-left: 4px;
 transition: color .3s var(--n-bezier);
 `)])]),U("circle, dashboard",{width:"120px"},[T("progress-custom-content",`
 position: absolute;
 left: 50%;
 top: 50%;
 transform: translateX(-50%) translateY(-50%);
 display: flex;
 align-items: center;
 justify-content: center;
 `),T("progress-text",`
 position: absolute;
 left: 50%;
 top: 50%;
 transform: translateX(-50%) translateY(-50%);
 display: flex;
 align-items: center;
 color: inherit;
 font-size: var(--n-font-size-circle);
 color: var(--n-text-color-circle);
 font-weight: var(--n-font-weight-circle);
 transition: color .3s var(--n-bezier);
 white-space: nowrap;
 `),T("progress-icon",`
 position: absolute;
 left: 50%;
 top: 50%;
 transform: translateX(-50%) translateY(-50%);
 display: flex;
 align-items: center;
 color: var(--n-icon-color);
 font-size: var(--n-icon-size-circle);
 `)]),U("multiple-circle",`
 width: 200px;
 color: inherit;
 `,[T("progress-text",`
 font-weight: var(--n-font-weight-circle);
 color: var(--n-text-color-circle);
 position: absolute;
 left: 50%;
 top: 50%;
 transform: translateX(-50%) translateY(-50%);
 display: flex;
 align-items: center;
 justify-content: center;
 transition: color .3s var(--n-bezier);
 `)]),T("progress-content",{position:"relative"}),T("progress-graph",{position:"relative"},[T("progress-graph-circle",[ee("svg",{verticalAlign:"bottom"}),T("progress-graph-circle-fill",`
 stroke: var(--n-fill-color);
 transition:
 opacity .3s var(--n-bezier),
 stroke .3s var(--n-bezier),
 stroke-dasharray .3s var(--n-bezier);
 `,[U("empty",{opacity:0})]),T("progress-graph-circle-rail",`
 transition: stroke .3s var(--n-bezier);
 overflow: hidden;
 stroke: var(--n-rail-color);
 `)]),T("progress-graph-line",[U("indicator-inside",[T("progress-graph-line-rail",`
 height: 16px;
 line-height: 16px;
 border-radius: 10px;
 `,[T("progress-graph-line-fill",`
 height: inherit;
 border-radius: 10px;
 `),T("progress-graph-line-indicator",`
 background: #0000;
 white-space: nowrap;
 text-align: right;
 margin-left: 14px;
 margin-right: 14px;
 height: inherit;
 font-size: 12px;
 color: var(--n-text-color-line-inner);
 transition: color .3s var(--n-bezier);
 `)])]),U("indicator-inside-label",`
 height: 16px;
 display: flex;
 align-items: center;
 `,[T("progress-graph-line-rail",`
 flex: 1;
 transition: background-color .3s var(--n-bezier);
 `),T("progress-graph-line-indicator",`
 background: var(--n-fill-color);
 font-size: 12px;
 transform: translateZ(0);
 display: flex;
 vertical-align: middle;
 height: 16px;
 line-height: 16px;
 padding: 0 10px;
 border-radius: 10px;
 position: absolute;
 white-space: nowrap;
 color: var(--n-text-color-line-inner);
 transition:
 right .2s var(--n-bezier),
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `)]),T("progress-graph-line-rail",`
 position: relative;
 overflow: hidden;
 height: var(--n-rail-height);
 border-radius: 5px;
 background-color: var(--n-rail-color);
 transition: background-color .3s var(--n-bezier);
 `,[T("progress-graph-line-fill",`
 background: var(--n-fill-color);
 position: relative;
 border-radius: 5px;
 height: inherit;
 width: 100%;
 max-width: 0%;
 transition:
 background-color .3s var(--n-bezier),
 max-width .2s var(--n-bezier);
 `,[U("processing",[ee("&::after",`
 content: "";
 background-image: var(--n-line-bg-processing);
 animation: progress-processing-animation 2s var(--n-bezier) infinite;
 `)])])])])])]),ee("@keyframes progress-processing-animation",`
 0% {
 position: absolute;
 left: 0;
 top: 0;
 bottom: 0;
 right: 100%;
 opacity: 1;
 }
 66% {
 position: absolute;
 left: 0;
 top: 0;
 bottom: 0;
 right: 0;
 opacity: 0;
 }
 100% {
 position: absolute;
 left: 0;
 top: 0;
 bottom: 0;
 right: 0;
 opacity: 0;
 }
 `)]),Vv={success:m(xs,null),error:m(Cs,null),warning:m(ks,null),info:m(Ir,null)},Uv=xe({name:"ProgressLine",props:{clsPrefix:{type:String,required:!0},percentage:{type:Number,default:0},railColor:String,railStyle:[String,Object],fillColor:String,status:{type:String,required:!0},indicatorPlacement:{type:String,required:!0},indicatorTextColor:String,unit:{type:String,default:"%"},processing:{type:Boolean,required:!0},showIndicator:{type:Boolean,required:!0},height:[String,Number],railBorderRadius:[String,Number],fillBorderRadius:[String,Number]},setup(i,{slots:e}){const t=fe(()=>Tn(i.height)),n=fe(()=>i.railBorderRadius!==void 0?Tn(i.railBorderRadius):i.height!==void 0?Tn(i.height,{c:.5}):""),r=fe(()=>i.fillBorderRadius!==void 0?Tn(i.fillBorderRadius):i.railBorderRadius!==void 0?Tn(i.railBorderRadius):i.height!==void 0?Tn(i.height,{c:.5}):"");return()=>{const{indicatorPlacement:o,railColor:s,railStyle:l,percentage:a,unit:c,indicatorTextColor:h,status:d,showIndicator:u,fillColor:f,processing:g,clsPrefix:x}=i;return m("div",{class:`${x}-progress-content`,role:"none"},m("div",{class:`${x}-progress-graph`,"aria-hidden":!0},m("div",{class:[`${x}-progress-graph-line`,{[`${x}-progress-graph-line--indicator-${o}`]:!0}]},m("div",{class:`${x}-progress-graph-line-rail`,style:[{backgroundColor:s,height:t.value,borderRadius:n.value},l]},m("div",{class:[`${x}-progress-graph-line-fill`,g&&`${x}-progress-graph-line-fill--processing`],style:{maxWidth:`${i.percentage}%`,backgroundColor:f,height:t.value,lineHeight:t.value,borderRadius:r.value}},o==="inside"?m("div",{class:`${x}-progress-graph-line-indicator`,style:{color:h}},a,c):null)))),u&&o==="outside"?m("div",null,e.default?m("div",{class:`${x}-progress-custom-content`,style:{color:h},role:"none"},e.default()):d==="default"?m("div",{role:"none",class:`${x}-progress-icon ${x}-progress-icon--as-text`,style:{color:h}},a,c):m("div",{class:`${x}-progress-icon`,"aria-hidden":!0},m(_e,{clsPrefix:x},{default:()=>Vv[d]}))):null)}}}),Kv={success:m(xs,null),error:m(Cs,null),warning:m(ks,null),info:m(Ir,null)},qv=xe({name:"ProgressCircle",props:{clsPrefix:{type:String,required:!0},status:{type:String,required:!0},strokeWidth:{type:Number,required:!0},fillColor:String,railColor:String,railStyle:[String,Object],percentage:{type:Number,default:0},offsetDegree:{type:Number,default:0},showIndicator:{type:Boolean,required:!0},indicatorTextColor:String,unit:String,viewBoxWidth:{type:Number,required:!0},gapDegree:{type:Number,required:!0},gapOffsetDegree:{type:Number,default:0}},setup(i,{slots:e}){function t(n,r,o){const{gapDegree:s,viewBoxWidth:l,strokeWidth:a}=i,c=50,h=0,d=c,u=0,f=2*c,g=50+a/2,x=`M ${g},${g} m ${h},${d}
      a ${c},${c} 0 1 1 ${u},${-f}
      a ${c},${c} 0 1 1 ${-u},${f}`,b=Math.PI*2*c,S={stroke:o,strokeDasharray:`${n/100*(b-s)}px ${l*8}px`,strokeDashoffset:`-${s/2}px`,transformOrigin:r?"center":void 0,transform:r?`rotate(${r}deg)`:void 0};return{pathString:x,pathStyle:S}}return()=>{const{fillColor:n,railColor:r,strokeWidth:o,offsetDegree:s,status:l,percentage:a,showIndicator:c,indicatorTextColor:h,unit:d,gapOffsetDegree:u,clsPrefix:f}=i,{pathString:g,pathStyle:x}=t(100,0,r),{pathString:b,pathStyle:S}=t(a,s,n),A=100+o;return m("div",{class:`${f}-progress-content`,role:"none"},m("div",{class:`${f}-progress-graph`,"aria-hidden":!0},m("div",{class:`${f}-progress-graph-circle`,style:{transform:u?`rotate(${u}deg)`:void 0}},m("svg",{viewBox:`0 0 ${A} ${A}`},m("g",null,m("path",{class:`${f}-progress-graph-circle-rail`,d:g,"stroke-width":o,"stroke-linecap":"round",fill:"none",style:x})),m("g",null,m("path",{class:[`${f}-progress-graph-circle-fill`,a===0&&`${f}-progress-graph-circle-fill--empty`],d:b,"stroke-width":o,"stroke-linecap":"round",fill:"none",style:S}))))),c?m("div",null,e.default?m("div",{class:`${f}-progress-custom-content`,role:"none"},e.default()):l!=="default"?m("div",{class:`${f}-progress-icon`,"aria-hidden":!0},m(_e,{clsPrefix:f},{default:()=>Kv[l]})):m("div",{class:`${f}-progress-text`,style:{color:h},role:"none"},m("span",{class:`${f}-progress-text__percentage`},a),m("span",{class:`${f}-progress-text__unit`},d))):null)}}});function Pc(i,e,t=100){return`m ${t/2} ${t/2-i} a ${i} ${i} 0 1 1 0 ${2*i} a ${i} ${i} 0 1 1 0 -${2*i}`}const _v=xe({name:"ProgressMultipleCircle",props:{clsPrefix:{type:String,required:!0},viewBoxWidth:{type:Number,required:!0},percentage:{type:Array,default:[0]},strokeWidth:{type:Number,required:!0},circleGap:{type:Number,required:!0},showIndicator:{type:Boolean,required:!0},fillColor:{type:Array,default:()=>[]},railColor:{type:Array,default:()=>[]},railStyle:{type:Array,default:()=>[]}},setup(i,{slots:e}){const t=fe(()=>i.percentage.map((r,o)=>`${Math.PI*r/100*(i.viewBoxWidth/2-i.strokeWidth/2*(1+2*o)-i.circleGap*o)*2}, ${i.viewBoxWidth*8}`));return()=>{const{viewBoxWidth:n,strokeWidth:r,circleGap:o,showIndicator:s,fillColor:l,railColor:a,railStyle:c,percentage:h,clsPrefix:d}=i;return m("div",{class:`${d}-progress-content`,role:"none"},m("div",{class:`${d}-progress-graph`,"aria-hidden":!0},m("div",{class:`${d}-progress-graph-circle`},m("svg",{viewBox:`0 0 ${n} ${n}`},h.map((u,f)=>m("g",{key:f},m("path",{class:`${d}-progress-graph-circle-rail`,d:Pc(n/2-r/2*(1+2*f)-o*f,r,n),"stroke-width":r,"stroke-linecap":"round",fill:"none",style:[{strokeDashoffset:0,stroke:a[f]},c[f]]}),m("path",{class:[`${d}-progress-graph-circle-fill`,u===0&&`${d}-progress-graph-circle-fill--empty`],d:Pc(n/2-r/2*(1+2*f)-o*f,r,n),"stroke-width":r,"stroke-linecap":"round",fill:"none",style:{strokeDasharray:t.value[f],strokeDashoffset:0,stroke:l[f]}})))))),s&&e.default?m("div",null,m("div",{class:`${d}-progress-text`},e.default())):null)}}}),Gv=Object.assign(Object.assign({},ct.props),{processing:Boolean,type:{type:String,default:"line"},gapDegree:Number,gapOffsetDegree:Number,status:{type:String,default:"default"},railColor:[String,Array],railStyle:[String,Array],color:[String,Array],viewBoxWidth:{type:Number,default:100},strokeWidth:{type:Number,default:7},percentage:[Number,Array],unit:{type:String,default:"%"},showIndicator:{type:Boolean,default:!0},indicatorPosition:{type:String,default:"outside"},indicatorPlacement:{type:String,default:"outside"},indicatorTextColor:String,circleGap:{type:Number,default:1},height:Number,borderRadius:[String,Number],fillBorderRadius:[String,Number],offsetDegree:Number}),Xv=xe({name:"Progress",props:Gv,setup(i){const e=fe(()=>i.indicatorPlacement||i.indicatorPosition),t=fe(()=>{if(i.gapDegree||i.gapDegree===0)return i.gapDegree;if(i.type==="dashboard")return 75}),{mergedClsPrefixRef:n,inlineThemeDisabled:r}=ei(i),o=ct("Progress","-progress",Wv,cm,i,n),s=fe(()=>{const{status:a}=i,{common:{cubicBezierEaseInOut:c},self:{fontSize:h,fontSizeCircle:d,railColor:u,railHeight:f,iconSizeCircle:g,iconSizeLine:x,textColorCircle:b,textColorLineInner:S,textColorLineOuter:A,lineBgProcessing:O,fontWeightCircle:R,[qe("iconColor",a)]:k,[qe("fillColor",a)]:C}}=o.value;return{"--n-bezier":c,"--n-fill-color":C,"--n-font-size":h,"--n-font-size-circle":d,"--n-font-weight-circle":R,"--n-icon-color":k,"--n-icon-size-circle":g,"--n-icon-size-line":x,"--n-line-bg-processing":O,"--n-rail-color":u,"--n-rail-height":f,"--n-text-color-circle":b,"--n-text-color-line-inner":S,"--n-text-color-line-outer":A}}),l=r?Ni("progress",fe(()=>i.status[0]),s,i):void 0;return{mergedClsPrefix:n,mergedIndicatorPlacement:e,gapDeg:t,cssVars:r?void 0:s,themeClass:l==null?void 0:l.themeClass,onRender:l==null?void 0:l.onRender}},render(){const{type:i,cssVars:e,indicatorTextColor:t,showIndicator:n,status:r,railColor:o,railStyle:s,color:l,percentage:a,viewBoxWidth:c,strokeWidth:h,mergedIndicatorPlacement:d,unit:u,borderRadius:f,fillBorderRadius:g,height:x,processing:b,circleGap:S,mergedClsPrefix:A,gapDeg:O,gapOffsetDegree:R,themeClass:k,$slots:C,onRender:w}=this;return w==null||w(),m("div",{class:[k,`${A}-progress`,`${A}-progress--${i}`,`${A}-progress--${r}`],style:e,"aria-valuemax":100,"aria-valuemin":0,"aria-valuenow":a,role:i==="circle"||i==="line"||i==="dashboard"?"progressbar":"none"},i==="circle"||i==="dashboard"?m(qv,{clsPrefix:A,status:r,showIndicator:n,indicatorTextColor:t,railColor:o,fillColor:l,railStyle:s,offsetDegree:this.offsetDegree,percentage:a,viewBoxWidth:c,strokeWidth:h,gapDegree:O===void 0?i==="dashboard"?75:0:O,gapOffsetDegree:R,unit:u},C):i==="line"?m(Uv,{clsPrefix:A,status:r,showIndicator:n,indicatorTextColor:t,railColor:o,fillColor:l,railStyle:s,percentage:a,processing:b,indicatorPlacement:d,unit:u,fillBorderRadius:g,railBorderRadius:f,height:x},C):i==="multiple-circle"?m(_v,{clsPrefix:A,strokeWidth:h,railColor:o,fillColor:l,railStyle:s,viewBoxWidth:c,percentage:a,showIndicator:n,circleGap:S},C):null)}}),Yv=Object.assign(Object.assign({},ct.props),{trigger:String,xScrollable:Boolean,onScroll:Function}),Jv=xe({name:"Scrollbar",props:Yv,setup(){const i=K(null);return Object.assign(Object.assign({},{scrollTo:(...t)=>{var n;(n=i.value)===null||n===void 0||n.scrollTo(t[0],t[1])},scrollBy:(...t)=>{var n;(n=i.value)===null||n===void 0||n.scrollBy(t[0],t[1])}}),{scrollbarInstRef:i})},render(){return m(Fd,Object.assign({ref:"scrollbarInstRef"},this.$props),this.$slots)}}),Lc=Jv,Cu=li("n-tabs"),Zv={tab:[String,Number,Object,Function],name:{type:[String,Number],required:!0},disabled:Boolean,displayDirective:{type:String,default:"if"},closable:{type:Boolean,default:void 0},tabProps:Object,label:[String,Number,Object,Function]},Qv=Object.assign({internalLeftPadded:Boolean,internalAddable:Boolean,internalCreatedByPane:Boolean},xa(Zv,["displayDirective"])),Go=xe({__TAB__:!0,inheritAttrs:!1,name:"Tab",props:Qv,setup(i){const{mergedClsPrefixRef:e,valueRef:t,typeRef:n,closableRef:r,tabStyleRef:o,tabChangeIdRef:s,onBeforeLeaveRef:l,triggerRef:a,handleAdd:c,activateTab:h,handleClose:d}=rt(Cu);return{trigger:a,mergedClosable:fe(()=>{if(i.internalAddable)return!1;const{closable:u}=i;return u===void 0?r.value:u}),style:o,clsPrefix:e,value:t,type:n,handleClose(u){u.stopPropagation(),!i.disabled&&d(i.name)},activateTab(){if(i.disabled)return;if(i.internalAddable){c();return}const{name:u}=i,f=++s.id;if(u!==t.value){const{value:g}=l;g?Promise.resolve(g(i.name,t.value)).then(x=>{x&&s.id===f&&h(u)}):h(u)}}}},render(){const{internalAddable:i,clsPrefix:e,name:t,disabled:n,label:r,tab:o,value:s,mergedClosable:l,style:a,trigger:c,$slots:{default:h}}=this,d=r??o;return m("div",{class:`${e}-tabs-tab-wrapper`},this.internalLeftPadded?m("div",{class:`${e}-tabs-tab-pad`}):null,m("div",Object.assign({key:t,"data-name":t,"data-disabled":n?!0:void 0},zd({class:[`${e}-tabs-tab`,s===t&&`${e}-tabs-tab--active`,n&&`${e}-tabs-tab--disabled`,l&&`${e}-tabs-tab--closable`,i&&`${e}-tabs-tab--addable`],onClick:c==="click"?this.activateTab:void 0,onMouseenter:c==="hover"?this.activateTab:void 0,style:i?void 0:a},this.internalCreatedByPane?this.tabProps||{}:this.$attrs)),m("span",{class:`${e}-tabs-tab__label`},i?m(Ji,null,m("div",{class:`${e}-tabs-tab__height-placeholder`}," "),m(_e,{clsPrefix:e},{default:()=>m(uu,null)})):h?h():typeof d=="object"?d:ri(d??t)),l&&this.type==="card"?m(ws,{clsPrefix:e,class:`${e}-tabs-tab__close`,onClick:this.handleClose,disabled:n}):null))}}),e1=T("tabs",`
 box-sizing: border-box;
 width: 100%;
 display: flex;
 flex-direction: column;
 transition:
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
`,[U("segment-type",[T("tabs-rail",[ee("&.transition-disabled","color: red;",[T("tabs-tab",`
 transition: none;
 `)])])]),U("left, right",`
 flex-direction: row;
 `,[T("tabs-bar",`
 width: 2px;
 right: 0;
 transition:
 top .2s var(--n-bezier),
 max-height .2s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `),T("tabs-tab",`
 padding: var(--n-tab-padding-vertical); 
 `)]),U("right",`
 flex-direction: row-reverse;
 `,[T("tabs-bar",`
 left: 0;
 `)]),U("bottom",`
 flex-direction: column-reverse;
 justify-content: flex-end;
 `,[T("tabs-bar",`
 top: 0;
 `)]),T("tabs-rail",`
 padding: 3px;
 border-radius: var(--n-tab-border-radius);
 width: 100%;
 background-color: var(--n-color-segment);
 transition: background-color .3s var(--n-bezier);
 display: flex;
 align-items: center;
 `,[T("tabs-tab-wrapper",`
 flex-basis: 0;
 flex-grow: 1;
 display: flex;
 align-items: center;
 justify-content: center;
 `,[T("tabs-tab",`
 overflow: hidden;
 border-radius: var(--n-tab-border-radius);
 width: 100%;
 display: flex;
 align-items: center;
 justify-content: center;
 `,[U("active",`
 font-weight: var(--n-font-weight-strong);
 color: var(--n-tab-text-color-active);
 background-color: var(--n-tab-color-segment);
 box-shadow: 0 1px 3px 0 rgba(0, 0, 0, .08);
 `),ee("&:hover",`
 color: var(--n-tab-text-color-hover);
 `)])])]),U("flex",[T("tabs-nav",{width:"100%"},[T("tabs-wrapper",{width:"100%"},[T("tabs-tab",{marginRight:0})])])]),T("tabs-nav",`
 box-sizing: border-box;
 line-height: 1.5;
 display: flex;
 transition: border-color .3s var(--n-bezier);
 `,[ge("prefix, suffix",`
 display: flex;
 align-items: center;
 `),ge("prefix","padding-right: 16px;"),ge("suffix","padding-left: 16px;")]),T("tabs-nav-scroll-wrapper",`
 flex: 1;
 position: relative;
 overflow: hidden;
 `,[U("shadow-before",[ee("&::before",`
 box-shadow: inset 10px 0 8px -8px rgba(0, 0, 0, .12);
 `)]),U("shadow-after",[ee("&::after",`
 box-shadow: inset -10px 0 8px -8px rgba(0, 0, 0, .12);
 `)]),T("tabs-nav-y-scroll",`
 height: 100%;
 width: 100%;
 overflow-y: auto; 
 scrollbar-width: none;
 `,[ee("&::-webkit-scrollbar",`
 width: 0;
 height: 0;
 `)]),ee("&::before, &::after",`
 transition: box-shadow .3s var(--n-bezier);
 pointer-events: none;
 content: "";
 position: absolute;
 top: 0;
 bottom: 0;
 width: 20px;
 z-index: 1;
 `),ee("&::before",`
 left: 0;
 `),ee("&::after",`
 right: 0;
 `)]),T("tabs-nav-scroll-content",`
 display: flex;
 position: relative;
 min-width: 100%;
 width: fit-content;
 `),T("tabs-wrapper",`
 display: inline-flex;
 flex-wrap: nowrap;
 position: relative;
 `),T("tabs-tab-wrapper",`
 display: flex;
 flex-wrap: nowrap;
 flex-shrink: 0;
 flex-grow: 0;
 `),T("tabs-tab",`
 cursor: pointer;
 white-space: nowrap;
 flex-wrap: nowrap;
 display: inline-flex;
 align-items: center;
 color: var(--n-tab-text-color);
 font-size: var(--n-tab-font-size);
 background-clip: padding-box;
 padding: var(--n-tab-padding);
 transition:
 box-shadow .3s var(--n-bezier),
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[U("disabled",{cursor:"not-allowed"}),ge("close",`
 margin-left: 6px;
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `),ge("label",`
 display: flex;
 align-items: center;
 `)]),T("tabs-bar",`
 position: absolute;
 bottom: 0;
 height: 2px;
 border-radius: 1px;
 background-color: var(--n-bar-color);
 transition:
 left .2s var(--n-bezier),
 max-width .2s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `,[ee("&.transition-disabled",`
 transition: none;
 `),U("disabled",`
 background-color: var(--n-tab-text-color-disabled)
 `)]),T("tabs-pane-wrapper",`
 position: relative;
 overflow: hidden;
 transition: max-height .2s var(--n-bezier);
 `),T("tab-pane",`
 color: var(--n-pane-text-color);
 width: 100%;
 padding: var(--n-pane-padding);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 opacity .2s var(--n-bezier);
 left: 0;
 right: 0;
 top: 0;
 `,[ee("&.next-transition-leave-active, &.prev-transition-leave-active, &.next-transition-enter-active, &.prev-transition-enter-active",`
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 transform .2s var(--n-bezier),
 opacity .2s var(--n-bezier);
 `),ee("&.next-transition-leave-active, &.prev-transition-leave-active",`
 position: absolute;
 `),ee("&.next-transition-enter-from, &.prev-transition-leave-to",`
 transform: translateX(32px);
 opacity: 0;
 `),ee("&.next-transition-leave-to, &.prev-transition-enter-from",`
 transform: translateX(-32px);
 opacity: 0;
 `),ee("&.next-transition-leave-from, &.next-transition-enter-to, &.prev-transition-leave-from, &.prev-transition-enter-to",`
 transform: translateX(0);
 opacity: 1;
 `)]),T("tabs-tab-pad",`
 width: var(--n-tab-gap);
 flex-grow: 0;
 flex-shrink: 0;
 `),U("line-type, bar-type",[T("tabs-tab",`
 font-weight: var(--n-tab-font-weight);
 box-sizing: border-box;
 vertical-align: bottom;
 `,[ee("&:hover",{color:"var(--n-tab-text-color-hover)"}),U("active",`
 color: var(--n-tab-text-color-active);
 font-weight: var(--n-tab-font-weight-active);
 `),U("disabled",{color:"var(--n-tab-text-color-disabled)"})])]),T("tabs-nav",[U("line-type",[ge("prefix, suffix",`
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-tab-border-color);
 `),T("tabs-nav-scroll-content",`
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-tab-border-color);
 `),T("tabs-bar",`
 border-radius: 0;
 bottom: -1px;
 `)]),U("card-type",[ge("prefix, suffix",`
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-tab-border-color);
 `),T("tabs-pad",`
 flex-grow: 1;
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-tab-border-color);
 `),T("tabs-tab-pad",`
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-tab-border-color);
 `),T("tabs-tab",`
 font-weight: var(--n-tab-font-weight);
 border: 1px solid var(--n-tab-border-color);
 border-top-left-radius: var(--n-tab-border-radius);
 border-top-right-radius: var(--n-tab-border-radius);
 background-color: var(--n-tab-color);
 box-sizing: border-box;
 position: relative;
 vertical-align: bottom;
 display: flex;
 justify-content: space-between;
 font-size: var(--n-tab-font-size);
 color: var(--n-tab-text-color);
 `,[U("addable",`
 padding-left: 8px;
 padding-right: 8px;
 font-size: 16px;
 `,[ge("height-placeholder",`
 width: 0;
 font-size: var(--n-tab-font-size);
 `),an("disabled",[ee("&:hover",`
 color: var(--n-tab-text-color-hover);
 `)])]),U("closable","padding-right: 6px;"),U("active",`
 border-bottom: 1px solid #0000;
 background-color: #0000;
 font-weight: var(--n-tab-font-weight-active);
 color: var(--n-tab-text-color-active);
 `),U("disabled","color: var(--n-tab-text-color-disabled);")]),T("tabs-scroll-padding","border-bottom: 1px solid var(--n-tab-border-color);")]),U("left, right",[T("tabs-wrapper",`
 flex-direction: column;
 `,[T("tabs-tab-wrapper",`
 flex-direction: column;
 `,[T("tabs-tab-pad",`
 height: var(--n-tab-gap);
 width: 100%;
 `)])]),T("tabs-nav-scroll-content",`
 border-bottom: none;
 `)]),U("left",[T("tabs-nav-scroll-content",`
 box-sizing: border-box;
 border-right: 1px solid var(--n-tab-border-color);
 `)]),U("right",[T("tabs-nav-scroll-content",`
 border-left: 1px solid var(--n-tab-border-color);
 `)]),U("bottom",[T("tabs-nav-scroll-content",`
 border-top: 1px solid var(--n-tab-border-color);
 border-bottom: none;
 `)])])]),t1=Object.assign(Object.assign({},ct.props),{value:[String,Number],defaultValue:[String,Number],trigger:{type:String,default:"click"},type:{type:String,default:"bar"},closable:Boolean,justifyContent:String,size:{type:String,default:"medium"},placement:{type:String,default:"top"},tabStyle:[String,Object],barWidth:Number,paneClass:String,paneStyle:[String,Object],addable:[Boolean,Object],tabsPadding:{type:Number,default:0},animated:Boolean,onBeforeLeave:Function,onAdd:Function,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onClose:[Function,Array],labelSize:String,activeName:[String,Number],onActiveNameChange:[Function,Array]}),i1=xe({name:"Tabs",props:t1,setup(i,{slots:e}){var t,n,r,o;const{mergedClsPrefixRef:s,inlineThemeDisabled:l}=ei(i),a=ct("Tabs","-tabs",e1,hm,i,s),c=K(null),h=K(null),d=K(null),u=K(null),f=K(null),g=K(!0),x=K(!0),b=ac(i,["labelSize","size"]),S=ac(i,["activeName","value"]),A=K((n=(t=S.value)!==null&&t!==void 0?t:i.defaultValue)!==null&&n!==void 0?n:e.default?(o=(r=Ks(e.default())[0])===null||r===void 0?void 0:r.props)===null||o===void 0?void 0:o.name:null),O=Nn(S,A),R={id:0},k=fe(()=>{if(!(!i.justifyContent||i.type==="card"))return{display:"flex",justifyContent:i.justifyContent}});Lt(O,()=>{R.id=0,v(),W()});function C(){var N;const{value:j}=O;return j===null?null:(N=c.value)===null||N===void 0?void 0:N.querySelector(`[data-name="${j}"]`)}function w(N){if(i.type==="card")return;const{value:j}=h;if(j&&N){const L=`${s.value}-tabs-bar--disabled`,{barWidth:I,placement:le}=i;if(N.dataset.disabled==="true"?j.classList.add(L):j.classList.remove(L),["top","bottom"].includes(le)){if(D(["top","maxHeight","height"]),typeof I=="number"&&N.offsetWidth>=I){const ye=Math.floor((N.offsetWidth-I)/2)+N.offsetLeft;j.style.left=`${ye}px`,j.style.maxWidth=`${I}px`}else j.style.left=`${N.offsetLeft}px`,j.style.maxWidth=`${N.offsetWidth}px`;j.style.width="8192px",j.offsetWidth}else{if(D(["left","maxWidth","width"]),typeof I=="number"&&N.offsetHeight>=I){const ye=Math.floor((N.offsetHeight-I)/2)+N.offsetTop;j.style.top=`${ye}px`,j.style.maxHeight=`${I}px`}else j.style.top=`${N.offsetTop}px`,j.style.maxHeight=`${N.offsetHeight}px`;j.style.height="8192px",j.offsetHeight}}}function D(N){const{value:j}=h;if(j)for(const L of N)j.style[L]=""}function v(){if(i.type==="card")return;const N=C();N&&w(N)}function W(N){var j;const L=(j=f.value)===null||j===void 0?void 0:j.$el;if(!L)return;const I=C();if(!I)return;const{scrollLeft:le,offsetWidth:ye}=L,{offsetLeft:ve,offsetWidth:Oe}=I;le>ve?L.scrollTo({top:0,left:ve,behavior:"smooth"}):ve+Oe>le+ye&&L.scrollTo({top:0,left:ve+Oe-ye,behavior:"smooth"})}const q=K(null);let ne=0,Y=null;function re(N){const j=q.value;if(j){ne=N.getBoundingClientRect().height;const L=`${ne}px`,I=()=>{j.style.height=L,j.style.maxHeight=L};Y?(I(),Y(),Y=null):Y=I}}function oe(N){const j=q.value;if(j){const L=N.getBoundingClientRect().height,I=()=>{document.body.offsetHeight,j.style.maxHeight=`${L}px`,j.style.height=`${Math.max(ne,L)}px`};Y?(Y(),Y=null,I()):Y=I}}function $(){const N=q.value;N&&(N.style.maxHeight="",N.style.height="")}const te={value:[]},E=K("next");function V(N){const j=O.value;let L="next";for(const I of te.value){if(I===j)break;if(I===N){L="prev";break}}E.value=L,H(N)}function H(N){const{onActiveNameChange:j,onUpdateValue:L,"onUpdate:value":I}=i;j&&je(j,N),L&&je(L,N),I&&je(I,N),A.value=N}function G(N){const{onClose:j}=i;j&&je(j,N)}function ue(){const{value:N}=h;if(!N)return;const j="transition-disabled";N.classList.add(j),v(),N.classList.remove(j)}let ke=0;function $e(N){var j;if(N.contentRect.width===0&&N.contentRect.height===0||ke===N.contentRect.width)return;ke=N.contentRect.width;const{type:L}=i;(L==="line"||L==="bar")&&ue(),L!=="segment"&&Ye((j=f.value)===null||j===void 0?void 0:j.$el)}const Me=Gs($e,64);Lt([()=>i.justifyContent,()=>i.size],()=>{Ti(()=>{const{type:N}=i;(N==="line"||N==="bar")&&ue()})});const Ee=K(!1);function Ot(N){var j;const{target:L,contentRect:{width:I}}=N,le=L.parentElement.offsetWidth;if(!Ee.value)le<I&&(Ee.value=!0);else{const{value:ye}=u;if(!ye)return;le-I>ye.$el.offsetWidth&&(Ee.value=!1)}Ye((j=f.value)===null||j===void 0?void 0:j.$el)}const Dt=Gs(Ot,64);function ot(){const{onAdd:N}=i;N&&N(),Ti(()=>{const j=C(),{value:L}=f;!j||!L||L.scrollTo({left:j.offsetLeft,top:0,behavior:"smooth"})})}function Ye(N){if(!N)return;const{scrollLeft:j,scrollWidth:L,offsetWidth:I}=N;g.value=j<=0,x.value=j+I>=L}const tt=Gs(N=>{Ye(N.target)},64);It(Cu,{triggerRef:pe(i,"trigger"),tabStyleRef:pe(i,"tabStyle"),paneClassRef:pe(i,"paneClass"),paneStyleRef:pe(i,"paneStyle"),mergedClsPrefixRef:s,typeRef:pe(i,"type"),closableRef:pe(i,"closable"),valueRef:O,tabChangeIdRef:R,onBeforeLeaveRef:pe(i,"onBeforeLeave"),activateTab:V,handleClose:G,handleAdd:ot}),dm(()=>{v(),W()}),Oi(()=>{const{value:N}=d;if(!N||["left","right"].includes(i.placement))return;const{value:j}=s,L=`${j}-tabs-nav-scroll-wrapper--shadow-before`,I=`${j}-tabs-nav-scroll-wrapper--shadow-after`;g.value?N.classList.remove(L):N.classList.add(L),x.value?N.classList.remove(I):N.classList.add(I)});const J=K(null);Lt(O,()=>{if(i.type==="segment"){const N=J.value;N&&Ti(()=>{N.classList.add("transition-disabled"),N.offsetWidth,N.classList.remove("transition-disabled")})}});const me={syncBarPosition:()=>{v()}},Q=fe(()=>{const{value:N}=b,{type:j}=i,L={card:"Card",bar:"Bar",line:"Line",segment:"Segment"}[j],I=`${N}${L}`,{self:{barColor:le,closeIconColor:ye,closeIconColorHover:ve,closeIconColorPressed:Oe,tabColor:Ae,tabBorderColor:He,paneTextColor:vt,tabFontWeight:qt,tabBorderRadius:hr,tabFontWeightActive:Rn,colorSegment:dr,fontWeightStrong:Pe,tabColorSegment:ur,closeSize:ii,closeIconSize:Mi,closeColorHover:zt,closeColorPressed:ci,closeBorderRadius:Fi,[qe("panePadding",N)]:Ft,[qe("tabPadding",I)]:Mn,[qe("tabPaddingVertical",I)]:hi,[qe("tabGap",I)]:fr,[qe("tabTextColor",j)]:sn,[qe("tabTextColorActive",j)]:Ct,[qe("tabTextColorHover",j)]:On,[qe("tabTextColorDisabled",j)]:pr,[qe("tabFontSize",N)]:_t},common:{cubicBezierEaseInOut:Dn}}=a.value;return{"--n-bezier":Dn,"--n-color-segment":dr,"--n-bar-color":le,"--n-tab-font-size":_t,"--n-tab-text-color":sn,"--n-tab-text-color-active":Ct,"--n-tab-text-color-disabled":pr,"--n-tab-text-color-hover":On,"--n-pane-text-color":vt,"--n-tab-border-color":He,"--n-tab-border-radius":hr,"--n-close-size":ii,"--n-close-icon-size":Mi,"--n-close-color-hover":zt,"--n-close-color-pressed":ci,"--n-close-border-radius":Fi,"--n-close-icon-color":ye,"--n-close-icon-color-hover":ve,"--n-close-icon-color-pressed":Oe,"--n-tab-color":Ae,"--n-tab-font-weight":qt,"--n-tab-font-weight-active":Rn,"--n-tab-padding":Mn,"--n-tab-padding-vertical":hi,"--n-tab-gap":fr,"--n-pane-padding":Ft,"--n-font-weight-strong":Pe,"--n-tab-color-segment":ur}}),Se=l?Ni("tabs",fe(()=>`${b.value[0]}${i.type[0]}`),Q,i):void 0;return Object.assign({mergedClsPrefix:s,mergedValue:O,renderedNames:new Set,tabsRailElRef:J,tabsPaneWrapperRef:q,tabsElRef:c,barElRef:h,addTabInstRef:u,xScrollInstRef:f,scrollWrapperElRef:d,addTabFixed:Ee,tabWrapperStyle:k,handleNavResize:Me,mergedSize:b,handleScroll:tt,handleTabsResize:Dt,cssVars:l?void 0:Q,themeClass:Se==null?void 0:Se.themeClass,animationDirection:E,renderNameListRef:te,onAnimationBeforeLeave:re,onAnimationEnter:oe,onAnimationAfterEnter:$,onRender:Se==null?void 0:Se.onRender},me)},render(){const{mergedClsPrefix:i,type:e,placement:t,addTabFixed:n,addable:r,mergedSize:o,renderNameListRef:s,onRender:l,$slots:{default:a,prefix:c,suffix:h}}=this;l==null||l();const d=a?Ks(a()).filter(A=>A.type.__TAB_PANE__===!0):[],u=a?Ks(a()).filter(A=>A.type.__TAB__===!0):[],f=!u.length,g=e==="card",x=e==="segment",b=!g&&!x&&this.justifyContent;s.value=[];const S=()=>{const A=m("div",{style:this.tabWrapperStyle,class:[`${i}-tabs-wrapper`]},b?null:m("div",{class:`${i}-tabs-scroll-padding`,style:{width:`${this.tabsPadding}px`}}),f?d.map((O,R)=>(s.value.push(O.props.name),Qs(m(Go,Object.assign({},O.props,{internalCreatedByPane:!0,internalLeftPadded:R!==0&&(!b||b==="center"||b==="start"||b==="end")}),O.children?{default:O.children.tab}:void 0)))):u.map((O,R)=>(s.value.push(O.props.name),Qs(R!==0&&!b?Ic(O):O))),!n&&r&&g?Ec(r,(f?d.length:u.length)!==0):null,b?null:m("div",{class:`${i}-tabs-scroll-padding`,style:{width:`${this.tabsPadding}px`}}));return m("div",{ref:"tabsElRef",class:`${i}-tabs-nav-scroll-content`},g&&r?m(cc,{onResize:this.handleTabsResize},{default:()=>A}):A,g?m("div",{class:`${i}-tabs-pad`}):null,g?null:m("div",{ref:"barElRef",class:`${i}-tabs-bar`}))};return m("div",{class:[`${i}-tabs`,this.themeClass,`${i}-tabs--${e}-type`,`${i}-tabs--${o}-size`,b&&`${i}-tabs--flex`,`${i}-tabs--${t}`],style:this.cssVars},m("div",{class:[`${i}-tabs-nav--${e}-type`,`${i}-tabs-nav--${t}`,`${i}-tabs-nav`]},vi(c,A=>A&&m("div",{class:`${i}-tabs-nav__prefix`},A)),x?m("div",{class:`${i}-tabs-rail`,ref:"tabsRailElRef"},f?d.map((A,O)=>(s.value.push(A.props.name),m(Go,Object.assign({},A.props,{internalCreatedByPane:!0,internalLeftPadded:O!==0}),A.children?{default:A.children.tab}:void 0))):u.map((A,O)=>(s.value.push(A.props.name),O===0?A:Ic(A)))):m(cc,{onResize:this.handleNavResize},{default:()=>m("div",{class:`${i}-tabs-nav-scroll-wrapper`,ref:"scrollWrapperElRef"},["top","bottom"].includes(t)?m(Fm,{ref:"xScrollInstRef",onScroll:this.handleScroll},{default:S}):m("div",{class:`${i}-tabs-nav-y-scroll`},S()))}),n&&r&&g?Ec(r,!0):null,vi(h,A=>A&&m("div",{class:`${i}-tabs-nav__suffix`},A))),f&&(this.animated?m("div",{ref:"tabsPaneWrapperRef",class:`${i}-tabs-pane-wrapper`},Bc(d,this.mergedValue,this.renderedNames,this.onAnimationBeforeLeave,this.onAnimationEnter,this.onAnimationAfterEnter,this.animationDirection)):Bc(d,this.mergedValue,this.renderedNames)))}});function Bc(i,e,t,n,r,o,s){const l=[];return i.forEach(a=>{const{name:c,displayDirective:h,"display-directive":d}=a.props,u=g=>h===g||d===g,f=e===c;if(a.key!==void 0&&(a.key=c),f||u("show")||u("show:lazy")&&t.has(c)){t.has(c)||t.add(c);const g=!u("if");l.push(g?vn(a,[[Nr,f]]):a)}}),s?m(um,{name:`${s}-transition`,onBeforeLeave:n,onEnter:r,onAfterEnter:o},{default:()=>l}):l}function Ec(i,e){return m(Go,{ref:"addTabInstRef",key:"__addable",name:"__addable",internalCreatedByPane:!0,internalAddable:!0,internalLeftPadded:e,disabled:typeof i=="object"&&i.disabled})}function Ic(i){const e=Nd(i);return e.props?e.props.internalLeftPadded=!0:e.props={internalLeftPadded:!0},e}function Qs(i){return Array.isArray(i.dynamicProps)?i.dynamicProps.includes("internalLeftPadded")||i.dynamicProps.push("internalLeftPadded"):i.dynamicProps=["internalLeftPadded"],i}const Su=li("n-tree-select"),Qr=li("n-tree"),n1=xe({name:"NTreeSwitcher",props:{clsPrefix:{type:String,required:!0},expanded:Boolean,selected:Boolean,hide:Boolean,loading:Boolean,onClick:Function},setup(i){const{renderSwitcherIconRef:e}=rt(Qr,null);return()=>{const{clsPrefix:t}=i;return m("span",{"data-switcher":!0,class:[`${t}-tree-node-switcher`,i.expanded&&`${t}-tree-node-switcher--expanded`,i.hide&&`${t}-tree-node-switcher--hide`],onClick:i.onClick},m("div",{class:`${t}-tree-node-switcher__icon`},m(ka,null,{default:()=>{if(i.loading)return m(Kd,{clsPrefix:t,key:"loading",radius:85,strokeWidth:20});const{value:n}=e;return n?n({expanded:i.expanded,selected:i.selected}):m(_e,{clsPrefix:t,key:"switcher"},{default:()=>m(Y0,null)})}})))}}}),r1=xe({name:"NTreeNodeCheckbox",props:{clsPrefix:{type:String,required:!0},right:Boolean,focusable:Boolean,disabled:Boolean,checked:Boolean,indeterminate:Boolean,onCheck:Function},setup(i){const e=rt(Qr);function t(r){const{onCheck:o}=i;if(o)return o(r)}function n(r){i.indeterminate?t(!1):t(r)}return{handleUpdateValue:n,mergedTheme:e.mergedThemeRef}},render(){const{clsPrefix:i,mergedTheme:e,checked:t,indeterminate:n,disabled:r,focusable:o,handleUpdateValue:s}=this;return m("span",{class:[`${i}-tree-node-checkbox`,this.right&&`${i}-tree-node-checkbox--right`],"data-checkbox":!0},m(fm,{focusable:o,disabled:r,theme:e.peers.Checkbox,themeOverrides:e.peerOverrides.Checkbox,checked:t,indeterminate:n,onUpdateChecked:s}))}}),o1=xe({name:"TreeNodeContent",props:{clsPrefix:{type:String,required:!0},disabled:Boolean,checked:Boolean,selected:Boolean,onClick:Function,onDragstart:Function,tmNode:{type:Object,required:!0},nodeProps:Object},setup(i){const{renderLabelRef:e,renderPrefixRef:t,renderSuffixRef:n,labelFieldRef:r}=rt(Qr),o=K(null);function s(a){const{onClick:c}=i;c&&c(a)}function l(a){s(a)}return{selfRef:o,renderLabel:e,renderPrefix:t,renderSuffix:n,labelField:r,handleClick:l}},render(){const{clsPrefix:i,labelField:e,nodeProps:t,checked:n=!1,selected:r=!1,renderLabel:o,renderPrefix:s,renderSuffix:l,handleClick:a,onDragstart:c,tmNode:{rawNode:h,rawNode:{prefix:d,suffix:u,[e]:f}}}=this;return m("span",Object.assign({},t,{ref:"selfRef",class:[`${i}-tree-node-content`,t==null?void 0:t.class],onClick:a,draggable:c===void 0?void 0:!0,onDragstart:c}),s||d?m("div",{class:`${i}-tree-node-content__prefix`},s?s({option:h,selected:r,checked:n}):ri(d)):null,m("div",{class:`${i}-tree-node-content__text`},o?o({option:h,selected:r,checked:n}):ri(f)),l||u?m("div",{class:`${i}-tree-node-content__suffix`},l?l({option:h,selected:r,checked:n}):ri(u)):null)}});function Nc({position:i,offsetLevel:e,indent:t,el:n}){const r={position:"absolute",boxSizing:"border-box",right:0};if(i==="inside")r.left=0,r.top=0,r.bottom=0,r.borderRadius="inherit",r.boxShadow="inset 0 0 0 2px var(--n-drop-mark-color)";else{const o=i==="before"?"top":"bottom";r[o]=0,r.left=`${n.offsetLeft+6-e*t}px`,r.height="2px",r.backgroundColor="var(--n-drop-mark-color)",r.transformOrigin=o,r.borderRadius="1px",r.transform=i==="before"?"translateY(-4px)":"translateY(4px)"}return m("div",{style:r})}function s1({dropPosition:i,node:e}){return e.isLeaf===!1||e.children?!0:i!=="inside"}function l1(i){return fe(()=>i.leafOnly?"child":i.checkStrategy)}function ji(i,e){return!!i.rawNode[e]}function Au(i,e,t,n){i==null||i.forEach(r=>{t(r),Au(r[e],e,t,n),n(r)})}function a1(i,e,t,n,r){const o=new Set,s=new Set,l=[];return Au(i,n,a=>{if(l.push(a),r(e,a)){s.add(a[t]);for(let c=l.length-2;c>=0;--c)if(!o.has(l[c][t]))o.add(l[c][t]);else return}},()=>{l.pop()}),{expandedKeys:Array.from(o),highlightKeySet:s}}if(ys&&Image){const i=new Image;i.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}function c1(i,e,t,n,r){const o=new Set,s=new Set,l=new Set,a=[],c=[],h=[];function d(f){f.forEach(g=>{if(h.push(g),e(t,g)){o.add(g[n]),l.add(g[n]);for(let b=h.length-2;b>=0;--b){const S=h[b][n];if(!s.has(S))s.add(S),o.has(S)&&o.delete(S);else break}}const x=g[r];x&&d(x),h.pop()})}d(i);function u(f,g){f.forEach(x=>{const b=x[n],S=o.has(b),A=s.has(b);if(!S&&!A)return;const O=x[r];if(O)if(S)g.push(x);else{a.push(b);const R=Object.assign(Object.assign({},x),{[r]:[]});g.push(R),u(O,R[r])}else g.push(x)})}return u(i,c),{filteredTree:c,highlightKeySet:l,expandedKeys:a}}const h1=xe({name:"TreeNode",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(i){const e=rt(Qr),{droppingNodeParentRef:t,droppingMouseNodeRef:n,draggingNodeRef:r,droppingPositionRef:o,droppingOffsetLevelRef:s,nodePropsRef:l,indentRef:a,blockLineRef:c,checkboxPlacementRef:h,checkOnClickRef:d,disabledFieldRef:u}=e,f=yt(()=>!!i.tmNode.rawNode.checkboxDisabled),g=yt(()=>ji(i.tmNode,u.value)),x=yt(()=>e.disabledRef.value||g.value),b=fe(()=>{const{value:E}=l;if(E)return E({option:i.tmNode.rawNode})}),S=K(null),A={value:null};Yi(()=>{A.value=S.value.$el});function O(){const{tmNode:E}=i;if(!E.isLeaf&&!E.shallowLoaded){if(!e.loadingKeysRef.value.has(E.key))e.loadingKeysRef.value.add(E.key);else return;const{onLoadRef:{value:V}}=e;V&&V(E.rawNode).then(H=>{H!==!1&&e.handleSwitcherClick(E)}).finally(()=>{e.loadingKeysRef.value.delete(E.key)})}else e.handleSwitcherClick(E)}const R=yt(()=>!g.value&&e.selectableRef.value&&(e.internalTreeSelect?e.mergedCheckStrategyRef.value!=="child"||e.multipleRef.value&&e.cascadeRef.value||i.tmNode.isLeaf:!0)),k=yt(()=>e.checkableRef.value&&(e.cascadeRef.value||e.mergedCheckStrategyRef.value!=="child"||i.tmNode.isLeaf)),C=yt(()=>e.displayedCheckedKeysRef.value.includes(i.tmNode.key)),w=yt(()=>{const{value:E}=k;if(!E)return!1;const{value:V}=d;return typeof V=="boolean"?V:V(i.tmNode.rawNode)});function D(E){const{value:V}=e.expandOnClickRef,{value:H}=R,{value:G}=w;if(!H&&!V&&!G||hc(E,"checkbox")||hc(E,"switcher"))return;const{tmNode:ue}=i;H&&e.handleSelect(ue),V&&!ue.isLeaf&&O(),G&&q(!C.value)}function v(E){var V,H;c.value||(x.value||D(E),(H=(V=b.value)===null||V===void 0?void 0:V.onClick)===null||H===void 0||H.call(V,E))}function W(E){var V,H;c.value&&(x.value||D(E),(H=(V=b.value)===null||V===void 0?void 0:V.onClick)===null||H===void 0||H.call(V,E))}function q(E){e.handleCheck(i.tmNode,E)}function ne(E){e.handleDragStart({event:E,node:i.tmNode})}function Y(E){E.currentTarget===E.target&&e.handleDragEnter({event:E,node:i.tmNode})}function re(E){E.preventDefault(),e.handleDragOver({event:E,node:i.tmNode})}function oe(E){e.handleDragEnd({event:E,node:i.tmNode})}function $(E){E.currentTarget===E.target&&e.handleDragLeave({event:E,node:i.tmNode})}function te(E){E.preventDefault(),o.value!==null&&e.handleDrop({event:E,node:i.tmNode,dropPosition:o.value})}return{showDropMark:yt(()=>{const{value:E}=r;if(!E)return;const{value:V}=o;if(!V)return;const{value:H}=n;if(!H)return;const{tmNode:G}=i;return G.key===H.key}),showDropMarkAsParent:yt(()=>{const{value:E}=t;if(!E)return!1;const{tmNode:V}=i,{value:H}=o;return H==="before"||H==="after"?E.key===V.key:!1}),pending:yt(()=>e.pendingNodeKeyRef.value===i.tmNode.key),loading:yt(()=>e.loadingKeysRef.value.has(i.tmNode.key)),highlight:yt(()=>{var E;return(E=e.highlightKeySetRef.value)===null||E===void 0?void 0:E.has(i.tmNode.key)}),checked:C,indeterminate:yt(()=>e.displayedIndeterminateKeysRef.value.includes(i.tmNode.key)),selected:yt(()=>e.mergedSelectedKeysRef.value.includes(i.tmNode.key)),expanded:yt(()=>e.mergedExpandedKeysRef.value.includes(i.tmNode.key)),disabled:x,checkable:k,mergedCheckOnClick:w,checkboxDisabled:f,selectable:R,expandOnClick:e.expandOnClickRef,internalScrollable:e.internalScrollableRef,draggable:e.draggableRef,blockLine:c,nodeProps:b,checkboxFocusable:e.internalCheckboxFocusableRef,droppingPosition:o,droppingOffsetLevel:s,indent:a,checkboxPlacement:h,contentInstRef:S,contentElRef:A,handleCheck:q,handleDrop:te,handleDragStart:ne,handleDragEnter:Y,handleDragOver:re,handleDragEnd:oe,handleDragLeave:$,handleLineClick:W,handleContentClick:v,handleSwitcherClick:O}},render(){const{tmNode:i,clsPrefix:e,checkable:t,expandOnClick:n,selectable:r,selected:o,checked:s,highlight:l,draggable:a,blockLine:c,indent:h,disabled:d,pending:u,internalScrollable:f,nodeProps:g,checkboxPlacement:x}=this,b=a&&!d?{onDragenter:this.handleDragEnter,onDragleave:this.handleDragLeave,onDragend:this.handleDragEnd,onDrop:this.handleDrop,onDragover:this.handleDragOver}:void 0,S=f?Yd(i.key):void 0,A=x==="right",O=t?m(r1,{right:A,focusable:this.checkboxFocusable,disabled:d||this.checkboxDisabled,clsPrefix:e,checked:this.checked,indeterminate:this.indeterminate,onCheck:this.handleCheck}):null;return m("div",Object.assign({class:`${e}-tree-node-wrapper`},b),m("div",Object.assign({},c?g:void 0,{class:[`${e}-tree-node`,{[`${e}-tree-node--selected`]:o,[`${e}-tree-node--checkable`]:t,[`${e}-tree-node--highlight`]:l,[`${e}-tree-node--pending`]:u,[`${e}-tree-node--disabled`]:d,[`${e}-tree-node--selectable`]:r,[`${e}-tree-node--clickable`]:r||n||this.mergedCheckOnClick},g==null?void 0:g.class],"data-key":S,draggable:a&&c,onClick:this.handleLineClick,onDragstart:a&&c&&!d?this.handleDragStart:void 0}),pm(i.level,m("div",{class:`${e}-tree-node-indent`},m("div",{style:{width:`${h}px`}}))),m(n1,{clsPrefix:e,expanded:this.expanded,selected:o,loading:this.loading,hide:i.isLeaf,onClick:this.handleSwitcherClick}),A?null:O,m(o1,{ref:"contentInstRef",clsPrefix:e,checked:s,selected:o,onClick:this.handleContentClick,nodeProps:c?void 0:g,onDragstart:a&&!c&&!d?this.handleDragStart:void 0,tmNode:i}),a?this.showDropMark?Nc({el:this.contentElRef.value,position:this.droppingPosition,offsetLevel:this.droppingOffsetLevel,indent:h}):this.showDropMarkAsParent?Nc({el:this.contentElRef.value,position:"inside",offsetLevel:this.droppingOffsetLevel,indent:h}):null:null,A?O:null))}}),Ru=h1;function d1({props:i,fNodesRef:e,mergedExpandedKeysRef:t,mergedSelectedKeysRef:n,handleSelect:r,handleSwitcherClick:o}){const{value:s}=n,l=rt(Su,null),a=l?l.pendingNodeKeyRef:K(s.length?s[s.length-1]:null);function c(h){if(!i.keyboard)return;const{value:d}=a;if(d===null){if((h.key==="ArrowDown"||h.key==="ArrowUp")&&h.preventDefault(),["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(h.key)&&d===null){const{value:u}=e;let f=0;for(;f<u.length;){if(!u[f].disabled){a.value=u[f].key;break}f+=1}}}else{const{value:u}=e;let f=u.findIndex(g=>g.key===d);if(!~f)return;if(h.key==="Enter")r(u[f]);else if(h.key==="ArrowDown")for(h.preventDefault(),f+=1;f<u.length;){if(!u[f].disabled){a.value=u[f].key;break}f+=1}else if(h.key==="ArrowUp")for(h.preventDefault(),f-=1;f>=0;){if(!u[f].disabled){a.value=u[f].key;break}f-=1}else if(h.key==="ArrowLeft"){const g=u[f];if(g.isLeaf||!t.value.includes(d)){const x=g.getParent();x&&(a.value=x.key)}else o(g)}else if(h.key==="ArrowRight"){const g=u[f];if(g.isLeaf)return;if(!t.value.includes(d))o(g);else for(f+=1;f<u.length;){if(!u[f].disabled){a.value=u[f].key;break}f+=1}}}}return{pendingNodeKeyRef:a,handleKeydown:c}}const u1=xe({name:"TreeMotionWrapper",props:{clsPrefix:{type:String,required:!0},height:Number,nodes:{type:Array,required:!0},mode:{type:String,required:!0},onAfterEnter:{type:Function,required:!0}},render(){const{clsPrefix:i}=this;return m(Ss,{onAfterEnter:this.onAfterEnter,appear:!0,reverse:this.mode==="collapse"},{default:()=>m("div",{class:[`${i}-tree-motion-wrapper`,`${i}-tree-motion-wrapper--${this.mode}`],style:{height:gm(this.height)}},this.nodes.map(e=>m(Ru,{clsPrefix:i,tmNode:e})))})}}),f1=T("tree",`
 font-size: var(--n-font-size);
 outline: none;
`,[ee("ul, li",`
 margin: 0;
 padding: 0;
 list-style: none;
 `),ee(">",[T("tree-node",[ee("&:first-child",{marginTop:0})])]),T("tree-node-indent",`
 flex-grow: 0;
 flex-shrink: 0;
 height: 0;
 `),T("tree-motion-wrapper",[U("expand",[Fr({duration:"0.2s"})]),U("collapse",[Fr({duration:"0.2s",reverse:!0})])]),T("tree-node-wrapper",`
 box-sizing: border-box;
 padding: 3px 0;
 `),T("tree-node",`
 transform: translate3d(0,0,0);
 position: relative;
 display: flex;
 border-radius: var(--n-node-border-radius);
 transition: background-color .3s var(--n-bezier);
 `,[U("highlight",[T("tree-node-content",[ge("text",{borderBottomColor:"var(--n-node-text-color-disabled)"})])]),U("disabled",[T("tree-node-content",`
 color: var(--n-node-text-color-disabled);
 cursor: not-allowed;
 `)]),an("disabled",[U("clickable",[T("tree-node-content",`
 cursor: pointer;
 `)])])]),U("block-node",[T("tree-node-content",`
 flex: 1;
 min-width: 0;
 `)]),an("block-line",[T("tree-node",[an("disabled",[T("tree-node-content",[ee("&:hover",{backgroundColor:"var(--n-node-color-hover)"})]),U("selectable",[T("tree-node-content",[ee("&:active",{backgroundColor:"var(--n-node-color-pressed)"})])]),U("pending",[T("tree-node-content",`
 background-color: var(--n-node-color-hover);
 `)]),U("selected",[T("tree-node-content",{backgroundColor:"var(--n-node-color-active)"})])])])]),U("block-line",[T("tree-node",[an("disabled",[ee("&:hover",{backgroundColor:"var(--n-node-color-hover)"}),U("pending",`
 background-color: var(--n-node-color-hover);
 `),U("selectable",[an("selected",[ee("&:active",{backgroundColor:"var(--n-node-color-pressed)"})])]),U("selected",{backgroundColor:"var(--n-node-color-active)"})]),U("disabled",`
 cursor: not-allowed;
 `)])]),T("tree-node-switcher",`
 cursor: pointer;
 display: inline-flex;
 flex-shrink: 0;
 height: 24px;
 width: 24px;
 align-items: center;
 justify-content: center;
 transition: transform .15s var(--n-bezier);
 vertical-align: bottom;
 `,[ge("icon",`
 position: relative;
 height: 14px;
 width: 14px;
 display: flex;
 color: var(--n-arrow-color);
 transition: color .3s var(--n-bezier);
 font-size: 14px;
 `,[T("icon",[Tr()]),T("base-loading",`
 color: var(--n-loading-color);
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 `,[Tr()]),T("base-icon",[Tr()])]),U("hide",{visibility:"hidden"}),U("expanded",{transform:"rotate(90deg)"})]),T("tree-node-checkbox",`
 display: inline-flex;
 height: 24px;
 width: 16px;
 vertical-align: bottom;
 align-items: center;
 justify-content: center;
 margin-right: 4px;
 `,[U("right","margin-left: 4px;")]),U("checkable",[T("tree-node-content",`
 padding: 0 6px;
 `)]),T("tree-node-content",`
 position: relative;
 display: inline-flex;
 align-items: center;
 min-height: 24px;
 box-sizing: border-box;
 line-height: 1.5;
 vertical-align: bottom;
 padding: 0 6px 0 4px;
 cursor: default;
 border-radius: var(--n-node-border-radius);
 text-decoration-color: #0000;
 text-decoration-line: underline;
 color: var(--n-node-text-color);
 transition:
 color .3s var(--n-bezier),
 text-decoration-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[ee("&:last-child",{marginBottom:0}),ge("prefix",`
 display: inline-flex;
 margin-right: 8px;
 `),ge("text",`
 border-bottom: 1px solid #0000;
 transition: border-color .3s var(--n-bezier);
 flex-grow: 1;
 max-width: 100%;
 `),ge("suffix",`
 display: inline-flex;
 `)]),ge("empty","margin: auto;")]);var p1=globalThis&&globalThis.__awaiter||function(i,e,t,n){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function l(h){try{c(n.next(h))}catch(d){s(d)}}function a(h){try{c(n.throw(h))}catch(d){s(d)}}function c(h){h.done?o(h.value):r(h.value).then(l,a)}c((n=n.apply(i,e||[])).next())})};const fo=30;function g1(i,e,t,n){return{getIsGroup(){return!1},getKey(o){return o[i]},getChildren:n||(o=>o[e]),getDisabled(o){return!!(o[t]||o.checkboxDisabled)}}}const m1={allowCheckingNotLoaded:Boolean,filter:Function,defaultExpandAll:Boolean,expandedKeys:Array,keyField:{type:String,default:"key"},labelField:{type:String,default:"label"},childrenField:{type:String,default:"children"},disabledField:{type:String,default:"disabled"},defaultExpandedKeys:{type:Array,default:()=>[]},indeterminateKeys:Array,renderSwitcherIcon:Function,onUpdateIndeterminateKeys:[Function,Array],"onUpdate:indeterminateKeys":[Function,Array],onUpdateExpandedKeys:[Function,Array],"onUpdate:expandedKeys":[Function,Array]},v1=Object.assign(Object.assign(Object.assign(Object.assign({},ct.props),{accordion:Boolean,showIrrelevantNodes:{type:Boolean,default:!0},data:{type:Array,default:()=>[]},expandOnDragenter:{type:Boolean,default:!0},expandOnClick:Boolean,checkOnClick:{type:[Boolean,Function],default:!1},cancelable:{type:Boolean,default:!0},checkable:Boolean,draggable:Boolean,blockNode:Boolean,blockLine:Boolean,disabled:Boolean,checkedKeys:Array,defaultCheckedKeys:{type:Array,default:()=>[]},selectedKeys:Array,defaultSelectedKeys:{type:Array,default:()=>[]},multiple:Boolean,pattern:{type:String,default:""},onLoad:Function,cascade:Boolean,selectable:{type:Boolean,default:!0},indent:{type:Number,default:16},allowDrop:{type:Function,default:s1},animated:{type:Boolean,default:!0},checkboxPlacement:{type:String,default:"left"},virtualScroll:Boolean,watchProps:Array,renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,keyboard:{type:Boolean,default:!0},getChildren:Function,onDragenter:[Function,Array],onDragleave:[Function,Array],onDragend:[Function,Array],onDragstart:[Function,Array],onDragover:[Function,Array],onDrop:[Function,Array],onUpdateCheckedKeys:[Function,Array],"onUpdate:checkedKeys":[Function,Array],onUpdateSelectedKeys:[Function,Array],"onUpdate:selectedKeys":[Function,Array]}),m1),{internalTreeSelect:Boolean,internalScrollable:Boolean,internalScrollablePadding:String,internalRenderEmpty:Function,internalHighlightKeySet:Object,internalUnifySelectCheck:Boolean,internalCheckboxFocusable:{type:Boolean,default:!0},internalFocusable:{type:Boolean,default:!0},checkStrategy:{type:String,default:"all"},leafOnly:Boolean}),b1=xe({name:"Tree",props:v1,setup(i){const{mergedClsPrefixRef:e,inlineThemeDisabled:t,mergedRtlRef:n}=ei(i),r=ya("Tree",n,e),o=ct("Tree","-tree",f1,mm,i,e),s=K(null),l=K(null),a=K(null);function c(){var M;return(M=a.value)===null||M===void 0?void 0:M.listElRef}function h(){var M;return(M=a.value)===null||M===void 0?void 0:M.itemsElRef}const d=fe(()=>{const{filter:M}=i;if(M)return M;const{labelField:F}=i;return(Z,ie)=>{if(!Z.length)return!0;const ae=ie[F];return typeof ae=="string"?ae.toLowerCase().includes(Z.toLowerCase()):!1}}),u=fe(()=>{const{pattern:M}=i;return M?!M.length||!d.value?{filteredTree:i.data,highlightKeySet:null,expandedKeys:void 0}:c1(i.data,d.value,M,i.keyField,i.childrenField):{filteredTree:i.data,highlightKeySet:null,expandedKeys:void 0}}),f=fe(()=>vm(i.showIrrelevantNodes?i.data:u.value.filteredTree,g1(i.keyField,i.childrenField,i.disabledField,i.getChildren))),g=rt(Su,null),x=i.internalTreeSelect?g.dataTreeMate:f,{watchProps:b}=i,S=K([]);b!=null&&b.includes("defaultCheckedKeys")?Oi(()=>{S.value=i.defaultCheckedKeys}):S.value=i.defaultCheckedKeys;const A=pe(i,"checkedKeys"),O=Nn(A,S),R=fe(()=>x.value.getCheckedKeys(O.value,{cascade:i.cascade,allowNotLoaded:i.allowCheckingNotLoaded})),k=l1(i),C=fe(()=>R.value.checkedKeys),w=fe(()=>{const{indeterminateKeys:M}=i;return M!==void 0?M:R.value.indeterminateKeys}),D=K([]);b!=null&&b.includes("defaultSelectedKeys")?Oi(()=>{D.value=i.defaultSelectedKeys}):D.value=i.defaultSelectedKeys;const v=pe(i,"selectedKeys"),W=Nn(v,D),q=K([]),ne=M=>{q.value=i.defaultExpandAll?x.value.getNonLeafKeys():M===void 0?i.defaultExpandedKeys:M};b!=null&&b.includes("defaultExpandedKeys")?Oi(()=>ne(void 0)):Oi(()=>ne(i.defaultExpandedKeys));const Y=pe(i,"expandedKeys"),re=Nn(Y,q),oe=fe(()=>f.value.getFlattenedNodes(re.value)),{pendingNodeKeyRef:$,handleKeydown:te}=d1({props:i,mergedSelectedKeysRef:W,fNodesRef:oe,mergedExpandedKeysRef:re,handleSelect:hi,handleSwitcherClick:Mn});let E=null,V=null;const H=K(new Set),G=fe(()=>i.internalHighlightKeySet||u.value.highlightKeySet),ue=Nn(G,H),ke=K(new Set),$e=fe(()=>re.value.filter(M=>!ke.value.has(M)));let Me=0;const Ee=K(null),Ot=K(null),Dt=K(null),ot=K(null),Ye=K(0),tt=fe(()=>{const{value:M}=Ot;return M?M.parent:null});Lt(pe(i,"data"),()=>{ke.value.clear(),$.value=null,ii()},{deep:!1});let J=!1;const me=()=>{J=!0,Ti(()=>{J=!1})};let Q;Lt(pe(i,"pattern"),(M,F)=>{if(i.showIrrelevantNodes)if(Q=void 0,M){const{expandedKeys:Z,highlightKeySet:ie}=a1(i.data,i.pattern,i.keyField,i.childrenField,d.value);H.value=ie,me(),Oe(Z,ve(Z),{node:null,action:"filter"})}else H.value=new Set;else if(!M.length)Q!==void 0&&(me(),Oe(Q,ve(Q),{node:null,action:"filter"}));else{F.length||(Q=re.value);const{expandedKeys:Z}=u.value;Z!==void 0&&(me(),Oe(Z,ve(Z),{node:null,action:"filter"}))}});function Se(M){return p1(this,void 0,void 0,function*(){const{onLoad:F}=i;if(!F)return yield Promise.resolve();const{value:Z}=ke;if(!Z.has(M.key)){Z.add(M.key);try{(yield F(M.rawNode))===!1&&ci()}catch(ie){console.error(ie),ci()}Z.delete(M.key)}})}Oi(()=>{var M;const{value:F}=f;if(!F)return;const{getNode:Z}=F;(M=re.value)===null||M===void 0||M.forEach(ie=>{const ae=Z(ie);ae&&!ae.shallowLoaded&&Se(ae)})});const N=K(!1),j=K([]);Lt($e,(M,F)=>{if(!i.animated||J){Ti(le);return}const Z=new Set(F);let ie=null,ae=null;for(const Ue of M)if(!Z.has(Ue)){if(ie!==null)return;ie=Ue}const st=new Set(M);for(const Ue of F)if(!st.has(Ue)){if(ae!==null)return;ae=Ue}if(ie===null&&ae===null)return;const{virtualScroll:Ze}=i,ni=(Ze?a.value.listElRef:s.value).offsetHeight,Gt=Math.ceil(ni/fo)+1;let $t;if(ie!==null&&($t=F),ae!==null&&($t===void 0?$t=M:$t=$t.filter(Ue=>Ue!==ae)),N.value=!0,j.value=f.value.getFlattenedNodes($t),ie!==null){const Ue=j.value.findIndex(Qe=>Qe.key===ie);if(~Ue){const Qe=j.value[Ue].children;if(Qe){const ui=dc(Qe,M);j.value.splice(Ue+1,0,{__motion:!0,mode:"expand",height:Ze?ui.length*fo:void 0,nodes:Ze?ui.slice(0,Gt):ui})}}}if(ae!==null){const Ue=j.value.findIndex(Qe=>Qe.key===ae);if(~Ue){const Qe=j.value[Ue].children;if(!Qe)return;N.value=!0;const ui=dc(Qe,M);j.value.splice(Ue+1,0,{__motion:!0,mode:"collapse",height:Ze?ui.length*fo:void 0,nodes:Ze?ui.slice(0,Gt):ui})}}});const L=fe(()=>bm(oe.value)),I=fe(()=>N.value?j.value:oe.value);function le(){const{value:M}=l;M&&M.sync()}function ye(){N.value=!1,i.virtualScroll&&Ti(le)}function ve(M){const{getNode:F}=x.value;return M.map(Z=>{var ie;return((ie=F(Z))===null||ie===void 0?void 0:ie.rawNode)||null})}function Oe(M,F,Z){const{"onUpdate:expandedKeys":ie,onUpdateExpandedKeys:ae}=i;q.value=M,ie&&je(ie,M,F,Z),ae&&je(ae,M,F,Z)}function Ae(M,F,Z){const{"onUpdate:checkedKeys":ie,onUpdateCheckedKeys:ae}=i;S.value=M,ae&&je(ae,M,F,Z),ie&&je(ie,M,F,Z)}function He(M,F){const{"onUpdate:indeterminateKeys":Z,onUpdateIndeterminateKeys:ie}=i;Z&&je(Z,M,F),ie&&je(ie,M,F)}function vt(M,F,Z){const{"onUpdate:selectedKeys":ie,onUpdateSelectedKeys:ae}=i;D.value=M,ae&&je(ae,M,F,Z),ie&&je(ie,M,F,Z)}function qt(M){const{onDragenter:F}=i;F&&je(F,M)}function hr(M){const{onDragleave:F}=i;F&&je(F,M)}function Rn(M){const{onDragend:F}=i;F&&je(F,M)}function dr(M){const{onDragstart:F}=i;F&&je(F,M)}function Pe(M){const{onDragover:F}=i;F&&je(F,M)}function ur(M){const{onDrop:F}=i;F&&je(F,M)}function ii(){Mi(),zt()}function Mi(){Ee.value=null}function zt(){Ye.value=0,Ot.value=null,Dt.value=null,ot.value=null,ci()}function ci(){E&&(window.clearTimeout(E),E=null),V=null}function Fi(M,F){if(i.disabled||ji(M,i.disabledField))return;if(i.internalUnifySelectCheck&&!i.multiple){hi(M);return}const Z=F?"check":"uncheck",{checkedKeys:ie,indeterminateKeys:ae}=x.value[Z](M.key,C.value,{cascade:i.cascade,checkStrategy:k.value,allowNotLoaded:i.allowCheckingNotLoaded});Ae(ie,ve(ie),{node:M.rawNode,action:Z}),He(ae,ve(ae))}function Ft(M){if(i.disabled)return;const{key:F}=M,{value:Z}=re,ie=Z.findIndex(ae=>ae===F);if(~ie){const ae=Array.from(Z);ae.splice(ie,1),Oe(ae,ve(ae),{node:M.rawNode,action:"collapse"})}else{const ae=f.value.getNode(F);if(!ae||ae.isLeaf)return;let st;if(i.accordion){const Ze=new Set(M.siblings.map(({key:ni})=>ni));st=Z.filter(ni=>!Ze.has(ni)),st.push(F)}else st=Z.concat(F);Oe(st,ve(st),{node:M.rawNode,action:"expand"})}}function Mn(M){i.disabled||N.value||Ft(M)}function hi(M){if(!(i.disabled||!i.selectable)){if($.value=M.key,i.internalUnifySelectCheck){const{value:{checkedKeys:F,indeterminateKeys:Z}}=R;i.multiple?Fi(M,!(F.includes(M.key)||Z.includes(M.key))):Ae([M.key],ve([M.key]),{node:M.rawNode,action:"check"})}if(i.multiple){const F=Array.from(W.value),Z=F.findIndex(ie=>ie===M.key);~Z?i.cancelable&&F.splice(Z,1):~Z||F.push(M.key),vt(F,ve(F),{node:M.rawNode,action:~Z?"unselect":"select"})}else W.value.includes(M.key)?i.cancelable&&vt([],[],{node:M.rawNode,action:"unselect"}):vt([M.key],ve([M.key]),{node:M.rawNode,action:"select"})}}function fr(M){if(E&&(window.clearTimeout(E),E=null),M.isLeaf)return;V=M.key;const F=()=>{if(V!==M.key)return;const{value:Z}=Dt;if(Z&&Z.key===M.key&&!re.value.includes(M.key)){const ie=re.value.concat(M.key);Oe(ie,ve(ie),{node:M.rawNode,action:"expand"})}E=null,V=null};M.shallowLoaded?E=window.setTimeout(()=>{F()},1e3):E=window.setTimeout(()=>{Se(M).then(()=>{F()})},1e3)}function sn({event:M,node:F}){!i.draggable||i.disabled||ji(F,i.disabledField)||(Dn({event:M,node:F},!1),qt({event:M,node:F.rawNode}))}function Ct({event:M,node:F}){!i.draggable||i.disabled||ji(F,i.disabledField)||hr({event:M,node:F.rawNode})}function On(M){M.target===M.currentTarget&&zt()}function pr({event:M,node:F}){ii(),!(!i.draggable||i.disabled||ji(F,i.disabledField))&&Rn({event:M,node:F.rawNode})}function _t({event:M,node:F}){!i.draggable||i.disabled||ji(F,i.disabledField)||(Me=M.clientX,Ee.value=F,dr({event:M,node:F.rawNode}))}function Dn({event:M,node:F},Z=!0){var ie;if(!i.draggable||i.disabled||ji(F,i.disabledField))return;const{value:ae}=Ee;if(!ae)return;const{allowDrop:st,indent:Ze}=i;Z&&Pe({event:M,node:F.rawNode});const ni=M.currentTarget,{height:Gt,top:$t}=ni.getBoundingClientRect(),Ue=M.clientY-$t;let Qe;st({node:F.rawNode,dropPosition:"inside",phase:"drag"})?Ue<=8?Qe="before":Ue>=Gt-8?Qe="after":Qe="inside":Ue<=Gt/2?Qe="before":Qe="after";const{value:ao}=L;let Ie,bt;const mr=ao(F.key);if(mr===null){zt();return}let p=!1;Qe==="inside"?(Ie=F,bt="inside"):Qe==="before"?F.isFirstChild?(Ie=F,bt="before"):(Ie=oe.value[mr-1],bt="after"):(Ie=F,bt="after"),!Ie.isLeaf&&re.value.includes(Ie.key)&&(p=!0,bt==="after"&&(Ie=oe.value[mr+1],Ie?bt="before":(Ie=F,bt="inside")));const y=Ie;if(Dt.value=y,!p&&ae.isLastChild&&ae.key===Ie.key&&(bt="after"),bt==="after"){let B=Me-M.clientX,_=0;for(;B>=Ze/2&&Ie.parent!==null&&Ie.isLastChild&&_<1;)B-=Ze,_+=1,Ie=Ie.parent;Ye.value=_}else Ye.value=0;if((ae.contains(Ie)||bt==="inside"&&((ie=ae.parent)===null||ie===void 0?void 0:ie.key)===Ie.key)&&!(ae.key===y.key&&ae.key===Ie.key)){zt();return}if(!st({node:Ie.rawNode,dropPosition:bt,phase:"drag"})){zt();return}if(ae.key===Ie.key)ci();else if(V!==Ie.key)if(bt==="inside"){if(i.expandOnDragenter){if(fr(Ie),!Ie.shallowLoaded&&V!==Ie.key){ii();return}}else if(!Ie.shallowLoaded){ii();return}}else ci();else bt!=="inside"&&ci();ot.value=bt,Ot.value=Ie}function so({event:M,node:F,dropPosition:Z}){if(!i.draggable||i.disabled||ji(F,i.disabledField))return;const{value:ie}=Ee,{value:ae}=Ot,{value:st}=ot;if(!(!ie||!ae||!st)&&i.allowDrop({node:ae.rawNode,dropPosition:st,phase:"drag"})&&ie.key!==ae.key){if(st==="before"){const Ze=ie.getNext({includeDisabled:!0});if(Ze&&Ze.key===ae.key){zt();return}}if(st==="after"){const Ze=ie.getPrev({includeDisabled:!0});if(Ze&&Ze.key===ae.key){zt();return}}ur({event:M,node:ae.rawNode,dragNode:ie.rawNode,dropPosition:Z}),ii()}}function lo(){le()}function Us(){le()}function $i(M){var F;if(i.virtualScroll||i.internalScrollable){const{value:Z}=l;if(!((F=Z==null?void 0:Z.containerRef)===null||F===void 0)&&F.contains(M.relatedTarget))return;$.value=null}else{const{value:Z}=s;if(Z!=null&&Z.contains(M.relatedTarget))return;$.value=null}}Lt($,M=>{var F,Z;if(M!==null){if(i.virtualScroll)(F=a.value)===null||F===void 0||F.scrollTo({key:M});else if(i.internalScrollable){const{value:ie}=l;if(ie===null)return;const ae=(Z=ie.contentRef)===null||Z===void 0?void 0:Z.querySelector(`[data-key="${Yd(M)}"]`);if(!ae)return;ie.scrollTo({el:ae})}}}),It(Qr,{loadingKeysRef:ke,highlightKeySetRef:ue,displayedCheckedKeysRef:C,displayedIndeterminateKeysRef:w,mergedSelectedKeysRef:W,mergedExpandedKeysRef:re,mergedThemeRef:o,mergedCheckStrategyRef:k,nodePropsRef:pe(i,"nodeProps"),disabledRef:pe(i,"disabled"),checkableRef:pe(i,"checkable"),selectableRef:pe(i,"selectable"),expandOnClickRef:pe(i,"expandOnClick"),onLoadRef:pe(i,"onLoad"),draggableRef:pe(i,"draggable"),blockLineRef:pe(i,"blockLine"),indentRef:pe(i,"indent"),cascadeRef:pe(i,"cascade"),checkOnClickRef:pe(i,"checkOnClick"),checkboxPlacementRef:i.checkboxPlacement,droppingMouseNodeRef:Dt,droppingNodeParentRef:tt,draggingNodeRef:Ee,droppingPositionRef:ot,droppingOffsetLevelRef:Ye,fNodesRef:oe,pendingNodeKeyRef:$,disabledFieldRef:pe(i,"disabledField"),internalScrollableRef:pe(i,"internalScrollable"),internalCheckboxFocusableRef:pe(i,"internalCheckboxFocusable"),internalTreeSelect:i.internalTreeSelect,renderLabelRef:pe(i,"renderLabel"),renderPrefixRef:pe(i,"renderPrefix"),renderSuffixRef:pe(i,"renderSuffix"),renderSwitcherIconRef:pe(i,"renderSwitcherIcon"),labelFieldRef:pe(i,"labelField"),multipleRef:pe(i,"multiple"),handleSwitcherClick:Mn,handleDragEnd:pr,handleDragEnter:sn,handleDragLeave:Ct,handleDragStart:_t,handleDrop:so,handleDragOver:Dn,handleSelect:hi,handleCheck:Fi});function di(M){var F;(F=a.value)===null||F===void 0||F.scrollTo(M)}const Hi={handleKeydown:te,scrollTo:di,getCheckedData:()=>{if(!i.checkable)return{keys:[],options:[]};const{checkedKeys:M}=R.value;return{keys:M,options:ve(M)}},getIndeterminateData:()=>{if(!i.checkable)return{keys:[],options:[]};const{indeterminateKeys:M}=R.value;return{keys:M,options:ve(M)}}},gr=fe(()=>{const{common:{cubicBezierEaseInOut:M},self:{fontSize:F,nodeBorderRadius:Z,nodeColorHover:ie,nodeColorPressed:ae,nodeColorActive:st,arrowColor:Ze,loadingColor:ni,nodeTextColor:Gt,nodeTextColorDisabled:$t,dropMarkColor:Ue}}=o.value;return{"--n-arrow-color":Ze,"--n-loading-color":ni,"--n-bezier":M,"--n-font-size":F,"--n-node-border-radius":Z,"--n-node-color-active":st,"--n-node-color-hover":ie,"--n-node-color-pressed":ae,"--n-node-text-color":Gt,"--n-node-text-color-disabled":$t,"--n-drop-mark-color":Ue}}),Tt=t?Ni("tree",void 0,gr,i):void 0;return Object.assign(Object.assign({},Hi),{mergedClsPrefix:e,mergedTheme:o,rtlEnabled:r,fNodes:I,aip:N,selfElRef:s,virtualListInstRef:a,scrollbarInstRef:l,handleFocusout:$i,handleDragLeaveTree:On,handleScroll:lo,getScrollContainer:c,getScrollContent:h,handleAfterEnter:ye,handleResize:Us,cssVars:t?void 0:gr,themeClass:Tt==null?void 0:Tt.themeClass,onRender:Tt==null?void 0:Tt.onRender})},render(){var i;const{fNodes:e,internalRenderEmpty:t}=this;if(!e.length&&t)return t();const{mergedClsPrefix:n,blockNode:r,blockLine:o,draggable:s,disabled:l,internalFocusable:a,checkable:c,handleKeydown:h,rtlEnabled:d,handleFocusout:u}=this,f=a&&!l,g=f?"0":void 0,x=[`${n}-tree`,d&&`${n}-tree--rtl`,c&&`${n}-tree--checkable`,(o||r)&&`${n}-tree--block-node`,o&&`${n}-tree--block-line`],b=A=>"__motion"in A?m(u1,{height:A.height,nodes:A.nodes,clsPrefix:n,mode:A.mode,onAfterEnter:this.handleAfterEnter}):m(Ru,{key:A.key,tmNode:A,clsPrefix:n});if(this.virtualScroll){const{mergedTheme:A,internalScrollablePadding:O}=this,R=Bd(O||"0");return m(uc,{ref:"scrollbarInstRef",onDragleave:s?this.handleDragLeaveTree:void 0,container:this.getScrollContainer,content:this.getScrollContent,class:x,theme:A.peers.Scrollbar,themeOverrides:A.peerOverrides.Scrollbar,tabindex:g,onKeydown:f?h:void 0,onFocusout:f?u:void 0},{default:()=>{var k;return(k=this.onRender)===null||k===void 0||k.call(this),m(ym,{ref:"virtualListInstRef",items:this.fNodes,itemSize:fo,ignoreItemResize:this.aip,paddingTop:R.top,paddingBottom:R.bottom,class:this.themeClass,style:[this.cssVars,{paddingLeft:R.left,paddingRight:R.right}],onScroll:this.handleScroll,onResize:this.handleResize,showScrollbar:!1,itemResizable:!0},{default:({item:C})=>b(C)})}})}const{internalScrollable:S}=this;return x.push(this.themeClass),(i=this.onRender)===null||i===void 0||i.call(this),S?m(uc,{class:x,tabindex:g,onKeydown:f?h:void 0,onFocusout:f?u:void 0,style:this.cssVars,contentStyle:{padding:this.internalScrollablePadding}},{default:()=>m("div",{onDragleave:s?this.handleDragLeaveTree:void 0,ref:"selfElRef"},this.fNodes.map(b))}):m("div",{class:x,tabindex:g,ref:"selfElRef",style:this.cssVars,onKeydown:f?h:void 0,onFocusout:f?u:void 0,onDragleave:s?this.handleDragLeaveTree:void 0},e.length?e.map(b):qo(this.$slots.empty,()=>[m(wm,{class:`${n}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})]))}}),sr=li("n-upload"),Mu="__UPLOAD_DRAGGER__",Ou=xe({name:"UploadDragger",[Mu]:!0,setup(i,{slots:e}){const t=rt(sr,null);return t||Sn("upload-dragger","`n-upload-dragger` must be placed inside `n-upload`."),()=>{const{mergedClsPrefixRef:{value:n},mergedDisabledRef:{value:r},maxReachedRef:{value:o}}=t;return m("div",{class:[`${n}-upload-dragger`,(r||o)&&`${n}-upload-dragger--disabled`]},e)}}});var Du=globalThis&&globalThis.__awaiter||function(i,e,t,n){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function l(h){try{c(n.next(h))}catch(d){s(d)}}function a(h){try{c(n.throw(h))}catch(d){s(d)}}function c(h){h.done?o(h.value):r(h.value).then(l,a)}c((n=n.apply(i,e||[])).next())})};const Tu=i=>i.includes("image/"),zc=(i="")=>{const e=i.split("/"),n=e[e.length-1].split(/#|\?/)[0];return(/\.[^./\\]*$/.exec(n)||[""])[0]},Fc=/(webp|svg|png|gif|jpg|jpeg|jfif|bmp|dpg|ico)$/i,Pu=i=>{if(i.type)return Tu(i.type);const e=zc(i.name||"");if(Fc.test(e))return!0;const t=i.thumbnailUrl||i.url||"",n=zc(t);return!!(/^data:image\//.test(t)||Fc.test(n))};function y1(i){return Du(this,void 0,void 0,function*(){return yield new Promise(e=>{if(!i.type||!Tu(i.type)){e("");return}e(window.URL.createObjectURL(i))})})}const w1=ys&&window.FileReader&&window.File;function x1(i){return i.isDirectory}function k1(i){return i.isFile}function C1(i,e){return Du(this,void 0,void 0,function*(){const t=[];let n,r=0;function o(){r++}function s(){r--,r||n(t)}function l(a){a.forEach(c=>{if(c){if(o(),e&&x1(c)){const h=c.createReader();o(),h.readEntries(d=>{l(d),s()},()=>{s()})}else k1(c)&&(o(),c.file(h=>{t.push({file:h,entry:c,source:"dnd"}),s()},()=>{s()}));s()}})}return yield new Promise(a=>{n=a,l(i)}),t})}function $r(i){const{id:e,name:t,percentage:n,status:r,url:o,file:s,thumbnailUrl:l,type:a,fullPath:c,batchId:h}=i;return{id:e,name:t,percentage:n??null,status:r,url:o??null,file:s??null,thumbnailUrl:l??null,type:a??null,fullPath:c??null,batchId:h??null}}function S1(i,e,t){return i=i.toLowerCase(),e=e.toLocaleLowerCase(),t=t.toLocaleLowerCase(),t.split(",").map(r=>r.trim()).filter(Boolean).some(r=>{if(r.startsWith(".")){if(i.endsWith(r))return!0}else if(r.includes("/")){const[o,s]=e.split("/"),[l,a]=r.split("/");if((l==="*"||o&&l&&l===o)&&(a==="*"||s&&a&&a===s))return!0}else return!0;return!1})}const A1=(i,e)=>{if(!i)return;const t=document.createElement("a");t.href=i,e!==void 0&&(t.download=e),document.body.appendChild(t),t.click(),document.body.removeChild(t)},Lu=xe({name:"UploadTrigger",props:{abstract:Boolean},setup(i,{slots:e}){const t=rt(sr,null);t||Sn("upload-trigger","`n-upload-trigger` must be placed inside `n-upload`.");const{mergedClsPrefixRef:n,mergedDisabledRef:r,maxReachedRef:o,listTypeRef:s,dragOverRef:l,openOpenFileDialog:a,draggerInsideRef:c,handleFileAddition:h,mergedDirectoryDndRef:d,triggerStyleRef:u}=t,f=fe(()=>s.value==="image-card");function g(){r.value||o.value||a()}function x(O){O.preventDefault(),l.value=!0}function b(O){O.preventDefault(),l.value=!0}function S(O){O.preventDefault(),l.value=!1}function A(O){var R;if(O.preventDefault(),!c.value||r.value||o.value){l.value=!1;return}const k=(R=O.dataTransfer)===null||R===void 0?void 0:R.items;k!=null&&k.length?C1(Array.from(k).map(C=>C.webkitGetAsEntry()),d.value).then(C=>{h(C)}).finally(()=>{l.value=!1}):l.value=!1}return()=>{var O;const{value:R}=n;return i.abstract?(O=e.default)===null||O===void 0?void 0:O.call(e,{handleClick:g,handleDrop:A,handleDragOver:x,handleDragEnter:b,handleDragLeave:S}):m("div",{class:[`${R}-upload-trigger`,(r.value||o.value)&&`${R}-upload-trigger--disabled`,f.value&&`${R}-upload-trigger--image-card`],style:u.value,onClick:g,onDrop:A,onDragover:x,onDragenter:b,onDragleave:S},f.value?m(Ou,null,{default:()=>qo(e.default,()=>[m(_e,{clsPrefix:R},{default:()=>m(uu,null)})])}):e)}}}),R1=xe({name:"UploadProgress",props:{show:Boolean,percentage:{type:Number,required:!0},status:{type:String,required:!0}},setup(){return{mergedTheme:rt(sr).mergedThemeRef}},render(){return m(Ss,null,{default:()=>this.show?m(Xv,{type:"line",showIndicator:!1,percentage:this.percentage,status:this.status,height:2,theme:this.mergedTheme.peers.Progress,themeOverrides:this.mergedTheme.peerOverrides.Progress}):null})}}),M1=m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 28 28"},m("g",{fill:"none"},m("path",{d:"M21.75 3A3.25 3.25 0 0 1 25 6.25v15.5A3.25 3.25 0 0 1 21.75 25H6.25A3.25 3.25 0 0 1 3 21.75V6.25A3.25 3.25 0 0 1 6.25 3h15.5zm.583 20.4l-7.807-7.68a.75.75 0 0 0-.968-.07l-.084.07l-7.808 7.68c.183.065.38.1.584.1h15.5c.204 0 .4-.035.583-.1l-7.807-7.68l7.807 7.68zM21.75 4.5H6.25A1.75 1.75 0 0 0 4.5 6.25v15.5c0 .208.036.408.103.593l7.82-7.692a2.25 2.25 0 0 1 3.026-.117l.129.117l7.82 7.692c.066-.185.102-.385.102-.593V6.25a1.75 1.75 0 0 0-1.75-1.75zm-3.25 3a2.5 2.5 0 1 1 0 5a2.5 2.5 0 0 1 0-5zm0 1.5a1 1 0 1 0 0 2a1 1 0 0 0 0-2z",fill:"currentColor"}))),O1=m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 28 28"},m("g",{fill:"none"},m("path",{d:"M6.4 2A2.4 2.4 0 0 0 4 4.4v19.2A2.4 2.4 0 0 0 6.4 26h15.2a2.4 2.4 0 0 0 2.4-2.4V11.578c0-.729-.29-1.428-.805-1.944l-6.931-6.931A2.4 2.4 0 0 0 14.567 2H6.4zm-.9 2.4a.9.9 0 0 1 .9-.9H14V10a2 2 0 0 0 2 2h6.5v11.6a.9.9 0 0 1-.9.9H6.4a.9.9 0 0 1-.9-.9V4.4zm16.44 6.1H16a.5.5 0 0 1-.5-.5V4.06l6.44 6.44z",fill:"currentColor"})));var D1=globalThis&&globalThis.__awaiter||function(i,e,t,n){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function l(h){try{c(n.next(h))}catch(d){s(d)}}function a(h){try{c(n.throw(h))}catch(d){s(d)}}function c(h){h.done?o(h.value):r(h.value).then(l,a)}c((n=n.apply(i,e||[])).next())})};const po={paddingMedium:"0 3px",heightMedium:"24px",iconSizeMedium:"18px"},T1=xe({name:"UploadFile",props:{clsPrefix:{type:String,required:!0},file:{type:Object,required:!0},listType:{type:String,required:!0}},setup(i){const e=rt(sr),t=K(null),n=K(""),r=fe(()=>{const{file:k}=i;return k.status==="finished"?"success":k.status==="error"?"error":"info"}),o=fe(()=>{const{file:k}=i;if(k.status==="error")return"error"}),s=fe(()=>{const{file:k}=i;return k.status==="uploading"}),l=fe(()=>{if(!e.showCancelButtonRef.value)return!1;const{file:k}=i;return["uploading","pending","error"].includes(k.status)}),a=fe(()=>{if(!e.showRemoveButtonRef.value)return!1;const{file:k}=i;return["finished"].includes(k.status)}),c=fe(()=>{if(!e.showDownloadButtonRef.value)return!1;const{file:k}=i;return["finished"].includes(k.status)}),h=fe(()=>{if(!e.showRetryButtonRef.value)return!1;const{file:k}=i;return["error"].includes(k.status)}),d=yt(()=>n.value||i.file.thumbnailUrl||i.file.url),u=fe(()=>{if(!e.showPreviewButtonRef.value)return!1;const{file:{status:k},listType:C}=i;return["finished"].includes(k)&&d.value&&C==="image-card"});function f(){e.submit(i.file.id)}function g(k){k.preventDefault();const{file:C}=i;["finished","pending","error"].includes(C.status)?b(C):["uploading"].includes(C.status)?A(C):Id("upload","The button clicked type is unknown.")}function x(k){k.preventDefault(),S(i.file)}function b(k){const{xhrMap:C,doChange:w,onRemoveRef:{value:D},mergedFileListRef:{value:v}}=e;Promise.resolve(D?D({file:Object.assign({},k),fileList:v}):!0).then(W=>{if(W===!1)return;const q=Object.assign({},k,{status:"removed"});C.delete(k.id),w(q,void 0,{remove:!0})})}function S(k){const{onDownloadRef:{value:C}}=e;Promise.resolve(C?C(Object.assign({},k)):!0).then(w=>{w!==!1&&A1(k.url,k.name)})}function A(k){const{xhrMap:C}=e,w=C.get(k.id);w==null||w.abort(),b(Object.assign({},k))}function O(){const{onPreviewRef:{value:k}}=e;if(k)k(i.file);else if(i.listType==="image-card"){const{value:C}=t;if(!C)return;C.click()}}const R=()=>D1(this,void 0,void 0,function*(){const{listType:k}=i;k!=="image"&&k!=="image-card"||e.shouldUseThumbnailUrlRef.value(i.file)&&(n.value=yield e.getFileThumbnailUrlResolver(i.file))});return Oi(()=>{R()}),{mergedTheme:e.mergedThemeRef,progressStatus:r,buttonType:o,showProgress:s,disabled:e.mergedDisabledRef,showCancelButton:l,showRemoveButton:a,showDownloadButton:c,showRetryButton:h,showPreviewButton:u,mergedThumbnailUrl:d,shouldUseThumbnailUrl:e.shouldUseThumbnailUrlRef,renderIcon:e.renderIconRef,imageRef:t,handleRemoveOrCancelClick:g,handleDownloadClick:x,handleRetryClick:f,handlePreviewClick:O}},render(){const{clsPrefix:i,mergedTheme:e,listType:t,file:n,renderIcon:r}=this;let o;const s=t==="image";s||t==="image-card"?o=!this.shouldUseThumbnailUrl(n)||!this.mergedThumbnailUrl?m("span",{class:`${i}-upload-file-info__thumbnail`},r?r(n):Pu(n)?m(_e,{clsPrefix:i},{default:()=>M1}):m(_e,{clsPrefix:i},{default:()=>O1})):m("a",{rel:"noopener noreferer",target:"_blank",href:n.url||void 0,class:`${i}-upload-file-info__thumbnail`,onClick:this.handlePreviewClick},t==="image-card"?m(Lv,{src:this.mergedThumbnailUrl||void 0,previewSrc:n.url||void 0,alt:n.name,ref:"imageRef"}):m("img",{src:this.mergedThumbnailUrl||void 0,alt:n.name})):o=m("span",{class:`${i}-upload-file-info__thumbnail`},r?r(n):m(_e,{clsPrefix:i},{default:()=>m(_0,null)}));const a=m(R1,{show:this.showProgress,percentage:n.percentage||0,status:this.progressStatus}),c=t==="text"||t==="image";return m("div",{class:[`${i}-upload-file`,`${i}-upload-file--${this.progressStatus}-status`,n.url&&n.status!=="error"&&t!=="image-card"&&`${i}-upload-file--with-url`,`${i}-upload-file--${t}-type`]},m("div",{class:`${i}-upload-file-info`},o,m("div",{class:`${i}-upload-file-info__name`},c&&(n.url&&n.status!=="error"?m("a",{rel:"noopener noreferer",target:"_blank",href:n.url||void 0,onClick:this.handlePreviewClick},n.name):m("span",{onClick:this.handlePreviewClick},n.name)),s&&a),m("div",{class:[`${i}-upload-file-info__action`,`${i}-upload-file-info__action--${t}-type`]},this.showPreviewButton?m(wi,{key:"preview",quaternary:!0,type:this.buttonType,onClick:this.handlePreviewClick,theme:e.peers.Button,themeOverrides:e.peerOverrides.Button,builtinThemeOverrides:po},{icon:()=>m(_e,{clsPrefix:i},{default:()=>m(xm,null)})}):null,(this.showRemoveButton||this.showCancelButton)&&!this.disabled&&m(wi,{key:"cancelOrTrash",theme:e.peers.Button,themeOverrides:e.peerOverrides.Button,quaternary:!0,builtinThemeOverrides:po,type:this.buttonType,onClick:this.handleRemoveOrCancelClick},{icon:()=>m(ka,null,{default:()=>this.showRemoveButton?m(_e,{clsPrefix:i,key:"trash"},{default:()=>m(G0,null)}):m(_e,{clsPrefix:i,key:"cancel"},{default:()=>m(J0,null)})})}),this.showRetryButton&&!this.disabled&&m(wi,{key:"retry",quaternary:!0,type:this.buttonType,onClick:this.handleRetryClick,theme:e.peers.Button,themeOverrides:e.peerOverrides.Button,builtinThemeOverrides:po},{icon:()=>m(_e,{clsPrefix:i},{default:()=>m(Z0,null)})}),this.showDownloadButton?m(wi,{key:"download",quaternary:!0,type:this.buttonType,onClick:this.handleDownloadClick,theme:e.peers.Button,themeOverrides:e.peerOverrides.Button,builtinThemeOverrides:po},{icon:()=>m(_e,{clsPrefix:i},{default:()=>m(X0,null)})}):null)),!s&&a)}}),P1=xe({name:"UploadFileList",setup(i,{slots:e}){const t=rt(sr,null);t||Sn("upload-file-list","`n-upload-file-list` must be placed inside `n-upload`.");const{abstractRef:n,mergedClsPrefixRef:r,listTypeRef:o,mergedFileListRef:s,fileListStyleRef:l,cssVarsRef:a,themeClassRef:c,maxReachedRef:h,showTriggerRef:d,imageGroupPropsRef:u}=t,f=fe(()=>o.value==="image-card"),g=()=>s.value.map(b=>m(T1,{clsPrefix:r.value,key:b.id,file:b,listType:o.value})),x=()=>f.value?m(Tv,Object.assign({},u.value),{default:g}):m(Ss,{group:!0},{default:g});return()=>{const{value:b}=r,{value:S}=n;return m("div",{class:[`${b}-upload-file-list`,f.value&&`${b}-upload-file-list--grid`,S?c==null?void 0:c.value:void 0],style:[S&&a?a.value:"",l.value]},x(),d.value&&!h.value&&f.value&&m(Lu,null,e))}}}),L1=ee([T("upload","width: 100%;",[U("dragger-inside",[T("upload-trigger",`
 display: block;
 `)]),U("drag-over",[T("upload-dragger",`
 border: var(--n-dragger-border-hover);
 `)])]),T("upload-dragger",`
 cursor: pointer;
 box-sizing: border-box;
 width: 100%;
 text-align: center;
 border-radius: var(--n-border-radius);
 padding: 24px;
 opacity: 1;
 transition:
 opacity .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 background-color: var(--n-dragger-color);
 border: var(--n-dragger-border);
 `,[ee("&:hover",`
 border: var(--n-dragger-border-hover);
 `),U("disabled",`
 cursor: not-allowed;
 `)]),T("upload-trigger",`
 display: inline-block;
 box-sizing: border-box;
 opacity: 1;
 transition: opacity .3s var(--n-bezier);
 `,[ee("+",[T("upload-file-list","margin-top: 8px;")]),U("disabled",`
 opacity: var(--n-item-disabled-opacity);
 cursor: not-allowed;
 `),U("image-card",`
 width: 96px;
 height: 96px;
 `,[T("base-icon",`
 font-size: 24px;
 `),T("upload-dragger",`
 padding: 0;
 height: 100%;
 width: 100%;
 display: flex;
 align-items: center;
 justify-content: center;
 `)])]),T("upload-file-list",`
 line-height: var(--n-line-height);
 opacity: 1;
 transition: opacity .3s var(--n-bezier);
 `,[ee("a, img","outline: none;"),U("disabled",`
 opacity: var(--n-item-disabled-opacity);
 cursor: not-allowed;
 `,[T("upload-file","cursor: not-allowed;")]),U("grid",`
 display: grid;
 grid-template-columns: repeat(auto-fill, 96px);
 grid-gap: 8px;
 margin-top: 0;
 `),T("upload-file",`
 display: block;
 box-sizing: border-box;
 cursor: default;
 padding: 0px 12px 0 6px;
 transition: background-color .3s var(--n-bezier);
 border-radius: var(--n-border-radius);
 `,[Fr(),T("progress",[Fr({foldPadding:!0})]),ee("&:hover",`
 background-color: var(--n-item-color-hover);
 `,[T("upload-file-info",[ge("action",`
 opacity: 1;
 `)])]),U("image-type",`
 border-radius: var(--n-border-radius);
 text-decoration: underline;
 text-decoration-color: #0000;
 `,[T("upload-file-info",`
 padding-top: 0px;
 padding-bottom: 0px;
 width: 100%;
 height: 100%;
 display: flex;
 justify-content: space-between;
 align-items: center;
 padding: 6px 0;
 `,[T("progress",`
 padding: 2px 0;
 margin-bottom: 0;
 `),ge("name",`
 padding: 0 8px;
 `),ge("thumbnail",`
 width: 32px;
 height: 32px;
 font-size: 28px;
 display: flex;
 justify-content: center;
 align-items: center;
 `,[ee("img",`
 width: 100%;
 `)])])]),U("text-type",[T("progress",`
 box-sizing: border-box;
 padding-bottom: 6px;
 margin-bottom: 6px;
 `)]),U("image-card-type",`
 position: relative;
 width: 96px;
 height: 96px;
 border: var(--n-item-border-image-card);
 border-radius: var(--n-border-radius);
 padding: 0;
 display: flex;
 align-items: center;
 justify-content: center;
 transition: border-color .3s var(--n-bezier), background-color .3s var(--n-bezier);
 border-radius: var(--n-border-radius);
 overflow: hidden;
 `,[T("progress",`
 position: absolute;
 left: 8px;
 bottom: 8px;
 right: 8px;
 width: unset;
 `),T("upload-file-info",`
 padding: 0;
 width: 100%;
 height: 100%;
 `,[ge("thumbnail",`
 width: 100%;
 height: 100%;
 display: flex;
 flex-direction: column;
 align-items: center;
 justify-content: center;
 font-size: 36px;
 `,[ee("img",`
 width: 100%;
 `)])]),ee("&::before",`
 position: absolute;
 z-index: 1;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 border-radius: inherit;
 opacity: 0;
 transition: opacity .2s var(--n-bezier);
 content: "";
 `),ee("&:hover",[ee("&::before","opacity: 1;"),T("upload-file-info",[ge("thumbnail","opacity: .12;")])])]),U("error-status",[ee("&:hover",`
 background-color: var(--n-item-color-hover-error);
 `),T("upload-file-info",[ge("name","color: var(--n-item-text-color-error);"),ge("thumbnail","color: var(--n-item-text-color-error);")]),U("image-card-type",`
 border: var(--n-item-border-image-card-error);
 `)]),U("with-url",`
 cursor: pointer;
 `,[T("upload-file-info",[ge("name",`
 color: var(--n-item-text-color-success);
 text-decoration-color: var(--n-item-text-color-success);
 `,[ee("a",`
 text-decoration: underline;
 `)])])]),T("upload-file-info",`
 position: relative;
 padding-top: 6px;
 padding-bottom: 6px;
 display: flex;
 flex-wrap: nowrap;
 `,[ge("thumbnail",`
 font-size: 18px;
 opacity: 1;
 transition: opacity .2s var(--n-bezier);
 color: var(--n-item-icon-color);
 `,[T("base-icon",`
 margin-right: 2px;
 vertical-align: middle;
 transition: color .3s var(--n-bezier);
 `)]),ge("action",`
 padding-top: inherit;
 padding-bottom: inherit;
 position: absolute;
 right: 0;
 top: 0;
 bottom: 0;
 width: 80px;
 display: flex;
 align-items: center;
 transition: opacity .2s var(--n-bezier);
 justify-content: flex-end;
 opacity: 0;
 `,[T("button",[ee("&:not(:last-child)",{marginRight:"4px"}),T("base-icon",[ee("svg",[Tr()])])]),U("image-type",`
 position: relative;
 max-width: 80px;
 width: auto;
 `),U("image-card-type",`
 z-index: 2;
 position: absolute;
 width: 100%;
 height: 100%;
 left: 0;
 right: 0;
 bottom: 0;
 top: 0;
 display: flex;
 justify-content: center;
 align-items: center;
 `)]),ge("name",`
 color: var(--n-item-text-color);
 flex: 1;
 display: flex;
 justify-content: center;
 text-overflow: ellipsis;
 overflow: hidden;
 flex-direction: column;
 text-decoration-color: #0000;
 font-size: var(--n-font-size);
 transition:
 color .3s var(--n-bezier),
 text-decoration-color .3s var(--n-bezier); 
 `,[ee("a",`
 color: inherit;
 text-decoration: underline;
 `)])])])]),T("upload-file-input",`
 display: block;
 width: 0;
 height: 0;
 opacity: 0;
 `)]);var $c=globalThis&&globalThis.__awaiter||function(i,e,t,n){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function l(h){try{c(n.next(h))}catch(d){s(d)}}function a(h){try{c(n.throw(h))}catch(d){s(d)}}function c(h){h.done?o(h.value):r(h.value).then(l,a)}c((n=n.apply(i,e||[])).next())})};function B1(i,e,t){const{doChange:n,xhrMap:r}=i;let o=0;function s(a){var c;let h=Object.assign({},e,{status:"error",percentage:o});r.delete(e.id),h=$r(((c=i.onError)===null||c===void 0?void 0:c.call(i,{file:h,event:a}))||h),n(h,a)}function l(a){var c;if(i.isErrorState){if(i.isErrorState(t)){s(a);return}}else if(t.status<200||t.status>=300){s(a);return}let h=Object.assign({},e,{status:"finished",percentage:o});r.delete(e.id),h=$r(((c=i.onFinish)===null||c===void 0?void 0:c.call(i,{file:h,event:a}))||h),n(h,a)}return{handleXHRLoad:l,handleXHRError:s,handleXHRAbort(a){const c=Object.assign({},e,{status:"removed",file:null,percentage:o});r.delete(e.id),n(c,a)},handleXHRProgress(a){const c=Object.assign({},e,{status:"uploading"});if(a.lengthComputable){const h=Math.ceil(a.loaded/a.total*100);c.percentage=h,o=h}n(c,a)}}}function E1(i){const{inst:e,file:t,data:n,headers:r,withCredentials:o,action:s,customRequest:l}=i,{doChange:a}=i.inst;let c=0;l({file:t,data:n,headers:r,withCredentials:o,action:s,onProgress(h){const d=Object.assign({},t,{status:"uploading"}),u=h.percent;d.percentage=u,c=u,a(d)},onFinish(){var h;let d=Object.assign({},t,{status:"finished",percentage:c});d=$r(((h=e.onFinish)===null||h===void 0?void 0:h.call(e,{file:d}))||d),a(d)},onError(){var h;let d=Object.assign({},t,{status:"error",percentage:c});d=$r(((h=e.onError)===null||h===void 0?void 0:h.call(e,{file:d}))||d),a(d)}})}function I1(i,e,t){const n=B1(i,e,t);t.onabort=n.handleXHRAbort,t.onerror=n.handleXHRError,t.onload=n.handleXHRLoad,t.upload&&(t.upload.onprogress=n.handleXHRProgress)}function Bu(i,e){return typeof i=="function"?i({file:e}):i||{}}function N1(i,e,t){const n=Bu(e,t);n&&Object.keys(n).forEach(r=>{i.setRequestHeader(r,n[r])})}function z1(i,e,t){const n=Bu(e,t);n&&Object.keys(n).forEach(r=>{i.append(r,n[r])})}function F1(i,e,t,{method:n,action:r,withCredentials:o,responseType:s,headers:l,data:a}){const c=new XMLHttpRequest;c.responseType=s,i.xhrMap.set(t.id,c),c.withCredentials=o;const h=new FormData;if(z1(h,a,t),h.append(e,t.file),I1(i,t,c),r!==void 0){c.open(n.toUpperCase(),r),N1(c,l,t),c.send(h);const d=Object.assign({},t,{status:"uploading"});i.doChange(d)}}const $1=Object.assign(Object.assign({},ct.props),{name:{type:String,default:"file"},accept:String,action:String,customRequest:Function,directory:Boolean,directoryDnd:{type:Boolean,default:void 0},method:{type:String,default:"POST"},multiple:Boolean,showFileList:{type:Boolean,default:!0},data:[Object,Function],headers:[Object,Function],withCredentials:Boolean,responseType:{type:String,default:""},disabled:{type:Boolean,default:void 0},onChange:Function,onRemove:Function,onFinish:Function,onError:Function,onBeforeUpload:Function,isErrorState:Function,onDownload:Function,defaultUpload:{type:Boolean,default:!0},fileList:Array,"onUpdate:fileList":[Function,Array],onUpdateFileList:[Function,Array],fileListStyle:[String,Object],defaultFileList:{type:Array,default:()=>[]},showCancelButton:{type:Boolean,default:!0},showRemoveButton:{type:Boolean,default:!0},showDownloadButton:Boolean,showRetryButton:{type:Boolean,default:!0},showPreviewButton:{type:Boolean,default:!0},listType:{type:String,default:"text"},onPreview:Function,shouldUseThumbnailUrl:{type:Function,default:i=>w1?Pu(i):!1},createThumbnailUrl:Function,abstract:Boolean,max:Number,showTrigger:{type:Boolean,default:!0},imageGroupProps:Object,inputProps:Object,triggerStyle:[String,Object],renderIcon:Object}),H1=xe({name:"Upload",props:$1,setup(i){i.abstract&&i.listType==="image-card"&&Sn("upload","when the list-type is image-card, abstract is not supported.");const{mergedClsPrefixRef:e,inlineThemeDisabled:t}=ei(i),n=ct("Upload","-upload",L1,km,i,e),r=Cm(i),o=fe(()=>{const{max:v}=i;return v!==void 0?f.value.length>=v:!1}),s=K(i.defaultFileList),l=pe(i,"fileList"),a=K(null),c={value:!1},h=K(!1),d=new Map,u=Nn(l,s),f=fe(()=>u.value.map($r));function g(){var v;(v=a.value)===null||v===void 0||v.click()}function x(v){const W=v.target;A(W.files?Array.from(W.files).map(q=>({file:q,entry:null,source:"input"})):null,v),W.value=""}function b(v){const{"onUpdate:fileList":W,onUpdateFileList:q}=i;W&&je(W,v),q&&je(q,v),s.value=v}const S=fe(()=>i.multiple||i.directory);function A(v,W){if(!v||v.length===0)return;const{onBeforeUpload:q}=i;v=S.value?v:[v[0]];const{max:ne,accept:Y}=i;v=v.filter(({file:oe,source:$})=>$==="dnd"&&(Y!=null&&Y.trim())?S1(oe.name,oe.type,Y):!0),ne&&(v=v.slice(0,ne-f.value.length));const re=zr();Promise.all(v.map(({file:oe,entry:$})=>$c(this,void 0,void 0,function*(){var te;const E={id:zr(),batchId:re,name:oe.name,status:"pending",percentage:0,file:oe,url:null,type:oe.type,thumbnailUrl:null,fullPath:(te=$==null?void 0:$.fullPath)!==null&&te!==void 0?te:`/${oe.webkitRelativePath||oe.name}`};return!q||(yield q({file:E,fileList:f.value}))!==!1?E:null}))).then(oe=>$c(this,void 0,void 0,function*(){let $=Promise.resolve();return oe.forEach(te=>{$=$.then(Ti).then(()=>{te&&R(te,W,{append:!0})})}),yield $})).then(()=>{i.defaultUpload&&O()})}function O(v){const{method:W,action:q,withCredentials:ne,headers:Y,data:re,name:oe}=i,$=v!==void 0?f.value.filter(E=>E.id===v):f.value,te=v!==void 0;$.forEach(E=>{const{status:V}=E;(V==="pending"||V==="error"&&te)&&(i.customRequest?E1({inst:{doChange:R,xhrMap:d,onFinish:i.onFinish,onError:i.onError},file:E,action:q,withCredentials:ne,headers:Y,data:re,customRequest:i.customRequest}):F1({doChange:R,xhrMap:d,onFinish:i.onFinish,onError:i.onError,isErrorState:i.isErrorState},oe,E,{method:W,action:q,withCredentials:ne,responseType:i.responseType,headers:Y,data:re}))})}const R=(v,W,q={append:!1,remove:!1})=>{const{append:ne,remove:Y}=q,re=Array.from(f.value),oe=re.findIndex($=>$.id===v.id);if(ne||Y||~oe){ne?re.push(v):Y?re.splice(oe,1):re.splice(oe,1,v);const{onChange:$}=i;$&&$({file:v,fileList:re,event:W}),b(re)}};function k(v){var W;if(v.thumbnailUrl)return v.thumbnailUrl;const{createThumbnailUrl:q}=i;return q?(W=q(v.file,v))!==null&&W!==void 0?W:v.url||"":v.url?v.url:v.file?y1(v.file):""}const C=fe(()=>{const{common:{cubicBezierEaseInOut:v},self:{draggerColor:W,draggerBorder:q,draggerBorderHover:ne,itemColorHover:Y,itemColorHoverError:re,itemTextColorError:oe,itemTextColorSuccess:$,itemTextColor:te,itemIconColor:E,itemDisabledOpacity:V,lineHeight:H,borderRadius:G,fontSize:ue,itemBorderImageCardError:ke,itemBorderImageCard:$e}}=n.value;return{"--n-bezier":v,"--n-border-radius":G,"--n-dragger-border":q,"--n-dragger-border-hover":ne,"--n-dragger-color":W,"--n-font-size":ue,"--n-item-color-hover":Y,"--n-item-color-hover-error":re,"--n-item-disabled-opacity":V,"--n-item-icon-color":E,"--n-item-text-color":te,"--n-item-text-color-error":oe,"--n-item-text-color-success":$,"--n-line-height":H,"--n-item-border-image-card-error":ke,"--n-item-border-image-card":$e}}),w=t?Ni("upload",void 0,C,i):void 0;It(sr,{mergedClsPrefixRef:e,mergedThemeRef:n,showCancelButtonRef:pe(i,"showCancelButton"),showDownloadButtonRef:pe(i,"showDownloadButton"),showRemoveButtonRef:pe(i,"showRemoveButton"),showRetryButtonRef:pe(i,"showRetryButton"),onRemoveRef:pe(i,"onRemove"),onDownloadRef:pe(i,"onDownload"),mergedFileListRef:f,triggerStyleRef:pe(i,"triggerStyle"),shouldUseThumbnailUrlRef:pe(i,"shouldUseThumbnailUrl"),renderIconRef:pe(i,"renderIcon"),xhrMap:d,submit:O,doChange:R,showPreviewButtonRef:pe(i,"showPreviewButton"),onPreviewRef:pe(i,"onPreview"),getFileThumbnailUrlResolver:k,listTypeRef:pe(i,"listType"),dragOverRef:h,openOpenFileDialog:g,draggerInsideRef:c,handleFileAddition:A,mergedDisabledRef:r.mergedDisabledRef,maxReachedRef:o,fileListStyleRef:pe(i,"fileListStyle"),abstractRef:pe(i,"abstract"),acceptRef:pe(i,"accept"),cssVarsRef:t?void 0:C,themeClassRef:w==null?void 0:w.themeClass,onRender:w==null?void 0:w.onRender,showTriggerRef:pe(i,"showTrigger"),imageGroupPropsRef:pe(i,"imageGroupProps"),mergedDirectoryDndRef:fe(()=>{var v;return(v=i.directoryDnd)!==null&&v!==void 0?v:i.directory})});const D={clear:()=>{s.value=[]},submit:O,openOpenFileDialog:g};return Object.assign({mergedClsPrefix:e,draggerInsideRef:c,inputElRef:a,mergedTheme:n,dragOver:h,mergedMultiple:S,cssVars:t?void 0:C,themeClass:w==null?void 0:w.themeClass,onRender:w==null?void 0:w.onRender,handleFileInputChange:x},D)},render(){var i,e;const{draggerInsideRef:t,mergedClsPrefix:n,$slots:r,directory:o,onRender:s}=this;if(r.default&&!this.abstract){const a=r.default()[0];!((i=a==null?void 0:a.type)===null||i===void 0)&&i[Mu]&&(t.value=!0)}const l=m("input",Object.assign({},this.inputProps,{ref:"inputElRef",type:"file",class:`${n}-upload-file-input`,accept:this.accept,multiple:this.mergedMultiple,onChange:this.handleFileInputChange,webkitdirectory:o||void 0,directory:o||void 0}));return this.abstract?m(Ji,null,(e=r.default)===null||e===void 0?void 0:e.call(r),m(qd,{to:"body"},l)):(s==null||s(),m("div",{class:[`${n}-upload`,t.value&&`${n}-upload--dragger-inside`,this.dragOver&&`${n}-upload--drag-over`,this.themeClass],style:this.cssVars},l,this.showTrigger&&this.listType!=="image-card"&&m(Lu,null,r),this.showFileList&&m(P1,null,r)))}});function Ds(i){var e=i.statementIndent,t=i.jsonld,n=i.json||t,r=i.typescript,o=i.wordCharacters||/[\w$\xa1-\uffff]/,s=function(){function p(Ht){return{type:Ht,style:"keyword"}}var y=p("keyword a"),B=p("keyword b"),_=p("keyword c"),se=p("keyword d"),De=p("operator"),Ne={type:"atom",style:"atom"};return{if:p("if"),while:y,with:y,else:B,do:B,try:B,finally:B,return:se,break:se,continue:se,new:p("new"),delete:_,void:_,throw:_,debugger:p("debugger"),var:p("var"),const:p("var"),let:p("var"),function:p("function"),catch:p("catch"),for:p("for"),switch:p("switch"),case:p("case"),default:p("default"),in:De,typeof:De,instanceof:De,true:Ne,false:Ne,null:Ne,undefined:Ne,NaN:Ne,Infinity:Ne,this:p("this"),class:p("class"),super:p("atom"),yield:_,export:p("export"),import:p("import"),extends:_,await:_}}(),l=/[+\-*&%=<>!?|~^@]/,a=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function c(p){for(var y=!1,B,_=!1;(B=p.next())!=null;){if(!y){if(B=="/"&&!_)return;B=="["?_=!0:_&&B=="]"&&(_=!1)}y=!y&&B=="\\"}}var h,d;function u(p,y,B){return h=p,d=B,y}function f(p,y){var B=p.next();if(B=='"'||B=="'")return y.tokenize=g(B),y.tokenize(p,y);if(B=="."&&p.match(/^\d[\d_]*(?:[eE][+\-]?[\d_]+)?/))return u("number","number");if(B=="."&&p.match(".."))return u("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(B))return u(B);if(B=="="&&p.eat(">"))return u("=>","operator");if(B=="0"&&p.match(/^(?:x[\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/))return u("number","number");if(/\d/.test(B))return p.match(/^[\d_]*(?:n|(?:\.[\d_]*)?(?:[eE][+\-]?[\d_]+)?)?/),u("number","number");if(B=="/")return p.eat("*")?(y.tokenize=x,x(p,y)):p.eat("/")?(p.skipToEnd(),u("comment","comment")):mr(p,y,1)?(c(p),p.match(/^\b(([gimyus])(?![gimyus]*\2))+\b/),u("regexp","string.special")):(p.eat("="),u("operator","operator",p.current()));if(B=="`")return y.tokenize=b,b(p,y);if(B=="#"&&p.peek()=="!")return p.skipToEnd(),u("meta","meta");if(B=="#"&&p.eatWhile(o))return u("variable","property");if(B=="<"&&p.match("!--")||B=="-"&&p.match("->")&&!/\S/.test(p.string.slice(0,p.start)))return p.skipToEnd(),u("comment","comment");if(l.test(B))return(B!=">"||!y.lexical||y.lexical.type!=">")&&(p.eat("=")?(B=="!"||B=="=")&&p.eat("="):/[<>*+\-|&?]/.test(B)&&(p.eat(B),B==">"&&p.eat(B))),B=="?"&&p.eat(".")?u("."):u("operator","operator",p.current());if(o.test(B)){p.eatWhile(o);var _=p.current();if(y.lastType!="."){if(s.propertyIsEnumerable(_)){var se=s[_];return u(se.type,se.style,_)}if(_=="async"&&p.match(/^(\s|\/\*([^*]|\*(?!\/))*?\*\/)*[\[\(\w]/,!1))return u("async","keyword",_)}return u("variable","variable",_)}}function g(p){return function(y,B){var _=!1,se;if(t&&y.peek()=="@"&&y.match(a))return B.tokenize=f,u("jsonld-keyword","meta");for(;(se=y.next())!=null&&!(se==p&&!_);)_=!_&&se=="\\";return _||(B.tokenize=f),u("string","string")}}function x(p,y){for(var B=!1,_;_=p.next();){if(_=="/"&&B){y.tokenize=f;break}B=_=="*"}return u("comment","comment")}function b(p,y){for(var B=!1,_;(_=p.next())!=null;){if(!B&&(_=="`"||_=="$"&&p.eat("{"))){y.tokenize=f;break}B=!B&&_=="\\"}return u("quasi","string.special",p.current())}var S="([{}])";function A(p,y){y.fatArrowAt&&(y.fatArrowAt=null);var B=p.string.indexOf("=>",p.start);if(!(B<0)){if(r){var _=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(p.string.slice(p.start,B));_&&(B=_.index)}for(var se=0,De=!1,Ne=B-1;Ne>=0;--Ne){var Ht=p.string.charAt(Ne),Xt=S.indexOf(Ht);if(Xt>=0&&Xt<3){if(!se){++Ne;break}if(--se==0){Ht=="("&&(De=!0);break}}else if(Xt>=3&&Xt<6)++se;else if(o.test(Ht))De=!0;else if(/["'\/`]/.test(Ht))for(;;--Ne){if(Ne==0)return;var vr=p.string.charAt(Ne-1);if(vr==Ht&&p.string.charAt(Ne-2)!="\\"){Ne--;break}}else if(De&&!se){++Ne;break}}De&&!se&&(y.fatArrowAt=Ne)}}var O={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,import:!0,"jsonld-keyword":!0};function R(p,y,B,_,se,De){this.indented=p,this.column=y,this.type=B,this.prev=se,this.info=De,_!=null&&(this.align=_)}function k(p,y){for(var B=p.localVars;B;B=B.next)if(B.name==y)return!0;for(var _=p.context;_;_=_.prev)for(var B=_.vars;B;B=B.next)if(B.name==y)return!0}function C(p,y,B,_,se){var De=p.cc;for(w.state=p,w.stream=se,w.marked=null,w.cc=De,w.style=y,p.lexical.hasOwnProperty("align")||(p.lexical.align=!0);;){var Ne=De.length?De.pop():n?Me:ke;if(Ne(B,_)){for(;De.length&&De[De.length-1].lex;)De.pop()();return w.marked?w.marked:B=="variable"&&k(p,_)?"variableName.local":y}}}var w={state:null,column:null,marked:null,cc:null};function D(){for(var p=arguments.length-1;p>=0;p--)w.cc.push(arguments[p])}function v(){return D.apply(null,arguments),!0}function W(p,y){for(var B=y;B;B=B.next)if(B.name==p)return!0;return!1}function q(p){var y=w.state;if(w.marked="def",y.context){if(y.lexical.info=="var"&&y.context&&y.context.block){var B=ne(p,y.context);if(B!=null){y.context=B;return}}else if(!W(p,y.localVars)){y.localVars=new oe(p,y.localVars);return}}i.globalVars&&!W(p,y.globalVars)&&(y.globalVars=new oe(p,y.globalVars))}function ne(p,y){if(y)if(y.block){var B=ne(p,y.prev);return B?B==y.prev?y:new re(B,y.vars,!0):null}else return W(p,y.vars)?y:new re(y.prev,new oe(p,y.vars),!1);else return null}function Y(p){return p=="public"||p=="private"||p=="protected"||p=="abstract"||p=="readonly"}function re(p,y,B){this.prev=p,this.vars=y,this.block=B}function oe(p,y){this.name=p,this.next=y}var $=new oe("this",new oe("arguments",null));function te(){w.state.context=new re(w.state.context,w.state.localVars,!1),w.state.localVars=$}function E(){w.state.context=new re(w.state.context,w.state.localVars,!0),w.state.localVars=null}te.lex=E.lex=!0;function V(){w.state.localVars=w.state.context.vars,w.state.context=w.state.context.prev}V.lex=!0;function H(p,y){var B=function(){var _=w.state,se=_.indented;if(_.lexical.type=="stat")se=_.lexical.indented;else for(var De=_.lexical;De&&De.type==")"&&De.align;De=De.prev)se=De.indented;_.lexical=new R(se,w.stream.column(),p,null,_.lexical,y)};return B.lex=!0,B}function G(){var p=w.state;p.lexical.prev&&(p.lexical.type==")"&&(p.indented=p.lexical.indented),p.lexical=p.lexical.prev)}G.lex=!0;function ue(p){function y(B){return B==p?v():p==";"||B=="}"||B==")"||B=="]"?D():v(y)}return y}function ke(p,y){return p=="var"?v(H("vardef",y),sn,ue(";"),G):p=="keyword a"?v(H("form"),Ot,ke,G):p=="keyword b"?v(H("form"),ke,G):p=="keyword d"?w.stream.match(/^\s*$/,!1)?v():v(H("stat"),ot,ue(";"),G):p=="debugger"?v(ue(";")):p=="{"?v(H("}"),E,vt,G,V):p==";"?v():p=="if"?(w.state.lexical.info=="else"&&w.state.cc[w.state.cc.length-1]==G&&w.state.cc.pop()(),v(H("form"),Ot,ke,G,so)):p=="function"?v(di):p=="for"?v(H("form"),E,lo,ke,V,G):p=="class"||r&&y=="interface"?(w.marked="keyword",v(H("form",p=="class"?p:y),F,G)):p=="variable"?r&&y=="declare"?(w.marked="keyword",v(ke)):r&&(y=="module"||y=="enum"||y=="type")&&w.stream.match(/^\s*\w/,!1)?(w.marked="keyword",y=="enum"?v(ao):y=="type"?v(gr,ue("operator"),Pe,ue(";")):v(H("form"),Ct,ue("{"),H("}"),vt,G,G)):r&&y=="namespace"?(w.marked="keyword",v(H("form"),Me,ke,G)):r&&y=="abstract"?(w.marked="keyword",v(ke)):v(H("stat"),I):p=="switch"?v(H("form"),Ot,ue("{"),H("}","switch"),E,vt,G,G,V):p=="case"?v(Me,ue(":")):p=="default"?v(ue(":")):p=="catch"?v(H("form"),te,$e,ke,G,V):p=="export"?v(H("stat"),st,G):p=="import"?v(H("stat"),ni,G):p=="async"?v(ke):y=="@"?v(Me,ke):D(H("stat"),Me,ue(";"),G)}function $e(p){if(p=="(")return v(Tt,ue(")"))}function Me(p,y){return Dt(p,y,!1)}function Ee(p,y){return Dt(p,y,!0)}function Ot(p){return p!="("?D():v(H(")"),ot,ue(")"),G)}function Dt(p,y,B){if(w.state.fatArrowAt==w.stream.start){var _=B?Se:Q;if(p=="(")return v(te,H(")"),Ae(Tt,")"),G,ue("=>"),_,V);if(p=="variable")return D(te,Ct,ue("=>"),_,V)}var se=B?tt:Ye;return O.hasOwnProperty(p)?v(se):p=="function"?v(di,se):p=="class"||r&&y=="interface"?(w.marked="keyword",v(H("form"),M,G)):p=="keyword c"||p=="async"?v(B?Ee:Me):p=="("?v(H(")"),ot,ue(")"),G,se):p=="operator"||p=="spread"?v(B?Ee:Me):p=="["?v(H("]"),ui,G,se):p=="{"?He(ye,"}",null,se):p=="quasi"?D(J,se):p=="new"?v(N(B)):v()}function ot(p){return p.match(/[;\}\)\],]/)?D():D(Me)}function Ye(p,y){return p==","?v(ot):tt(p,y,!1)}function tt(p,y,B){var _=B==!1?Ye:tt,se=B==!1?Me:Ee;if(p=="=>")return v(te,B?Se:Q,V);if(p=="operator")return/\+\+|--/.test(y)||r&&y=="!"?v(_):r&&y=="<"&&w.stream.match(/^([^<>]|<[^<>]*>)*>\s*\(/,!1)?v(H(">"),Ae(Pe,">"),G,_):y=="?"?v(Me,ue(":"),se):v(se);if(p=="quasi")return D(J,_);if(p!=";"){if(p=="(")return He(Ee,")","call",_);if(p==".")return v(le,_);if(p=="[")return v(H("]"),ot,ue("]"),G,_);if(r&&y=="as")return w.marked="keyword",v(Pe,_);if(p=="regexp")return w.state.lastType=w.marked="operator",w.stream.backUp(w.stream.pos-w.stream.start-1),v(se)}}function J(p,y){return p!="quasi"?D():y.slice(y.length-2)!="${"?v(J):v(ot,me)}function me(p){if(p=="}")return w.marked="string.special",w.state.tokenize=b,v(J)}function Q(p){return A(w.stream,w.state),D(p=="{"?ke:Me)}function Se(p){return A(w.stream,w.state),D(p=="{"?ke:Ee)}function N(p){return function(y){return y=="."?v(p?L:j):y=="variable"&&r?v(Mn,p?tt:Ye):D(p?Ee:Me)}}function j(p,y){if(y=="target")return w.marked="keyword",v(Ye)}function L(p,y){if(y=="target")return w.marked="keyword",v(tt)}function I(p){return p==":"?v(G,ke):D(Ye,ue(";"),G)}function le(p){if(p=="variable")return w.marked="property",v()}function ye(p,y){if(p=="async")return w.marked="property",v(ye);if(p=="variable"||w.style=="keyword"){if(w.marked="property",y=="get"||y=="set")return v(ve);var B;return r&&w.state.fatArrowAt==w.stream.start&&(B=w.stream.match(/^\s*:\s*/,!1))&&(w.state.fatArrowAt=w.stream.pos+B[0].length),v(Oe)}else{if(p=="number"||p=="string")return w.marked=t?"property":w.style+" property",v(Oe);if(p=="jsonld-keyword")return v(Oe);if(r&&Y(y))return w.marked="keyword",v(ye);if(p=="[")return v(Me,qt,ue("]"),Oe);if(p=="spread")return v(Ee,Oe);if(y=="*")return w.marked="keyword",v(ye);if(p==":")return D(Oe)}}function ve(p){return p!="variable"?D(Oe):(w.marked="property",v(di))}function Oe(p){if(p==":")return v(Ee);if(p=="(")return D(di)}function Ae(p,y,B){function _(se,De){if(B?B.indexOf(se)>-1:se==","){var Ne=w.state.lexical;return Ne.info=="call"&&(Ne.pos=(Ne.pos||0)+1),v(function(Ht,Xt){return Ht==y||Xt==y?D():D(p)},_)}return se==y||De==y?v():B&&B.indexOf(";")>-1?D(p):v(ue(y))}return function(se,De){return se==y||De==y?v():D(p,_)}}function He(p,y,B){for(var _=3;_<arguments.length;_++)w.cc.push(arguments[_]);return v(H(y,B),Ae(p,y),G)}function vt(p){return p=="}"?v():D(ke,vt)}function qt(p,y){if(r){if(p==":")return v(Pe);if(y=="?")return v(qt)}}function hr(p,y){if(r&&(p==":"||y=="in"))return v(Pe)}function Rn(p){if(r&&p==":")return w.stream.match(/^\s*\w+\s+is\b/,!1)?v(Me,dr,Pe):v(Pe)}function dr(p,y){if(y=="is")return w.marked="keyword",v()}function Pe(p,y){if(y=="keyof"||y=="typeof"||y=="infer"||y=="readonly")return w.marked="keyword",v(y=="typeof"?Ee:Pe);if(p=="variable"||y=="void")return w.marked="type",v(Ft);if(y=="|"||y=="&")return v(Pe);if(p=="string"||p=="number"||p=="atom")return v(Ft);if(p=="[")return v(H("]"),Ae(Pe,"]",","),G,Ft);if(p=="{")return v(H("}"),ii,G,Ft);if(p=="(")return v(Ae(Fi,")"),ur,Ft);if(p=="<")return v(Ae(Pe,">"),Pe);if(p=="quasi")return D(zt,Ft)}function ur(p){if(p=="=>")return v(Pe)}function ii(p){return p.match(/[\}\)\]]/)?v():p==","||p==";"?v(ii):D(Mi,ii)}function Mi(p,y){if(p=="variable"||w.style=="keyword")return w.marked="property",v(Mi);if(y=="?"||p=="number"||p=="string")return v(Mi);if(p==":")return v(Pe);if(p=="[")return v(ue("variable"),hr,ue("]"),Mi);if(p=="(")return D(Hi,Mi);if(!p.match(/[;\}\)\],]/))return v()}function zt(p,y){return p!="quasi"?D():y.slice(y.length-2)!="${"?v(zt):v(Pe,ci)}function ci(p){if(p=="}")return w.marked="string-2",w.state.tokenize=b,v(zt)}function Fi(p,y){return p=="variable"&&w.stream.match(/^\s*[?:]/,!1)||y=="?"?v(Fi):p==":"?v(Pe):p=="spread"?v(Fi):D(Pe)}function Ft(p,y){if(y=="<")return v(H(">"),Ae(Pe,">"),G,Ft);if(y=="|"||p=="."||y=="&")return v(Pe);if(p=="[")return v(Pe,ue("]"),Ft);if(y=="extends"||y=="implements")return w.marked="keyword",v(Pe);if(y=="?")return v(Pe,ue(":"),Pe)}function Mn(p,y){if(y=="<")return v(H(">"),Ae(Pe,">"),G,Ft)}function hi(){return D(Pe,fr)}function fr(p,y){if(y=="=")return v(Pe)}function sn(p,y){return y=="enum"?(w.marked="keyword",v(ao)):D(Ct,qt,_t,Dn)}function Ct(p,y){if(r&&Y(y))return w.marked="keyword",v(Ct);if(p=="variable")return q(y),v();if(p=="spread")return v(Ct);if(p=="[")return He(pr,"]");if(p=="{")return He(On,"}")}function On(p,y){return p=="variable"&&!w.stream.match(/^\s*:/,!1)?(q(y),v(_t)):(p=="variable"&&(w.marked="property"),p=="spread"?v(Ct):p=="}"?D():p=="["?v(Me,ue("]"),ue(":"),On):v(ue(":"),Ct,_t))}function pr(){return D(Ct,_t)}function _t(p,y){if(y=="=")return v(Ee)}function Dn(p){if(p==",")return v(sn)}function so(p,y){if(p=="keyword b"&&y=="else")return v(H("form","else"),ke,G)}function lo(p,y){if(y=="await")return v(lo);if(p=="(")return v(H(")"),Us,G)}function Us(p){return p=="var"?v(sn,$i):p=="variable"?v($i):D($i)}function $i(p,y){return p==")"?v():p==";"?v($i):y=="in"||y=="of"?(w.marked="keyword",v(Me,$i)):D(Me,$i)}function di(p,y){if(y=="*")return w.marked="keyword",v(di);if(p=="variable")return q(y),v(di);if(p=="(")return v(te,H(")"),Ae(Tt,")"),G,Rn,ke,V);if(r&&y=="<")return v(H(">"),Ae(hi,">"),G,di)}function Hi(p,y){if(y=="*")return w.marked="keyword",v(Hi);if(p=="variable")return q(y),v(Hi);if(p=="(")return v(te,H(")"),Ae(Tt,")"),G,Rn,V);if(r&&y=="<")return v(H(">"),Ae(hi,">"),G,Hi)}function gr(p,y){if(p=="keyword"||p=="variable")return w.marked="type",v(gr);if(y=="<")return v(H(">"),Ae(hi,">"),G)}function Tt(p,y){return y=="@"&&v(Me,Tt),p=="spread"?v(Tt):r&&Y(y)?(w.marked="keyword",v(Tt)):r&&p=="this"?v(qt,_t):D(Ct,qt,_t)}function M(p,y){return p=="variable"?F(p,y):Z(p,y)}function F(p,y){if(p=="variable")return q(y),v(Z)}function Z(p,y){if(y=="<")return v(H(">"),Ae(hi,">"),G,Z);if(y=="extends"||y=="implements"||r&&p==",")return y=="implements"&&(w.marked="keyword"),v(r?Pe:Me,Z);if(p=="{")return v(H("}"),ie,G)}function ie(p,y){if(p=="async"||p=="variable"&&(y=="static"||y=="get"||y=="set"||r&&Y(y))&&w.stream.match(/^\s+#?[\w$\xa1-\uffff]/,!1))return w.marked="keyword",v(ie);if(p=="variable"||w.style=="keyword")return w.marked="property",v(ae,ie);if(p=="number"||p=="string")return v(ae,ie);if(p=="[")return v(Me,qt,ue("]"),ae,ie);if(y=="*")return w.marked="keyword",v(ie);if(r&&p=="(")return D(Hi,ie);if(p==";"||p==",")return v(ie);if(p=="}")return v();if(y=="@")return v(Me,ie)}function ae(p,y){if(y=="!"||y=="?")return v(ae);if(p==":")return v(Pe,_t);if(y=="=")return v(Ee);var B=w.state.lexical.prev,_=B&&B.info=="interface";return D(_?Hi:di)}function st(p,y){return y=="*"?(w.marked="keyword",v(Qe,ue(";"))):y=="default"?(w.marked="keyword",v(Me,ue(";"))):p=="{"?v(Ae(Ze,"}"),Qe,ue(";")):D(ke)}function Ze(p,y){if(y=="as")return w.marked="keyword",v(ue("variable"));if(p=="variable")return D(Ee,Ze)}function ni(p){return p=="string"?v():p=="("?D(Me):p=="."?D(Ye):D(Gt,$t,Qe)}function Gt(p,y){return p=="{"?He(Gt,"}"):(p=="variable"&&q(y),y=="*"&&(w.marked="keyword"),v(Ue))}function $t(p){if(p==",")return v(Gt,$t)}function Ue(p,y){if(y=="as")return w.marked="keyword",v(Gt)}function Qe(p,y){if(y=="from")return w.marked="keyword",v(Me)}function ui(p){return p=="]"?v():D(Ae(Ee,"]"))}function ao(){return D(H("form"),Ct,ue("{"),H("}"),Ae(Ie,"}"),G,G)}function Ie(){return D(Ct,_t)}function bt(p,y){return p.lastType=="operator"||p.lastType==","||l.test(y.charAt(0))||/[,.]/.test(y.charAt(0))}function mr(p,y,B){return y.tokenize==f&&/^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\[{}\(,;:]|=>)$/.test(y.lastType)||y.lastType=="quasi"&&/\{\s*$/.test(p.string.slice(0,p.pos-(B||0)))}return{name:i.name,startState:function(p){var y={tokenize:f,lastType:"sof",cc:[],lexical:new R(-p,0,"block",!1),localVars:i.localVars,context:i.localVars&&new re(null,null,!1),indented:0};return i.globalVars&&typeof i.globalVars=="object"&&(y.globalVars=i.globalVars),y},token:function(p,y){if(p.sol()&&(y.lexical.hasOwnProperty("align")||(y.lexical.align=!1),y.indented=p.indentation(),A(p,y)),y.tokenize!=x&&p.eatSpace())return null;var B=y.tokenize(p,y);return h=="comment"?B:(y.lastType=h=="operator"&&(d=="++"||d=="--")?"incdec":h,C(y,B,h,d,p))},indent:function(p,y,B){if(p.tokenize==x||p.tokenize==b)return null;if(p.tokenize!=f)return 0;var _=y&&y.charAt(0),se=p.lexical,De;if(!/^\s*else\b/.test(y))for(var Ne=p.cc.length-1;Ne>=0;--Ne){var Ht=p.cc[Ne];if(Ht==G)se=se.prev;else if(Ht!=so&&Ht!=V)break}for(;(se.type=="stat"||se.type=="form")&&(_=="}"||(De=p.cc[p.cc.length-1])&&(De==Ye||De==tt)&&!/^[,\.=+\-*:?[\(]/.test(y));)se=se.prev;e&&se.type==")"&&se.prev.type=="stat"&&(se=se.prev);var Xt=se.type,vr=_==Xt;return Xt=="vardef"?se.indented+(p.lastType=="operator"||p.lastType==","?se.info.length+1:0):Xt=="form"&&_=="{"?se.indented:Xt=="form"?se.indented+B.unit:Xt=="stat"?se.indented+(bt(p,y)?e||B.unit:0):se.info=="switch"&&!vr&&i.doubleIndentSwitch!=!1?se.indented+(/^(?:case|default)\b/.test(y)?B.unit:2*B.unit):se.align?se.column+(vr?0:1):se.indented+(vr?0:B.unit)},languageData:{indentOnInput:/^\s*(?:case .*?:|default:|\{|\})$/,commentTokens:n?void 0:{line:"//",block:{open:"/*",close:"*/"}},closeBrackets:{brackets:["(","[","{","'",'"',"`"]},wordChars:"$"}}}Ds({name:"javascript"});const j1=Ds({name:"json",json:!0});Ds({name:"json",jsonld:!0});Ds({name:"typescript",typescript:!0});function W1(i){return new RegExp("^(?:"+i.join("|")+")","i")}function Ts(i){return new RegExp("^(?:"+i.join("|")+")$","i")}var V1=Ts(["_G","_VERSION","assert","collectgarbage","dofile","error","getfenv","getmetatable","ipairs","load","loadfile","loadstring","module","next","pairs","pcall","print","rawequal","rawget","rawset","require","select","setfenv","setmetatable","tonumber","tostring","type","unpack","xpcall","coroutine.create","coroutine.resume","coroutine.running","coroutine.status","coroutine.wrap","coroutine.yield","debug.debug","debug.getfenv","debug.gethook","debug.getinfo","debug.getlocal","debug.getmetatable","debug.getregistry","debug.getupvalue","debug.setfenv","debug.sethook","debug.setlocal","debug.setmetatable","debug.setupvalue","debug.traceback","close","flush","lines","read","seek","setvbuf","write","io.close","io.flush","io.input","io.lines","io.open","io.output","io.popen","io.read","io.stderr","io.stdin","io.stdout","io.tmpfile","io.type","io.write","math.abs","math.acos","math.asin","math.atan","math.atan2","math.ceil","math.cos","math.cosh","math.deg","math.exp","math.floor","math.fmod","math.frexp","math.huge","math.ldexp","math.log","math.log10","math.max","math.min","math.modf","math.pi","math.pow","math.rad","math.random","math.randomseed","math.sin","math.sinh","math.sqrt","math.tan","math.tanh","os.clock","os.date","os.difftime","os.execute","os.exit","os.getenv","os.remove","os.rename","os.setlocale","os.time","os.tmpname","package.cpath","package.loaded","package.loaders","package.loadlib","package.path","package.preload","package.seeall","string.byte","string.char","string.dump","string.find","string.format","string.gmatch","string.gsub","string.len","string.lower","string.match","string.rep","string.reverse","string.sub","string.upper","table.concat","table.insert","table.maxn","table.remove","table.sort"]),U1=Ts(["and","break","elseif","false","nil","not","or","return","true","function","end","if","then","else","do","while","repeat","until","for","in","local"]),K1=Ts(["function","if","repeat","do","\\(","{"]),q1=Ts(["end","until","\\)","}"]),_1=W1(["end","until","\\)","}","else","elseif"]);function Hc(i){for(var e=0;i.eat("=");)++e;return i.eat("["),e}function Ma(i,e){var t=i.next();return t=="-"&&i.eat("-")?i.eat("[")&&i.eat("[")?(e.cur=jc(Hc(i),"comment"))(i,e):(i.skipToEnd(),"comment"):t=='"'||t=="'"?(e.cur=G1(t))(i,e):t=="["&&/[\[=]/.test(i.peek())?(e.cur=jc(Hc(i),"string"))(i,e):/\d/.test(t)?(i.eatWhile(/[\w.%]/),"number"):/[\w_]/.test(t)?(i.eatWhile(/[\w\\\-_.]/),"variable"):null}function jc(i,e){return function(t,n){for(var r=null,o;(o=t.next())!=null;)if(r==null)o=="]"&&(r=0);else if(o=="=")++r;else if(o=="]"&&r==i){n.cur=Ma;break}else r=null;return e}}function G1(i){return function(e,t){for(var n=!1,r;(r=e.next())!=null&&!(r==i&&!n);)n=!n&&r=="\\";return n||(t.cur=Ma),"string"}}const X1={name:"lua",startState:function(){return{basecol:0,indentDepth:0,cur:Ma}},token:function(i,e){if(i.eatSpace())return null;var t=e.cur(i,e),n=i.current();return t=="variable"&&(U1.test(n)?t="keyword":V1.test(n)&&(t="builtin")),t!="comment"&&t!="string"&&(K1.test(n)?++e.indentDepth:q1.test(n)&&--e.indentDepth),t},indent:function(i,e,t){var n=_1.test(e);return i.basecol+t.unit*(i.indentDepth-(n?1:0))},languageData:{indentOnInput:/^\s*(?:end|until|else|\)|\})$/,commentTokens:{line:"--",block:{open:"--[[",close:"]]--"}}}};var Y1=["true","false","on","off","yes","no"],J1=new RegExp("\\b(("+Y1.join(")|(")+"))$","i");const Z1={name:"yaml",token:function(i,e){var t=i.peek(),n=e.escaped;if(e.escaped=!1,t=="#"&&(i.pos==0||/\s/.test(i.string.charAt(i.pos-1))))return i.skipToEnd(),"comment";if(i.match(/^('([^']|\\.)*'?|"([^"]|\\.)*"?)/))return"string";if(e.literal&&i.indentation()>e.keyCol)return i.skipToEnd(),"string";if(e.literal&&(e.literal=!1),i.sol()){if(e.keyCol=0,e.pair=!1,e.pairStart=!1,i.match("---")||i.match("..."))return"def";if(i.match(/^\s*-\s+/))return"meta"}if(i.match(/^(\{|\}|\[|\])/))return t=="{"?e.inlinePairs++:t=="}"?e.inlinePairs--:t=="["?e.inlineList++:e.inlineList--,"meta";if(e.inlineList>0&&!n&&t==",")return i.next(),"meta";if(e.inlinePairs>0&&!n&&t==",")return e.keyCol=0,e.pair=!1,e.pairStart=!1,i.next(),"meta";if(e.pairStart){if(i.match(/^\s*(\||\>)\s*/))return e.literal=!0,"meta";if(i.match(/^\s*(\&|\*)[a-z0-9\._-]+\b/i))return"variable";if(e.inlinePairs==0&&i.match(/^\s*-?[0-9\.\,]+\s?$/)||e.inlinePairs>0&&i.match(/^\s*-?[0-9\.\,]+\s?(?=(,|}))/))return"number";if(i.match(J1))return"keyword"}return!e.pair&&i.match(/^\s*(?:[,\[\]{}&*!|>'"%@`][^\s'":]|[^,\[\]{}#&*!|>'"%@`])[^#]*?(?=\s*:($|\s))/)?(e.pair=!0,e.keyCol=i.indentation(),"atom"):e.pair&&i.match(/^:\s*/)?(e.pairStart=!0,"meta"):(e.pairStart=!1,e.escaped=t=="\\",i.next(),null)},startState:function(){return{pair:!1,pairStart:!1,keyCol:0,inlinePairs:0,inlineList:0,literal:!1,escaped:!1}},languageData:{commentTokens:{line:"#"}}};function Rl(){return Rl=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},Rl.apply(this,arguments)}const Q1={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},eb=Gn("path",{d:"M20 6h-8l-1.41-1.41C10.21 4.21 9.7 4 9.17 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-2 8h-2v2c0 .55-.45 1-1 1s-1-.45-1-1v-2h-2c-.55 0-1-.45-1-1s.45-1 1-1h2v-2c0-.55.45-1 1-1s1 .45 1 1v2h2c.55 0 1 .45 1 1s-.45 1-1 1z",fill:"currentColor"},null,-1),tb=[eb],ib=xe({name:"CreateNewFolderRound",render:function(i,e){return si(),bn("svg",Q1,tb)}}),nb={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},rb=Gn("path",{d:"M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8.83c0-.53-.21-1.04-.59-1.41l-4.83-4.83c-.37-.38-.88-.59-1.41-.59H6zm7 6V3.5L18.5 9H14c-.55 0-1-.45-1-1z",fill:"currentColor"},null,-1),ob=[rb],sb=xe({name:"InsertDriveFileRound",render:function(i,e){return si(),bn("svg",nb,ob)}}),lb={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},ab=Gn("path",{d:"M17.65 6.35a7.95 7.95 0 0 0-6.48-2.31c-3.67.37-6.69 3.35-7.1 7.02C3.52 15.91 7.27 20 12 20a7.98 7.98 0 0 0 7.21-4.56c.32-.67-.16-1.44-.9-1.44c-.37 0-.72.2-.88.53a5.994 5.994 0 0 1-6.8 3.31c-2.22-.49-4.01-2.3-4.48-4.52A6.002 6.002 0 0 1 12 6c1.66 0 3.14.69 4.22 1.78l-1.51 1.51c-.63.63-.19 1.71.7 1.71H19c.55 0 1-.45 1-1V6.41c0-.89-1.08-1.34-1.71-.71l-.64.65z",fill:"currentColor"},null,-1),cb=[ab],hb=xe({name:"RefreshRound",render:function(i,e){return si(),bn("svg",lb,cb)}});"stream"in Blob.prototype||Object.defineProperty(Blob.prototype,"stream",{value(){return new Response(this).body}}),"setBigUint64"in DataView.prototype||Object.defineProperty(DataView.prototype,"setBigUint64",{value(i,e,t){const n=Number(0xffffffffn&e),r=Number(e>>32n);this.setUint32(i+(t?0:4),n,t),this.setUint32(i+(t?4:0),r,t)}});var Xn=i=>new DataView(new ArrayBuffer(i)),Li=i=>new Uint8Array(i.buffer||i),zn=i=>new TextEncoder().encode(String(i)),pn=i=>Math.min(4294967295,Number(i)),Wc=i=>Math.min(65535,Number(i));function db(i,e){if(e===void 0||e instanceof Date||(e=new Date(e)),i instanceof File)return{isFile:1,t:e||new Date(i.lastModified),i:i.stream()};if(i instanceof Response)return{isFile:1,t:e||new Date(i.headers.get("Last-Modified")||Date.now()),i:i.body};if(e===void 0)e=new Date;else if(isNaN(e))throw new Error("Invalid modification date.");if(i===void 0)return{isFile:0,t:e};if(typeof i=="string")return{isFile:1,t:e,i:zn(i)};if(i instanceof Blob)return{isFile:1,t:e,i:i.stream()};if(i instanceof Uint8Array||i instanceof ReadableStream)return{isFile:1,t:e,i};if(i instanceof ArrayBuffer||ArrayBuffer.isView(i))return{isFile:1,t:e,i:Li(i)};if(Symbol.asyncIterator in i)return{isFile:1,t:e,i:Eu(i[Symbol.asyncIterator]())};throw new TypeError("Unsupported input format.")}function Eu(i,e=i){return new ReadableStream({async pull(t){let n=0;for(;t.desiredSize>n;){const r=await i.next();if(!r.value){t.close();break}{const o=ub(r.value);t.enqueue(o),n+=o.byteLength}}},cancel(t){var n;(n=e.throw)==null||n.call(e,t)}})}function ub(i){return typeof i=="string"?zn(i):i instanceof Uint8Array?i:Li(i)}function Iu(i,e,t){let[n,r]=function(o){return o?o instanceof Uint8Array?[o,1]:ArrayBuffer.isView(o)||o instanceof ArrayBuffer?[Li(o),1]:[zn(o),0]:[void 0,0]}(e);if(i instanceof File)return{o:el(n||zn(i.name)),u:BigInt(i.size),l:r};if(i instanceof Response){const o=i.headers.get("content-disposition"),s=o&&o.match(/;\s*filename\*?=["']?(.*?)["']?$/i),l=s&&s[1]||i.url&&new URL(i.url).pathname.split("/").findLast(Boolean),a=l&&decodeURIComponent(l),c=t||+i.headers.get("content-length");return{o:el(n||zn(a)),u:BigInt(c),l:r}}return n=el(n,i!==void 0||t!==void 0),typeof i=="string"?{o:n,u:BigInt(zn(i).length),l:r}:i instanceof Blob?{o:n,u:BigInt(i.size),l:r}:i instanceof ArrayBuffer||ArrayBuffer.isView(i)?{o:n,u:BigInt(i.byteLength),l:r}:{o:n,u:fb(i,t),l:r}}function fb(i,e){return e>-1?BigInt(e):i?void 0:0n}function el(i,e=1){if(!i||i.every(t=>t===47))throw new Error("The file must have a name.");if(e)for(;i[i.length-1]===47;)i=i.subarray(0,-1);else i[i.length-1]!==47&&(i=new Uint8Array([...i,47]));return i}var Nu=new Uint32Array(256);for(let i=0;i<256;++i){let e=i;for(let t=0;t<8;++t)e=e>>>1^(1&e&&3988292384);Nu[i]=e}function Vc(i,e=0){e^=-1;for(var t=0,n=i.length;t<n;t++)e=e>>>8^Nu[255&e^i[t]];return(-1^e)>>>0}function zu(i,e,t=0){const n=i.getSeconds()>>1|i.getMinutes()<<5|i.getHours()<<11,r=i.getDate()|i.getMonth()+1<<5|i.getFullYear()-1980<<9;e.setUint16(t,n,1),e.setUint16(t+2,r,1)}function pb({o:i,l:e},t){return 8*(!e||(t??function(n){try{gb.decode(n)}catch{return 0}return 1}(i)))}var gb=new TextDecoder("utf8",{fatal:1});function mb(i,e=0){const t=Xn(30);return t.setUint32(0,1347093252),t.setUint32(4,754976768|e),zu(i.t,t,10),t.setUint16(26,i.o.length,1),Li(t)}async function*vb(i){let{i:e}=i;if("then"in e&&(e=await e),e instanceof Uint8Array)yield e,i.m=Vc(e,0),i.u=BigInt(e.length);else{i.u=0n;const t=e.getReader();for(;;){const{value:n,done:r}=await t.read();if(r)break;i.m=Vc(n,i.m),i.u+=BigInt(n.length),yield n}}}function bb(i,e){const t=Xn(16+(e?8:0));return t.setUint32(0,1347094280),t.setUint32(4,i.isFile?i.m:0,1),e?(t.setBigUint64(8,i.u,1),t.setBigUint64(16,i.u,1)):(t.setUint32(8,pn(i.u),1),t.setUint32(12,pn(i.u),1)),Li(t)}function yb(i,e,t=0,n=0){const r=Xn(46);return r.setUint32(0,1347092738),r.setUint32(4,755182848),r.setUint16(8,2048|t),zu(i.t,r,12),r.setUint32(16,i.isFile?i.m:0,1),r.setUint32(20,pn(i.u),1),r.setUint32(24,pn(i.u),1),r.setUint16(28,i.o.length,1),r.setUint16(30,n,1),r.setUint16(40,i.isFile?33204:16893,1),r.setUint32(42,pn(e),1),Li(r)}function wb(i,e,t){const n=Xn(t);return n.setUint16(0,1,1),n.setUint16(2,t-4,1),16&t&&(n.setBigUint64(4,i.u,1),n.setBigUint64(12,i.u,1)),n.setBigUint64(t-8,e,1),Li(n)}function Fu(i){return i instanceof File||i instanceof Response?[[i],[i]]:[[i.input,i.name,i.size],[i.input,i.lastModified]]}var xb=i=>function(e){let t=BigInt(22),n=0n,r=0;for(const o of e){if(!o.o)throw new Error("Every file must have a non-empty name.");if(o.u===void 0)throw new Error(`Missing size for file "${new TextDecoder().decode(o.o)}".`);const s=o.u>=0xffffffffn,l=n>=0xffffffffn;n+=BigInt(46+o.o.length+(s&&8))+o.u,t+=BigInt(o.o.length+46+(12*l|28*s)),r||(r=s)}return(r||n>=0xffffffffn)&&(t+=BigInt(76)),t+n}(function*(e){for(const t of e)yield Iu(...Fu(t)[0])}(i));function kb(i,e={}){const t={"Content-Type":"application/zip","Content-Disposition":"attachment"};return(typeof e.length=="bigint"||Number.isInteger(e.length))&&e.length>0&&(t["Content-Length"]=String(e.length)),e.metadata&&(t["Content-Length"]=String(xb(e.metadata))),new Response(Cb(i,e),{headers:t})}function Cb(i,e={}){const t=function(n){var r;const o=n[Symbol.iterator in n?Symbol.iterator:Symbol.asyncIterator]();return{async next(){const s=await o.next();if(s.done)return s;const[l,a]=Fu(s.value);return{done:0,value:Object.assign(db(...a),Iu(...l))}},throw:(r=o.throw)==null?void 0:r.bind(o),[Symbol.asyncIterator](){return this}}}(i);return Eu(async function*(n,r){const o=[];let s=0n,l=0n,a=0;for await(const d of n){const u=pb(d,r.buffersAreUTF8);yield mb(d,u),yield d.o,d.isFile&&(yield*vb(d));const f=d.u>=0xffffffffn,g=12*(s>=0xffffffffn)|28*f;yield bb(d,f),o.push(yb(d,s,u,g)),o.push(d.o),g&&o.push(wb(d,s,g)),f&&(s+=8n),l++,s+=BigInt(46+d.o.length)+d.u,a||(a=f)}let c=0n;for(const d of o)yield d,c+=BigInt(d.length);if(a||s>=0xffffffffn){const d=Xn(76);d.setUint32(0,1347094022),d.setBigUint64(4,BigInt(44),1),d.setUint32(12,755182848),d.setBigUint64(24,l,1),d.setBigUint64(32,l,1),d.setBigUint64(40,c,1),d.setBigUint64(48,s,1),d.setUint32(56,1347094023),d.setBigUint64(64,s+c,1),d.setUint32(72,1,1),yield Li(d)}const h=Xn(22);h.setUint32(0,1347093766),h.setUint16(8,Wc(l),1),h.setUint16(10,Wc(l),1),h.setUint32(12,pn(c),1),h.setUint32(16,pn(s),1),yield Li(h)}(t,e),t)}const Sb=xe({__name:"FileManager",props:{fs:{},height:{},onOpenFile:{},onNewFile:{},onNewFolder:{},onUpload:{},onErrorPaste:{},onRename:{},onDeleteFile:{},onDeleteFolder:{},onErrorDownload:{}},setup(i,{expose:e}){const t=i,{fs:n,onOpenFile:r,onNewFile:o,onNewFolder:s,onErrorPaste:l,onUpload:a,onRename:c,onDeleteFile:h,onDeleteFolder:d,onErrorDownload:u}=Ms(t),{height:f}=As(t);function g(){return{key:"/",label:"/",isLeaf:!1}}const x=K([g()]),b=K([]),S=K([]),A=K(!1),O=K(""),R=K(!1),k=K(0),C=K(0),w=K(""),D=K(""),v=fe(()=>{const L=w.value||D.value?[{label:"Paste",key:"paste"}]:[];return[{label:"Download",key:"download"},{label:"Upload",key:"upload"},{label:"Cut",key:"cut"},{label:"Copy",key:"copy"},...L,{label:"Rename",key:"rename"},{label:"Delete",key:"delete"}]});function W(){A.value=!1}function q(){if(S.value.length){const L=S.value[0];return ue(L)}return"/"}function ne(){x.value=[g()]}async function Y(L){try{return await n.lstat(L),!0}catch{return!1}}async function re(L){if(await Y(L)){const I=Error();throw I.name="PathExistsError",I}}function oe(){const L=q();o(L,async I=>(await re(I),n.writeFile(I,"").finally(ne)))}function $(){const L=q();s(L,async I=>(await re(I),n.mkdir(I).finally(ne)))}function te({option:L}){return{async onClick(){L.isFile&&r(L.key)},onContextmenu(I){A.value=!0,O.value=L.key,R.value=L.isFile,k.value=I.clientX,C.value=I.clientY,I.preventDefault()}}}async function E(L){return(await n.readdir(L)).filter(I=>I!=="."&&I!=="..")}function V(L,I,le){async function ye(ve){const{mode:Oe}=await n.lstat(ve);if(await n.isDir(Oe)){ve.endsWith("/")||(ve+="/"),L&&await L(ve);const Ae=await E(ve);for(const He of Ae)await ye(ve+He);return le&&le(ve)}return I(ve)}return ye}const H=V(void 0,n.unlink,n.rmdir);function G(L){return L.endsWith("/")&&(L=L.slice(0,L.length-1)),L.slice(L.lastIndexOf("/")+1)}function ue(L){return L.slice(0,L.lastIndexOf("/")+1)}function ke(L,I){if(L.endsWith("/")&&I.startsWith(L))return Promise.reject(new Error);const le=G(L);function ye(ve){return I+le+"/"+ve.slice(L.length)}return V(ve=>n.mkdir(ye(ve)),async ve=>n.writeFile(ye(ve),await n.readFile(ve)),void 0)(L)}function $e(L,I){const le=URL.createObjectURL(L),ye=document.createElement("a");ye.href=le,ye.download=I,document.body.appendChild(ye),ye.click(),document.body.removeChild(ye),URL.revokeObjectURL(le)}async function Me(L){const I=await n.readFile(L),le=L.slice(L.lastIndexOf("/")+1),ye=new Blob([I],{type:"application/octet-stream"});$e(ye,le)}async function Ee(L){const I=L==="/"?"root":G(L),le=[];function ye(He){return I+"/"+He.slice(L.length)}async function ve(He){le.push({name:ye(He),input:await n.readFile(He)})}function Oe(He){le.push({name:ye(He)})}await V(void 0,ve,Oe)(L);const Ae=await kb(le).blob();$e(Ae,I)}function Ot(L){const I=ue(L);a(I,async le=>{try{for(const{name:ye,content:ve}of le)await n.writeFile(I+ye,ve)}finally{ne()}})}function Dt(L){w.value=L,D.value=""}function ot(L){w.value="",D.value=L}async function Ye(L){const I=ue(L);try{if(w.value){const le=G(w.value),ye=I+le;await n.rename(w.value,ye),w.value=""}else await ke(D.value,I),D.value=""}catch{l&&l(I)}finally{ne()}}function tt(L,I){return(I?d:h)(L,le=>H(le).finally(ne))}function J(L){const I=O.value;switch(L){case"download":(R.value?Me:Ee)(I).catch(()=>u&&u(I));break;case"upload":Ot(I);break;case"cut":Dt(I);break;case"copy":ot(I);break;case"paste":Ye(I);break;case"rename":c(I,async le=>{const ye=I==="/"?le:I.slice(0,I.lastIndexOf("/",I.length-2))+"/"+le;return n.rename(I,ye).finally(ne)});break;case"delete":tt(I,!R.value);break}A.value=!1}async function me(L){const I=L.key,le=[],ye=await E(I);for(const ve of ye){const Oe=I+ve,Ae={label:ve},{mode:He}=await n.lstat(Oe);await n.isDir(He)?(Ae.key=Oe+"/",Ae.isLeaf=!1):(Ae.key=Oe,Ae.isLeaf=!0,await n.isFile(He)?Ae.isFile=!0:Ae.disabled=!0),le.push(Ae)}le.sort((ve,Oe)=>ve.key.localeCompare(Oe.key)),L.children=le}async function Q(L){const{key:I,ctrlKey:le,metaKey:ye,altKey:ve,shiftKey:Oe}=L,Ae=/Macintosh/.test(navigator.userAgent),He=!ve&&!Oe&&(Ae&&!le&&ye||!Ae&&le&&!ye),vt=S.value[0],{mode:qt}=await n.lstat(vt);switch(I){case"Delete":tt(vt,await n.isDir(qt));break;case"c":case"C":He&&ot(vt);break;case"v":case"V":He&&Ye(vt);break;case"x":case"X":He&&Dt(vt);break}}async function Se({node:L,dragNode:I}){const le=I.key,ye=G(le),ve=ue(L.key),Oe=ve+ye;try{await n.rename(le,Oe)}catch{l&&l(ve)}finally{ne()}}function N(L){L.key==="Escape"&&W()}Yi(()=>document.addEventListener("keyup",N)),Am(()=>document.removeEventListener("keyup",N));function j(L){b.value.includes(L)||b.value.push(L)}return e({expandFolder:j}),(L,I)=>(si(),bn(Ji,null,[it(we(Rm),{style:{gap:"5px"}},{default:Vt(()=>[it(we(wi),{text:"",title:"New File",onClick:oe},{default:Vt(()=>[it(we(qs),{component:we(sb)},null,8,["component"])]),_:1}),it(we(wi),{text:"",title:"New Folder",onClick:$},{default:Vt(()=>[it(we(qs),{component:we(ib)},null,8,["component"])]),_:1}),it(we(wi),{text:"",title:"Refresh Explorer",onClick:ne},{default:Vt(()=>[it(we(qs),{component:we(hb)},null,8,["component"])]),_:1})]),_:1}),it(we(Lc),{"x-scrollable":"",style:Ud({height:we(f)})},{default:Vt(()=>[it(we(Lc),null,{default:Vt(()=>[it(we(b1),{"expanded-keys":b.value,"onUpdate:expandedKeys":I[0]||(I[0]=le=>b.value=le),"selected-keys":S.value,"onUpdate:selectedKeys":I[1]||(I[1]=le=>S.value=le),animated:!1,cancelable:!1,draggable:"","expand-on-click":"",data:x.value,"node-props":te,onLoad:me,onKeydown:Q,onDrop:Se},null,8,["expanded-keys","selected-keys","data"]),it(we(Mm),{trigger:"manual",placement:"bottom-start",show:A.value,options:v.value,x:k.value,y:C.value,onSelect:J,onClickoutside:W},null,8,["show","options","x","y"])]),_:1})]),_:1},8,["style"])],64))}});class Le{constructor(){}lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,n){let r=[];return this.decompose(0,e,r,2),n.length&&n.decompose(0,n.length,r,3),this.decompose(t,this.length,r,1),yi.from(r,this.length-(t-e)+n.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){let n=[];return this.decompose(e,t,n,0),yi.from(n,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),r=new Pr(this),o=new Pr(e);for(let s=t,l=t;;){if(r.next(s),o.next(s),s=0,r.lineBreak!=o.lineBreak||r.done!=o.done||r.value!=o.value)return!1;if(l+=r.value.length,r.done||l>=n)return!0}}iter(e=1){return new Pr(this,e)}iterRange(e,t=this.length){return new $u(this,e,t)}iterLines(e,t){let n;if(e==null)n=this.iter();else{t==null&&(t=this.lines+1);let r=this.line(e).from;n=this.iterRange(r,Math.max(r,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new Hu(n)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?Le.empty:e.length<=32?new et(e):yi.from(et.split(e,[]))}}class et extends Le{constructor(e,t=Ab(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,n,r){for(let o=0;;o++){let s=this.text[o],l=r+s.length;if((t?n:l)>=e)return new Rb(r,l,n,s);r=l+1,n++}}decompose(e,t,n,r){let o=e<=0&&t>=this.length?this:new et(Uc(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(r&1){let s=n.pop(),l=Io(o.text,s.text.slice(),0,o.length);if(l.length<=32)n.push(new et(l,s.length+o.length));else{let a=l.length>>1;n.push(new et(l.slice(0,a)),new et(l.slice(a)))}}else n.push(o)}replace(e,t,n){if(!(n instanceof et))return super.replace(e,t,n);let r=Io(this.text,Io(n.text,Uc(this.text,0,e)),t),o=this.length+n.length-(t-e);return r.length<=32?new et(r,o):yi.from(et.split(r,[]),o)}sliceString(e,t=this.length,n=`
`){let r="";for(let o=0,s=0;o<=t&&s<this.text.length;s++){let l=this.text[s],a=o+l.length;o>e&&s&&(r+=n),e<a&&t>o&&(r+=l.slice(Math.max(0,e-o),t-o)),o=a+1}return r}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let n=[],r=-1;for(let o of e)n.push(o),r+=o.length+1,n.length==32&&(t.push(new et(n,r)),n=[],r=-1);return r>-1&&t.push(new et(n,r)),t}}class yi extends Le{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let n of e)this.lines+=n.lines}lineInner(e,t,n,r){for(let o=0;;o++){let s=this.children[o],l=r+s.length,a=n+s.lines-1;if((t?a:l)>=e)return s.lineInner(e,t,n,r);r=l+1,n=a+1}}decompose(e,t,n,r){for(let o=0,s=0;s<=t&&o<this.children.length;o++){let l=this.children[o],a=s+l.length;if(e<=a&&t>=s){let c=r&((s<=e?1:0)|(a>=t?2:0));s>=e&&a<=t&&!c?n.push(l):l.decompose(e-s,t-s,n,c)}s=a+1}}replace(e,t,n){if(n.lines<this.lines)for(let r=0,o=0;r<this.children.length;r++){let s=this.children[r],l=o+s.length;if(e>=o&&t<=l){let a=s.replace(e-o,t-o,n),c=this.lines-s.lines+a.lines;if(a.lines<c>>5-1&&a.lines>c>>5+1){let h=this.children.slice();return h[r]=a,new yi(h,this.length-(t-e)+n.length)}return super.replace(o,l,a)}o=l+1}return super.replace(e,t,n)}sliceString(e,t=this.length,n=`
`){let r="";for(let o=0,s=0;o<this.children.length&&s<=t;o++){let l=this.children[o],a=s+l.length;s>e&&o&&(r+=n),e<a&&t>s&&(r+=l.sliceString(e-s,t-s,n)),s=a+1}return r}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof yi))return 0;let n=0,[r,o,s,l]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;r+=t,o+=t){if(r==s||o==l)return n;let a=this.children[r],c=e.children[o];if(a!=c)return n+a.scanIdentical(c,t);n+=a.length+1}}static from(e,t=e.reduce((n,r)=>n+r.length+1,-1)){let n=0;for(let f of e)n+=f.lines;if(n<32){let f=[];for(let g of e)g.flatten(f);return new et(f,t)}let r=Math.max(32,n>>5),o=r<<1,s=r>>1,l=[],a=0,c=-1,h=[];function d(f){let g;if(f.lines>o&&f instanceof yi)for(let x of f.children)d(x);else f.lines>s&&(a>s||!a)?(u(),l.push(f)):f instanceof et&&a&&(g=h[h.length-1])instanceof et&&f.lines+g.lines<=32?(a+=f.lines,c+=f.length+1,h[h.length-1]=new et(g.text.concat(f.text),g.length+1+f.length)):(a+f.lines>r&&u(),a+=f.lines,c+=f.length+1,h.push(f))}function u(){a!=0&&(l.push(h.length==1?h[0]:yi.from(h,c)),c=-1,a=h.length=0)}for(let f of e)d(f);return u(),l.length==1?l[0]:new yi(l,t)}}Le.empty=new et([""],0);function Ab(i){let e=-1;for(let t of i)e+=t.length+1;return e}function Io(i,e,t=0,n=1e9){for(let r=0,o=0,s=!0;o<i.length&&r<=n;o++){let l=i[o],a=r+l.length;a>=t&&(a>n&&(l=l.slice(0,n-r)),r<t&&(l=l.slice(t-r)),s?(e[e.length-1]+=l,s=!1):e.push(l)),r=a+1}return e}function Uc(i,e,t){return Io(i,[""],e,t)}class Pr{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof et?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,r=this.nodes[n],o=this.offsets[n],s=o>>1,l=r instanceof et?r.text.length:r.children.length;if(s==(t>0?l:0)){if(n==0)return this.done=!0,this.value="",this;t>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((o&1)==(t>0?0:1)){if(this.offsets[n]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(r instanceof et){let a=r.text[s+(t<0?-1:0)];if(this.offsets[n]+=t,a.length>Math.max(0,e))return this.value=e==0?a:t>0?a.slice(e):a.slice(0,a.length-e),this;e-=a.length}else{let a=r.children[s+(t<0?-1:0)];e>a.length?(e-=a.length,this.offsets[n]+=t):(t<0&&this.offsets[n]--,this.nodes.push(a),this.offsets.push(t>0?1:(a instanceof et?a.text.length:a.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class $u{constructor(e,t,n){this.value="",this.done=!1,this.cursor=new Pr(e,t>n?-1:1),this.pos=t>n?e.length:0,this.from=Math.min(t,n),this.to=Math.max(t,n)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let n=t<0?this.pos-this.from:this.to-this.pos;e>n&&(e=n),n-=e;let{value:r}=this.cursor.next(e);return this.pos+=(r.length+e)*t,this.value=r.length<=n?r:t<0?r.slice(r.length-n):r.slice(0,n),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class Hu{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:n,value:r}=this.inner.next(e);return t?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=r,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Le.prototype[Symbol.iterator]=function(){return this.iter()},Pr.prototype[Symbol.iterator]=$u.prototype[Symbol.iterator]=Hu.prototype[Symbol.iterator]=function(){return this});class Rb{constructor(e,t,n,r){this.from=e,this.to=t,this.number=n,this.text=r}get length(){return this.to-this.from}}let Vn="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(i=>i?parseInt(i,36):1);for(let i=1;i<Vn.length;i++)Vn[i]+=Vn[i-1];function Mb(i){for(let e=1;e<Vn.length;e+=2)if(Vn[e]>i)return Vn[e-1]<=i;return!1}function Kc(i){return i>=127462&&i<=127487}const qc=8205;function At(i,e,t=!0,n=!0){return(t?ju:Ob)(i,e,n)}function ju(i,e,t){if(e==i.length)return e;e&&Wu(i.charCodeAt(e))&&Vu(i.charCodeAt(e-1))&&e--;let n=ut(i,e);for(e+=Jt(n);e<i.length;){let r=ut(i,e);if(n==qc||r==qc||t&&Mb(r))e+=Jt(r),n=r;else if(Kc(r)){let o=0,s=e-2;for(;s>=0&&Kc(ut(i,s));)o++,s-=2;if(o%2==0)break;e+=2}else break}return e}function Ob(i,e,t){for(;e>0;){let n=ju(i,e-2,t);if(n<e)return n;e--}return 0}function Wu(i){return i>=56320&&i<57344}function Vu(i){return i>=55296&&i<56320}function ut(i,e){let t=i.charCodeAt(e);if(!Vu(t)||e+1==i.length)return t;let n=i.charCodeAt(e+1);return Wu(n)?(t-55296<<10)+(n-56320)+65536:t}function Oa(i){return i<=65535?String.fromCharCode(i):(i-=65536,String.fromCharCode((i>>10)+55296,(i&1023)+56320))}function Jt(i){return i<65536?1:2}const Ml=/\r\n?|\n/;var St=function(i){return i[i.Simple=0]="Simple",i[i.TrackDel=1]="TrackDel",i[i.TrackBefore=2]="TrackBefore",i[i.TrackAfter=3]="TrackAfter",i}(St||(St={}));class Ci{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t+1];e+=n<0?this.sections[t]:n}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,n=0,r=0;t<this.sections.length;){let o=this.sections[t++],s=this.sections[t++];s<0?(e(n,r,o),r+=o):r+=s,n+=o}}iterChangedRanges(e,t=!1){Ol(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let n=this.sections[t++],r=this.sections[t++];r<0?e.push(n,r):e.push(r,n)}return new Ci(e)}composeDesc(e){return this.empty?e:e.empty?this:Uu(this,e)}mapDesc(e,t=!1){return e.empty?this:Dl(this,e,t)}mapPos(e,t=-1,n=St.Simple){let r=0,o=0;for(let s=0;s<this.sections.length;){let l=this.sections[s++],a=this.sections[s++],c=r+l;if(a<0){if(c>e)return o+(e-r);o+=l}else{if(n!=St.Simple&&c>=e&&(n==St.TrackDel&&r<e&&c>e||n==St.TrackBefore&&r<e||n==St.TrackAfter&&c>e))return null;if(c>e||c==e&&t<0&&!l)return e==r||t<0?o:o+a;o+=a}r=c}if(e>r)throw new RangeError(`Position ${e} is out of range for changeset of length ${r}`);return o}touchesRange(e,t=e){for(let n=0,r=0;n<this.sections.length&&r<=t;){let o=this.sections[n++],s=this.sections[n++],l=r+o;if(s>=0&&r<=t&&l>=e)return r<e&&l>t?"cover":!0;r=l}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let n=this.sections[t++],r=this.sections[t++];e+=(e?" ":"")+n+(r>=0?":"+r:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Ci(e)}static create(e){return new Ci(e)}}class lt extends Ci{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return Ol(this,(t,n,r,o,s)=>e=e.replace(r,r+(n-t),s),!1),e}mapDesc(e,t=!1){return Dl(this,e,t,!0)}invert(e){let t=this.sections.slice(),n=[];for(let r=0,o=0;r<t.length;r+=2){let s=t[r],l=t[r+1];if(l>=0){t[r]=l,t[r+1]=s;let a=r>>1;for(;n.length<a;)n.push(Le.empty);n.push(s?e.slice(o,o+s):Le.empty)}o+=s}return new lt(t,n)}compose(e){return this.empty?e:e.empty?this:Uu(this,e,!0)}map(e,t=!1){return e.empty?this:Dl(this,e,t,!0)}iterChanges(e,t=!1){Ol(this,e,t)}get desc(){return Ci.create(this.sections)}filter(e){let t=[],n=[],r=[],o=new Hr(this);e:for(let s=0,l=0;;){let a=s==e.length?1e9:e[s++];for(;l<a||l==a&&o.len==0;){if(o.done)break e;let h=Math.min(o.len,a-l);wt(r,h,-1);let d=o.ins==-1?-1:o.off==0?o.ins:0;wt(t,h,d),d>0&&Ki(n,t,o.text),o.forward(h),l+=h}let c=e[s++];for(;l<c;){if(o.done)break e;let h=Math.min(o.len,c-l);wt(t,h,-1),wt(r,h,o.ins==-1?-1:o.off==0?o.ins:0),o.forward(h),l+=h}}return{changes:new lt(t,n),filtered:Ci.create(r)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t],r=this.sections[t+1];r<0?e.push(n):r==0?e.push([n]):e.push([n].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,n){let r=[],o=[],s=0,l=null;function a(h=!1){if(!h&&!r.length)return;s<t&&wt(r,t-s,-1);let d=new lt(r,o);l=l?l.compose(d.map(l)):d,r=[],o=[],s=0}function c(h){if(Array.isArray(h))for(let d of h)c(d);else if(h instanceof lt){if(h.length!=t)throw new RangeError(`Mismatched change set length (got ${h.length}, expected ${t})`);a(),l=l?l.compose(h.map(l)):h}else{let{from:d,to:u=d,insert:f}=h;if(d>u||d<0||u>t)throw new RangeError(`Invalid change range ${d} to ${u} (in doc of length ${t})`);let g=f?typeof f=="string"?Le.of(f.split(n||Ml)):f:Le.empty,x=g.length;if(d==u&&x==0)return;d<s&&a(),d>s&&wt(r,d-s,-1),wt(r,u-d,x),Ki(o,r,g),s=u}}return c(e),a(!l),l}static empty(e){return new lt(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],n=[];for(let r=0;r<e.length;r++){let o=e[r];if(typeof o=="number")t.push(o,-1);else{if(!Array.isArray(o)||typeof o[0]!="number"||o.some((s,l)=>l&&typeof s!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(o.length==1)t.push(o[0],0);else{for(;n.length<r;)n.push(Le.empty);n[r]=Le.of(o.slice(1)),t.push(o[0],n[r].length)}}}return new lt(t,n)}static createSet(e,t){return new lt(e,t)}}function wt(i,e,t,n=!1){if(e==0&&t<=0)return;let r=i.length-2;r>=0&&t<=0&&t==i[r+1]?i[r]+=e:e==0&&i[r]==0?i[r+1]+=t:n?(i[r]+=e,i[r+1]+=t):i.push(e,t)}function Ki(i,e,t){if(t.length==0)return;let n=e.length-2>>1;if(n<i.length)i[i.length-1]=i[i.length-1].append(t);else{for(;i.length<n;)i.push(Le.empty);i.push(t)}}function Ol(i,e,t){let n=i.inserted;for(let r=0,o=0,s=0;s<i.sections.length;){let l=i.sections[s++],a=i.sections[s++];if(a<0)r+=l,o+=l;else{let c=r,h=o,d=Le.empty;for(;c+=l,h+=a,a&&n&&(d=d.append(n[s-2>>1])),!(t||s==i.sections.length||i.sections[s+1]<0);)l=i.sections[s++],a=i.sections[s++];e(r,c,o,h,d),r=c,o=h}}}function Dl(i,e,t,n=!1){let r=[],o=n?[]:null,s=new Hr(i),l=new Hr(e);for(let a=-1;;)if(s.ins==-1&&l.ins==-1){let c=Math.min(s.len,l.len);wt(r,c,-1),s.forward(c),l.forward(c)}else if(l.ins>=0&&(s.ins<0||a==s.i||s.off==0&&(l.len<s.len||l.len==s.len&&!t))){let c=l.len;for(wt(r,l.ins,-1);c;){let h=Math.min(s.len,c);s.ins>=0&&a<s.i&&s.len<=h&&(wt(r,0,s.ins),o&&Ki(o,r,s.text),a=s.i),s.forward(h),c-=h}l.next()}else if(s.ins>=0){let c=0,h=s.len;for(;h;)if(l.ins==-1){let d=Math.min(h,l.len);c+=d,h-=d,l.forward(d)}else if(l.ins==0&&l.len<h)h-=l.len,l.next();else break;wt(r,c,a<s.i?s.ins:0),o&&a<s.i&&Ki(o,r,s.text),a=s.i,s.forward(s.len-h)}else{if(s.done&&l.done)return o?lt.createSet(r,o):Ci.create(r);throw new Error("Mismatched change set lengths")}}function Uu(i,e,t=!1){let n=[],r=t?[]:null,o=new Hr(i),s=new Hr(e);for(let l=!1;;){if(o.done&&s.done)return r?lt.createSet(n,r):Ci.create(n);if(o.ins==0)wt(n,o.len,0,l),o.next();else if(s.len==0&&!s.done)wt(n,0,s.ins,l),r&&Ki(r,n,s.text),s.next();else{if(o.done||s.done)throw new Error("Mismatched change set lengths");{let a=Math.min(o.len2,s.len),c=n.length;if(o.ins==-1){let h=s.ins==-1?-1:s.off?0:s.ins;wt(n,a,h,l),r&&h&&Ki(r,n,s.text)}else s.ins==-1?(wt(n,o.off?0:o.len,a,l),r&&Ki(r,n,o.textBit(a))):(wt(n,o.off?0:o.len,s.off?0:s.ins,l),r&&!s.off&&Ki(r,n,s.text));l=(o.ins>a||s.ins>=0&&s.len>a)&&(l||n.length>c),o.forward2(a),s.forward(a)}}}}class Hr{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?Le.empty:e[t]}textBit(e){let{inserted:t}=this.set,n=this.i-2>>1;return n>=t.length&&!e?Le.empty:t[n].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class un{constructor(e,t,n){this.from=e,this.to=t,this.flags=n}get anchor(){return this.flags&16?this.to:this.from}get head(){return this.flags&16?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&4?-1:this.flags&8?1:0}get bidiLevel(){let e=this.flags&3;return e==3?null:e}get goalColumn(){let e=this.flags>>5;return e==33554431?void 0:e}map(e,t=-1){let n,r;return this.empty?n=r=e.mapPos(this.from,t):(n=e.mapPos(this.from,1),r=e.mapPos(this.to,-1)),n==this.from&&r==this.to?this:new un(n,r,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return z.range(e,t);let n=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return z.range(this.anchor,n)}eq(e){return this.anchor==e.anchor&&this.head==e.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return z.range(e.anchor,e.head)}static create(e,t,n){return new un(e,t,n)}}class z{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:z.create(this.ranges.map(n=>n.map(e,t)),this.mainIndex)}eq(e){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let t=0;t<this.ranges.length;t++)if(!this.ranges[t].eq(e.ranges[t]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new z([this.main],0)}addRange(e,t=!0){return z.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let n=this.ranges.slice();return n[t]=e,z.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new z(e.ranges.map(t=>un.fromJSON(t)),e.main)}static single(e,t=e){return new z([z.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let n=0,r=0;r<e.length;r++){let o=e[r];if(o.empty?o.from<=n:o.from<n)return z.normalized(e.slice(),t);n=o.to}return new z(e,t)}static cursor(e,t=0,n,r){return un.create(e,e,(t==0?0:t<0?4:8)|(n==null?3:Math.min(2,n))|(r??33554431)<<5)}static range(e,t,n,r){let o=(n??33554431)<<5|(r==null?3:Math.min(2,r));return t<e?un.create(t,e,24|o):un.create(e,t,(t>e?4:0)|o)}static normalized(e,t=0){let n=e[t];e.sort((r,o)=>r.from-o.from),t=e.indexOf(n);for(let r=1;r<e.length;r++){let o=e[r],s=e[r-1];if(o.empty?o.from<=s.to:o.from<s.to){let l=s.from,a=Math.max(o.to,s.to);r<=t&&t--,e.splice(--r,2,o.anchor>o.head?z.range(a,l):z.range(l,a))}}return new z(e,t)}}function Ku(i,e){for(let t of i.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let Da=0;class de{constructor(e,t,n,r,o){this.combine=e,this.compareInput=t,this.compare=n,this.isStatic=r,this.id=Da++,this.default=e([]),this.extensions=typeof o=="function"?o(this):o}static define(e={}){return new de(e.combine||(t=>t),e.compareInput||((t,n)=>t===n),e.compare||(e.combine?(t,n)=>t===n:Ta),!!e.static,e.enables)}of(e){return new No([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new No(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new No(e,this,2,t)}from(e,t){return t||(t=n=>n),this.compute([e],n=>t(n.field(e)))}}function Ta(i,e){return i==e||i.length==e.length&&i.every((t,n)=>t===e[n])}class No{constructor(e,t,n,r){this.dependencies=e,this.facet=t,this.type=n,this.value=r,this.id=Da++}dynamicSlot(e){var t;let n=this.value,r=this.facet.compareInput,o=this.id,s=e[o]>>1,l=this.type==2,a=!1,c=!1,h=[];for(let d of this.dependencies)d=="doc"?a=!0:d=="selection"?c=!0:((t=e[d.id])!==null&&t!==void 0?t:1)&1||h.push(e[d.id]);return{create(d){return d.values[s]=n(d),1},update(d,u){if(a&&u.docChanged||c&&(u.docChanged||u.selection)||Tl(d,h)){let f=n(d);if(l?!_c(f,d.values[s],r):!r(f,d.values[s]))return d.values[s]=f,1}return 0},reconfigure:(d,u)=>{let f,g=u.config.address[o];if(g!=null){let x=Yo(u,g);if(this.dependencies.every(b=>b instanceof de?u.facet(b)===d.facet(b):b instanceof mt?u.field(b,!1)==d.field(b,!1):!0)||(l?_c(f=n(d),x,r):r(f=n(d),x)))return d.values[s]=x,0}else f=n(d);return d.values[s]=f,1}}}}function _c(i,e,t){if(i.length!=e.length)return!1;for(let n=0;n<i.length;n++)if(!t(i[n],e[n]))return!1;return!0}function Tl(i,e){let t=!1;for(let n of e)Lr(i,n)&1&&(t=!0);return t}function Db(i,e,t){let n=t.map(a=>i[a.id]),r=t.map(a=>a.type),o=n.filter(a=>!(a&1)),s=i[e.id]>>1;function l(a){let c=[];for(let h=0;h<n.length;h++){let d=Yo(a,n[h]);if(r[h]==2)for(let u of d)c.push(u);else c.push(d)}return e.combine(c)}return{create(a){for(let c of n)Lr(a,c);return a.values[s]=l(a),1},update(a,c){if(!Tl(a,o))return 0;let h=l(a);return e.compare(h,a.values[s])?0:(a.values[s]=h,1)},reconfigure(a,c){let h=Tl(a,n),d=c.config.facets[e.id],u=c.facet(e);if(d&&!h&&Ta(t,d))return a.values[s]=u,0;let f=l(a);return e.compare(f,u)?(a.values[s]=u,0):(a.values[s]=f,1)}}}const Gc=de.define({static:!0});class mt{constructor(e,t,n,r,o){this.id=e,this.createF=t,this.updateF=n,this.compareF=r,this.spec=o,this.provides=void 0}static define(e){let t=new mt(Da++,e.create,e.update,e.compare||((n,r)=>n===r),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(Gc).find(n=>n.field==this);return((t==null?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:n=>(n.values[t]=this.create(n),1),update:(n,r)=>{let o=n.values[t],s=this.updateF(o,r);return this.compareF(o,s)?0:(n.values[t]=s,1)},reconfigure:(n,r)=>r.config.address[this.id]!=null?(n.values[t]=r.field(this),0):(n.values[t]=this.create(n),1)}}init(e){return[this,Gc.of({field:this,create:e})]}get extension(){return this}}const cn={lowest:4,low:3,default:2,high:1,highest:0};function yr(i){return e=>new qu(e,i)}const lr={highest:yr(cn.highest),high:yr(cn.high),default:yr(cn.default),low:yr(cn.low),lowest:yr(cn.lowest)};class qu{constructor(e,t){this.inner=e,this.prec=t}}class Yn{of(e){return new Pl(this,e)}reconfigure(e){return Yn.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class Pl{constructor(e,t){this.compartment=e,this.inner=t}}class Xo{constructor(e,t,n,r,o,s){for(this.base=e,this.compartments=t,this.dynamicSlots=n,this.address=r,this.staticValues=o,this.facets=s,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,n){let r=[],o=Object.create(null),s=new Map;for(let u of Tb(e,t,s))u instanceof mt?r.push(u):(o[u.facet.id]||(o[u.facet.id]=[])).push(u);let l=Object.create(null),a=[],c=[];for(let u of r)l[u.id]=c.length<<1,c.push(f=>u.slot(f));let h=n==null?void 0:n.config.facets;for(let u in o){let f=o[u],g=f[0].facet,x=h&&h[u]||[];if(f.every(b=>b.type==0))if(l[g.id]=a.length<<1|1,Ta(x,f))a.push(n.facet(g));else{let b=g.combine(f.map(S=>S.value));a.push(n&&g.compare(b,n.facet(g))?n.facet(g):b)}else{for(let b of f)b.type==0?(l[b.id]=a.length<<1|1,a.push(b.value)):(l[b.id]=c.length<<1,c.push(S=>b.dynamicSlot(S)));l[g.id]=c.length<<1,c.push(b=>Db(b,g,f))}}let d=c.map(u=>u(l));return new Xo(e,s,d,l,a,o)}}function Tb(i,e,t){let n=[[],[],[],[],[]],r=new Map;function o(s,l){let a=r.get(s);if(a!=null){if(a<=l)return;let c=n[a].indexOf(s);c>-1&&n[a].splice(c,1),s instanceof Pl&&t.delete(s.compartment)}if(r.set(s,l),Array.isArray(s))for(let c of s)o(c,l);else if(s instanceof Pl){if(t.has(s.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=e.get(s.compartment)||s.inner;t.set(s.compartment,c),o(c,l)}else if(s instanceof qu)o(s.inner,s.prec);else if(s instanceof mt)n[l].push(s),s.provides&&o(s.provides,l);else if(s instanceof No)n[l].push(s),s.facet.extensions&&o(s.facet.extensions,cn.default);else{let c=s.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${s}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);o(c,l)}}return o(i,cn.default),n.reduce((s,l)=>s.concat(l))}function Lr(i,e){if(e&1)return 2;let t=e>>1,n=i.status[t];if(n==4)throw new Error("Cyclic dependency between fields and/or facets");if(n&2)return n;i.status[t]=4;let r=i.computeSlot(i,i.config.dynamicSlots[t]);return i.status[t]=2|r}function Yo(i,e){return e&1?i.config.staticValues[e>>1]:i.values[e>>1]}const _u=de.define(),Gu=de.define({combine:i=>i.some(e=>e),static:!0}),Xu=de.define({combine:i=>i.length?i[0]:void 0,static:!0}),Yu=de.define(),Ju=de.define(),Zu=de.define(),Qu=de.define({combine:i=>i.length?i[0]:!1});class zi{constructor(e,t){this.type=e,this.value=t}static define(){return new Pb}}class Pb{of(e){return new zi(this,e)}}class Lb{constructor(e){this.map=e}of(e){return new Ce(this,e)}}class Ce{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new Ce(this.type,t)}is(e){return this.type==e}static define(e={}){return new Lb(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let n=[];for(let r of e){let o=r.map(t);o&&n.push(o)}return n}}Ce.reconfigure=Ce.define();Ce.appendConfig=Ce.define();class at{constructor(e,t,n,r,o,s){this.startState=e,this.changes=t,this.selection=n,this.effects=r,this.annotations=o,this.scrollIntoView=s,this._doc=null,this._state=null,n&&Ku(n,t.newLength),o.some(l=>l.type==at.time)||(this.annotations=o.concat(at.time.of(Date.now())))}static create(e,t,n,r,o,s){return new at(e,t,n,r,o,s)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(at.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}at.time=zi.define();at.userEvent=zi.define();at.addToHistory=zi.define();at.remote=zi.define();function Bb(i,e){let t=[];for(let n=0,r=0;;){let o,s;if(n<i.length&&(r==e.length||e[r]>=i[n]))o=i[n++],s=i[n++];else if(r<e.length)o=e[r++],s=e[r++];else return t;!t.length||t[t.length-1]<o?t.push(o,s):t[t.length-1]<s&&(t[t.length-1]=s)}}function ef(i,e,t){var n;let r,o,s;return t?(r=e.changes,o=lt.empty(e.changes.length),s=i.changes.compose(e.changes)):(r=e.changes.map(i.changes),o=i.changes.mapDesc(e.changes,!0),s=i.changes.compose(r)),{changes:s,selection:e.selection?e.selection.map(o):(n=i.selection)===null||n===void 0?void 0:n.map(r),effects:Ce.mapEffects(i.effects,r).concat(Ce.mapEffects(e.effects,o)),annotations:i.annotations.length?i.annotations.concat(e.annotations):e.annotations,scrollIntoView:i.scrollIntoView||e.scrollIntoView}}function Ll(i,e,t){let n=e.selection,r=Un(e.annotations);return e.userEvent&&(r=r.concat(at.userEvent.of(e.userEvent))),{changes:e.changes instanceof lt?e.changes:lt.of(e.changes||[],t,i.facet(Xu)),selection:n&&(n instanceof z?n:z.single(n.anchor,n.head)),effects:Un(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function tf(i,e,t){let n=Ll(i,e.length?e[0]:{},i.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let o=1;o<e.length;o++){e[o].filter===!1&&(t=!1);let s=!!e[o].sequential;n=ef(n,Ll(i,e[o],s?n.changes.newLength:i.doc.length),s)}let r=at.create(i,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return Ib(t?Eb(r):r)}function Eb(i){let e=i.startState,t=!0;for(let r of e.facet(Yu)){let o=r(i);if(o===!1){t=!1;break}Array.isArray(o)&&(t=t===!0?o:Bb(t,o))}if(t!==!0){let r,o;if(t===!1)o=i.changes.invertedDesc,r=lt.empty(e.doc.length);else{let s=i.changes.filter(t);r=s.changes,o=s.filtered.mapDesc(s.changes).invertedDesc}i=at.create(e,r,i.selection&&i.selection.map(o),Ce.mapEffects(i.effects,o),i.annotations,i.scrollIntoView)}let n=e.facet(Ju);for(let r=n.length-1;r>=0;r--){let o=n[r](i);o instanceof at?i=o:Array.isArray(o)&&o.length==1&&o[0]instanceof at?i=o[0]:i=tf(e,Un(o),!1)}return i}function Ib(i){let e=i.startState,t=e.facet(Zu),n=i;for(let r=t.length-1;r>=0;r--){let o=t[r](i);o&&Object.keys(o).length&&(n=ef(n,Ll(e,o,i.changes.newLength),!0))}return n==i?i:at.create(e,i.changes,i.selection,n.effects,n.annotations,n.scrollIntoView)}const Nb=[];function Un(i){return i==null?Nb:Array.isArray(i)?i:[i]}var Ve=function(i){return i[i.Word=0]="Word",i[i.Space=1]="Space",i[i.Other=2]="Other",i}(Ve||(Ve={}));const zb=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Bl;try{Bl=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function Fb(i){if(Bl)return Bl.test(i);for(let e=0;e<i.length;e++){let t=i[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||zb.test(t)))return!0}return!1}function $b(i){return e=>{if(!/\S/.test(e))return Ve.Space;if(Fb(e))return Ve.Word;for(let t=0;t<i.length;t++)if(e.indexOf(i[t])>-1)return Ve.Word;return Ve.Other}}class Te{constructor(e,t,n,r,o,s){this.config=e,this.doc=t,this.selection=n,this.values=r,this.status=e.statusTemplate.slice(),this.computeSlot=o,s&&(s._state=this);for(let l=0;l<this.config.dynamicSlots.length;l++)Lr(this,l<<1);this.computeSlot=null}field(e,t=!0){let n=this.config.address[e.id];if(n==null){if(t)throw new RangeError("Field is not present in this state");return}return Lr(this,n),Yo(this,n)}update(...e){return tf(this,e,!0)}applyTransaction(e){let t=this.config,{base:n,compartments:r}=t;for(let s of e.effects)s.is(Yn.reconfigure)?(t&&(r=new Map,t.compartments.forEach((l,a)=>r.set(a,l)),t=null),r.set(s.value.compartment,s.value.extension)):s.is(Ce.reconfigure)?(t=null,n=s.value):s.is(Ce.appendConfig)&&(t=null,n=Un(n).concat(s.value));let o;t?o=e.startState.values.slice():(t=Xo.resolve(n,r,this),o=new Te(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(s,l)=>l.reconfigure(s,this),null).values),new Te(t,e.newDoc,e.newSelection,o,(s,l)=>l.update(s,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:z.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,n=e(t.ranges[0]),r=this.changes(n.changes),o=[n.range],s=Un(n.effects);for(let l=1;l<t.ranges.length;l++){let a=e(t.ranges[l]),c=this.changes(a.changes),h=c.map(r);for(let u=0;u<l;u++)o[u]=o[u].map(h);let d=r.mapDesc(c,!0);o.push(a.range.map(d)),r=r.compose(h),s=Ce.mapEffects(s,h).concat(Ce.mapEffects(Un(a.effects),d))}return{changes:r,selection:z.create(o,t.mainIndex),effects:s}}changes(e=[]){return e instanceof lt?e:lt.of(e,this.doc.length,this.facet(Te.lineSeparator))}toText(e){return Le.of(e.split(this.facet(Te.lineSeparator)||Ml))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(Lr(this,t),Yo(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let n in e){let r=e[n];r instanceof mt&&this.config.address[r.id]!=null&&(t[n]=r.spec.toJSON(this.field(e[n]),this))}return t}static fromJSON(e,t={},n){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let r=[];if(n){for(let o in n)if(Object.prototype.hasOwnProperty.call(e,o)){let s=n[o],l=e[o];r.push(s.init(a=>s.spec.fromJSON(l,a)))}}return Te.create({doc:e.doc,selection:z.fromJSON(e.selection),extensions:t.extensions?r.concat([t.extensions]):r})}static create(e={}){let t=Xo.resolve(e.extensions||[],new Map),n=e.doc instanceof Le?e.doc:Le.of((e.doc||"").split(t.staticFacet(Te.lineSeparator)||Ml)),r=e.selection?e.selection instanceof z?e.selection:z.single(e.selection.anchor,e.selection.head):z.single(0);return Ku(r,n.length),t.staticFacet(Gu)||(r=r.asSingle()),new Te(t,n,r,t.dynamicSlots.map(()=>null),(o,s)=>s.create(o),null)}get tabSize(){return this.facet(Te.tabSize)}get lineBreak(){return this.facet(Te.lineSeparator)||`
`}get readOnly(){return this.facet(Qu)}phrase(e,...t){for(let n of this.facet(Te.phrases))if(Object.prototype.hasOwnProperty.call(n,e)){e=n[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(n,r)=>{if(r=="$")return"$";let o=+(r||1);return!o||o>t.length?n:t[o-1]})),e}languageDataAt(e,t,n=-1){let r=[];for(let o of this.facet(_u))for(let s of o(this,t,n))Object.prototype.hasOwnProperty.call(s,e)&&r.push(s[e]);return r}charCategorizer(e){return $b(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:n,length:r}=this.doc.lineAt(e),o=this.charCategorizer(e),s=e-n,l=e-n;for(;s>0;){let a=At(t,s,!1);if(o(t.slice(a,s))!=Ve.Word)break;s=a}for(;l<r;){let a=At(t,l);if(o(t.slice(l,a))!=Ve.Word)break;l=a}return s==l?null:z.range(s+n,l+n)}}Te.allowMultipleSelections=Gu;Te.tabSize=de.define({combine:i=>i.length?i[0]:4});Te.lineSeparator=Xu;Te.readOnly=Qu;Te.phrases=de.define({compare(i,e){let t=Object.keys(i),n=Object.keys(e);return t.length==n.length&&t.every(r=>i[r]==e[r])}});Te.languageData=_u;Te.changeFilter=Yu;Te.transactionFilter=Ju;Te.transactionExtender=Zu;Yn.reconfigure=Ce.define();function Ai(i,e,t={}){let n={};for(let r of i)for(let o of Object.keys(r)){let s=r[o],l=n[o];if(l===void 0)n[o]=s;else if(!(l===s||s===void 0))if(Object.hasOwnProperty.call(t,o))n[o]=t[o](l,s);else throw new Error("Config merge conflict for field "+o)}for(let r in e)n[r]===void 0&&(n[r]=e[r]);return n}class yn{eq(e){return this==e}range(e,t=e){return El.create(e,t,this)}}yn.prototype.startSide=yn.prototype.endSide=0;yn.prototype.point=!1;yn.prototype.mapMode=St.TrackDel;let El=class nf{constructor(e,t,n){this.from=e,this.to=t,this.value=n}static create(e,t,n){return new nf(e,t,n)}};function Il(i,e){return i.from-e.from||i.value.startSide-e.value.startSide}class Pa{constructor(e,t,n,r){this.from=e,this.to=t,this.value=n,this.maxPoint=r}get length(){return this.to[this.to.length-1]}findIndex(e,t,n,r=0){let o=n?this.to:this.from;for(let s=r,l=o.length;;){if(s==l)return s;let a=s+l>>1,c=o[a]-e||(n?this.value[a].endSide:this.value[a].startSide)-t;if(a==s)return c>=0?s:l;c>=0?l=a:s=a+1}}between(e,t,n,r){for(let o=this.findIndex(t,-1e9,!0),s=this.findIndex(n,1e9,!1,o);o<s;o++)if(r(this.from[o]+e,this.to[o]+e,this.value[o])===!1)return!1}map(e,t){let n=[],r=[],o=[],s=-1,l=-1;for(let a=0;a<this.value.length;a++){let c=this.value[a],h=this.from[a]+e,d=this.to[a]+e,u,f;if(h==d){let g=t.mapPos(h,c.startSide,c.mapMode);if(g==null||(u=f=g,c.startSide!=c.endSide&&(f=t.mapPos(h,c.endSide),f<u)))continue}else if(u=t.mapPos(h,c.startSide),f=t.mapPos(d,c.endSide),u>f||u==f&&c.startSide>0&&c.endSide<=0)continue;(f-u||c.endSide-c.startSide)<0||(s<0&&(s=u),c.point&&(l=Math.max(l,f-u)),n.push(c),r.push(u-s),o.push(f-s))}return{mapped:n.length?new Pa(r,o,n,l):null,pos:s}}}class Be{constructor(e,t,n,r){this.chunkPos=e,this.chunk=t,this.nextLayer=n,this.maxPoint=r}static create(e,t,n,r){return new Be(e,t,n,r)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:n=!1,filterFrom:r=0,filterTo:o=this.length}=e,s=e.filter;if(t.length==0&&!s)return this;if(n&&(t=t.slice().sort(Il)),this.isEmpty)return t.length?Be.of(t):this;let l=new rf(this,null,-1).goto(0),a=0,c=[],h=new Zi;for(;l.value||a<t.length;)if(a<t.length&&(l.from-t[a].from||l.startSide-t[a].value.startSide)>=0){let d=t[a++];h.addInner(d.from,d.to,d.value)||c.push(d)}else l.rangeIndex==1&&l.chunkIndex<this.chunk.length&&(a==t.length||this.chunkEnd(l.chunkIndex)<t[a].from)&&(!s||r>this.chunkEnd(l.chunkIndex)||o<this.chunkPos[l.chunkIndex])&&h.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!s||r>l.to||o<l.from||s(l.from,l.to,l.value))&&(h.addInner(l.from,l.to,l.value)||c.push(El.create(l.from,l.to,l.value))),l.next());return h.finishInner(this.nextLayer.isEmpty&&!c.length?Be.empty:this.nextLayer.update({add:c,filter:s,filterFrom:r,filterTo:o}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],n=[],r=-1;for(let s=0;s<this.chunk.length;s++){let l=this.chunkPos[s],a=this.chunk[s],c=e.touchesRange(l,l+a.length);if(c===!1)r=Math.max(r,a.maxPoint),t.push(a),n.push(e.mapPos(l));else if(c===!0){let{mapped:h,pos:d}=a.map(l,e);h&&(r=Math.max(r,h.maxPoint),t.push(h),n.push(d))}}let o=this.nextLayer.map(e);return t.length==0?o:new Be(n,t,o||Be.empty,r)}between(e,t,n){if(!this.isEmpty){for(let r=0;r<this.chunk.length;r++){let o=this.chunkPos[r],s=this.chunk[r];if(t>=o&&e<=o+s.length&&s.between(o,e-o,t-o,n)===!1)return}this.nextLayer.between(e,t,n)}}iter(e=0){return jr.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return jr.from(e).goto(t)}static compare(e,t,n,r,o=-1){let s=e.filter(d=>d.maxPoint>0||!d.isEmpty&&d.maxPoint>=o),l=t.filter(d=>d.maxPoint>0||!d.isEmpty&&d.maxPoint>=o),a=Xc(s,l,n),c=new wr(s,a,o),h=new wr(l,a,o);n.iterGaps((d,u,f)=>Yc(c,d,h,u,f,r)),n.empty&&n.length==0&&Yc(c,0,h,0,0,r)}static eq(e,t,n=0,r){r==null&&(r=1e9-1);let o=e.filter(h=>!h.isEmpty&&t.indexOf(h)<0),s=t.filter(h=>!h.isEmpty&&e.indexOf(h)<0);if(o.length!=s.length)return!1;if(!o.length)return!0;let l=Xc(o,s),a=new wr(o,l,0).goto(n),c=new wr(s,l,0).goto(n);for(;;){if(a.to!=c.to||!Nl(a.active,c.active)||a.point&&(!c.point||!a.point.eq(c.point)))return!1;if(a.to>r)return!0;a.next(),c.next()}}static spans(e,t,n,r,o=-1){let s=new wr(e,null,o).goto(t),l=t,a=s.openStart;for(;;){let c=Math.min(s.to,n);if(s.point){let h=s.activeForPoint(s.to),d=s.pointFrom<t?h.length+1:Math.min(h.length,a);r.point(l,c,s.point,h,d,s.pointRank),a=Math.min(s.openEnd(c),h.length)}else c>l&&(r.span(l,c,s.active,a),a=s.openEnd(c));if(s.to>n)return a+(s.point&&s.to>n?1:0);l=s.to,s.next()}}static of(e,t=!1){let n=new Zi;for(let r of e instanceof El?[e]:t?Hb(e):e)n.add(r.from,r.to,r.value);return n.finish()}}Be.empty=new Be([],[],null,-1);function Hb(i){if(i.length>1)for(let e=i[0],t=1;t<i.length;t++){let n=i[t];if(Il(e,n)>0)return i.slice().sort(Il);e=n}return i}Be.empty.nextLayer=Be.empty;class Zi{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(e){this.chunks.push(new Pa(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}add(e,t,n){this.addInner(e,t,n)||(this.nextLayer||(this.nextLayer=new Zi)).add(e,t,n)}addInner(e,t,n){let r=e-this.lastTo||n.startSide-this.last.endSide;if(r<=0&&(e-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return r<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=t,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let n=t.value.length-1;return this.last=t.value[n],this.lastFrom=t.from[n]+e,this.lastTo=t.to[n]+e,!0}finish(){return this.finishInner(Be.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=Be.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function Xc(i,e,t){let n=new Map;for(let o of i)for(let s=0;s<o.chunk.length;s++)o.chunk[s].maxPoint<=0&&n.set(o.chunk[s],o.chunkPos[s]);let r=new Set;for(let o of e)for(let s=0;s<o.chunk.length;s++){let l=n.get(o.chunk[s]);l!=null&&(t?t.mapPos(l):l)==o.chunkPos[s]&&!(t!=null&&t.touchesRange(l,l+o.chunk[s].length))&&r.add(o.chunk[s])}return r}class rf{constructor(e,t,n,r=0){this.layer=e,this.skip=t,this.minPoint=n,this.rank=r}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,n){for(;this.chunkIndex<this.layer.chunk.length;){let r=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<e||r.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let r=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!n||this.rangeIndex<r)&&this.setRangeIndex(r)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],n=e+t.from[this.rangeIndex];if(this.from=n,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class jr{constructor(e){this.heap=e}static from(e,t=null,n=-1){let r=[];for(let o=0;o<e.length;o++)for(let s=e[o];!s.isEmpty;s=s.nextLayer)s.maxPoint>=n&&r.push(new rf(s,t,n,o));return r.length==1?r[0]:new jr(r)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let n of this.heap)n.goto(e,t);for(let n=this.heap.length>>1;n>=0;n--)tl(this.heap,n);return this.next(),this}forward(e,t){for(let n of this.heap)n.forward(e,t);for(let n=this.heap.length>>1;n>=0;n--)tl(this.heap,n);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),tl(this.heap,0)}}}function tl(i,e){for(let t=i[e];;){let n=(e<<1)+1;if(n>=i.length)break;let r=i[n];if(n+1<i.length&&r.compare(i[n+1])>=0&&(r=i[n+1],n++),t.compare(r)<0)break;i[n]=t,i[e]=r,e=n}}class wr{constructor(e,t,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=jr.from(e,t,n)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){go(this.active,e),go(this.activeTo,e),go(this.activeRank,e),this.minActive=Jc(this.active,this.activeTo)}addActive(e){let t=0,{value:n,to:r,rank:o}=this.cursor;for(;t<this.activeRank.length&&this.activeRank[t]<=o;)t++;mo(this.active,t,n),mo(this.activeTo,t,r),mo(this.activeRank,t,o),e&&mo(e,t,this.cursor.from),this.minActive=Jc(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>e){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),n&&go(n,r)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let o=this.cursor.value;if(!o.point)this.addActive(n),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=o,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=o.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(n){this.openStart=0;for(let r=n.length-1;r>=0&&n[r]<e;r--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>=this.point.endSide)&&t.push(this.active[n]);return t.reverse()}openEnd(e){let t=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>e;n--)t++;return t}}function Yc(i,e,t,n,r,o){i.goto(e),t.goto(n);let s=n+r,l=n,a=n-e;for(;;){let c=i.to+a-t.to||i.endSide-t.endSide,h=c<0?i.to+a:t.to,d=Math.min(h,s);if(i.point||t.point?i.point&&t.point&&(i.point==t.point||i.point.eq(t.point))&&Nl(i.activeForPoint(i.to+a),t.activeForPoint(t.to))||o.comparePoint(l,d,i.point,t.point):d>l&&!Nl(i.active,t.active)&&o.compareRange(l,d,i.active,t.active),h>s)break;l=h,c<=0&&i.next(),c>=0&&t.next()}}function Nl(i,e){if(i.length!=e.length)return!1;for(let t=0;t<i.length;t++)if(i[t]!=e[t]&&!i[t].eq(e[t]))return!1;return!0}function go(i,e){for(let t=e,n=i.length-1;t<n;t++)i[t]=i[t+1];i.pop()}function mo(i,e,t){for(let n=i.length-1;n>=e;n--)i[n+1]=i[n];i[e]=t}function Jc(i,e){let t=-1,n=1e9;for(let r=0;r<e.length;r++)(e[r]-n||i[r].endSide-i[t].endSide)<0&&(t=r,n=e[r]);return t}function eo(i,e,t=i.length){let n=0;for(let r=0;r<t;)i.charCodeAt(r)==9?(n+=e-n%e,r++):(n++,r=At(i,r));return n}function zl(i,e,t,n){for(let r=0,o=0;;){if(o>=e)return r;if(r==i.length)break;o+=i.charCodeAt(r)==9?t-o%t:1,r=At(i,r)}return n===!0?-1:i.length}const Fl="ͼ",Zc=typeof Symbol>"u"?"__"+Fl:Symbol.for(Fl),$l=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),Qc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Qi{constructor(e,t){this.rules=[];let{finish:n}=t||{};function r(s){return/^@/.test(s)?[s]:s.split(/,\s*/)}function o(s,l,a,c){let h=[],d=/^@(\w+)\b/.exec(s[0]),u=d&&d[1]=="keyframes";if(d&&l==null)return a.push(s[0]+";");for(let f in l){let g=l[f];if(/&/.test(f))o(f.split(/,\s*/).map(x=>s.map(b=>x.replace(/&/,b))).reduce((x,b)=>x.concat(b)),g,a);else if(g&&typeof g=="object"){if(!d)throw new RangeError("The value of a property ("+f+") should be a primitive value.");o(r(f),g,h,u)}else g!=null&&h.push(f.replace(/_.*/,"").replace(/[A-Z]/g,x=>"-"+x.toLowerCase())+": "+g+";")}(h.length||u)&&a.push((n&&!d&&!c?s.map(n):s).join(", ")+" {"+h.join(" ")+"}")}for(let s in e)o(r(s),e[s],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=Qc[Zc]||1;return Qc[Zc]=e+1,Fl+e.toString(36)}static mount(e,t){(e[$l]||new jb(e)).mount(Array.isArray(t)?t:[t])}}let eh=new Map;class jb{constructor(e){let t=e.ownerDocument||e,n=t.defaultView;if(!e.head&&e.adoptedStyleSheets&&n.CSSStyleSheet){let r=eh.get(t);if(r)return e.adoptedStyleSheets=[r.sheet,...e.adoptedStyleSheets],e[$l]=r;this.sheet=new n.CSSStyleSheet,e.adoptedStyleSheets=[this.sheet,...e.adoptedStyleSheets],eh.set(t,this)}else{this.styleTag=t.createElement("style");let r=e.head||e;r.insertBefore(this.styleTag,r.firstChild)}this.modules=[],e[$l]=this}mount(e){let t=this.sheet,n=0,r=0;for(let o=0;o<e.length;o++){let s=e[o],l=this.modules.indexOf(s);if(l<r&&l>-1&&(this.modules.splice(l,1),r--,l=-1),l==-1){if(this.modules.splice(r++,0,s),t)for(let a=0;a<s.rules.length;a++)t.insertRule(s.rules[a],n++)}else{for(;r<l;)n+=this.modules[r++].rules.length;n+=s.rules.length,r++}}if(!t){let o="";for(let s=0;s<this.modules.length;s++)o+=this.modules[s].getRules()+`
`;this.styleTag.textContent=o}}}var en={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Wr={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},th=typeof navigator<"u"&&/Chrome\/(\d+)/.exec(navigator.userAgent),Wb=typeof navigator<"u"&&/Mac/.test(navigator.platform),Vb=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Ub=Wb||th&&+th[1]<57;for(var ft=0;ft<10;ft++)en[48+ft]=en[96+ft]=String(ft);for(var ft=1;ft<=24;ft++)en[ft+111]="F"+ft;for(var ft=65;ft<=90;ft++)en[ft]=String.fromCharCode(ft+32),Wr[ft]=String.fromCharCode(ft);for(var il in en)Wr.hasOwnProperty(il)||(Wr[il]=en[il]);function Kb(i){var e=Ub&&(i.ctrlKey||i.altKey||i.metaKey)||Vb&&i.shiftKey&&i.key&&i.key.length==1||i.key=="Unidentified",t=!e&&i.key||(i.shiftKey?Wr:en)[i.keyCode]||i.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function Jo(i){let e;return i.nodeType==11?e=i.getSelection?i:i.ownerDocument:e=i,e.getSelection()}function Jn(i,e){return e?i==e||i.contains(e.nodeType!=1?e.parentNode:e):!1}function qb(i){let e=i.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function zo(i,e){if(!e.anchorNode)return!1;try{return Jn(i,e.anchorNode)}catch{return!1}}function Vr(i){return i.nodeType==3?Zn(i,0,i.nodeValue.length).getClientRects():i.nodeType==1?i.getClientRects():[]}function Zo(i,e,t,n){return t?ih(i,e,t,n,-1)||ih(i,e,t,n,1):!1}function Qo(i){for(var e=0;;e++)if(i=i.previousSibling,!i)return e}function ih(i,e,t,n,r){for(;;){if(i==t&&e==n)return!0;if(e==(r<0?0:tn(i))){if(i.nodeName=="DIV")return!1;let o=i.parentNode;if(!o||o.nodeType!=1)return!1;e=Qo(i)+(r<0?0:1),i=o}else if(i.nodeType==1){if(i=i.childNodes[e+(r<0?-1:0)],i.nodeType==1&&i.contentEditable=="false")return!1;e=r<0?tn(i):0}else return!1}}function tn(i){return i.nodeType==3?i.nodeValue.length:i.childNodes.length}function La(i,e){let t=e?i.left:i.right;return{left:t,right:t,top:i.top,bottom:i.bottom}}function _b(i){return{left:0,right:i.innerWidth,top:0,bottom:i.innerHeight}}function Gb(i,e,t,n,r,o,s,l){let a=i.ownerDocument,c=a.defaultView||window;for(let h=i;h;)if(h.nodeType==1){let d,u=h==a.body;if(u)d=_b(c);else{if(h.scrollHeight<=h.clientHeight&&h.scrollWidth<=h.clientWidth){h=h.assignedSlot||h.parentNode;continue}let x=h.getBoundingClientRect();d={left:x.left,right:x.left+h.clientWidth,top:x.top,bottom:x.top+h.clientHeight}}let f=0,g=0;if(r=="nearest")e.top<d.top?(g=-(d.top-e.top+s),t>0&&e.bottom>d.bottom+g&&(g=e.bottom-d.bottom+g+s)):e.bottom>d.bottom&&(g=e.bottom-d.bottom+s,t<0&&e.top-g<d.top&&(g=-(d.top+g-e.top+s)));else{let x=e.bottom-e.top,b=d.bottom-d.top;g=(r=="center"&&x<=b?e.top+x/2-b/2:r=="start"||r=="center"&&t<0?e.top-s:e.bottom-b+s)-d.top}if(n=="nearest"?e.left<d.left?(f=-(d.left-e.left+o),t>0&&e.right>d.right+f&&(f=e.right-d.right+f+o)):e.right>d.right&&(f=e.right-d.right+o,t<0&&e.left<d.left+f&&(f=-(d.left+f-e.left+o))):f=(n=="center"?e.left+(e.right-e.left)/2-(d.right-d.left)/2:n=="start"==l?e.left-o:e.right-(d.right-d.left)+o)-d.left,f||g)if(u)c.scrollBy(f,g);else{let x=0,b=0;if(g){let S=h.scrollTop;h.scrollTop+=g,b=h.scrollTop-S}if(f){let S=h.scrollLeft;h.scrollLeft+=f,x=h.scrollLeft-S}e={left:e.left-x,top:e.top-b,right:e.right-x,bottom:e.bottom-b},x&&Math.abs(x-f)<1&&(n="nearest"),b&&Math.abs(b-g)<1&&(r="nearest")}if(u)break;h=h.assignedSlot||h.parentNode}else if(h.nodeType==11)h=h.host;else break}function Xb(i){let e=i.ownerDocument;for(let t=i.parentNode;t&&t!=e.body;)if(t.nodeType==1){if(t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth)return t;t=t.assignedSlot||t.parentNode}else if(t.nodeType==11)t=t.host;else break;return null}class Yb{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:n}=e;this.set(t,Math.min(e.anchorOffset,t?tn(t):0),n,Math.min(e.focusOffset,n?tn(n):0))}set(e,t,n,r){this.anchorNode=e,this.anchorOffset=t,this.focusNode=n,this.focusOffset=r}}let Ln=null;function of(i){if(i.setActive)return i.setActive();if(Ln)return i.focus(Ln);let e=[];for(let t=i;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(i.focus(Ln==null?{get preventScroll(){return Ln={preventScroll:!0},!0}}:void 0),!Ln){Ln=!1;for(let t=0;t<e.length;){let n=e[t++],r=e[t++],o=e[t++];n.scrollTop!=r&&(n.scrollTop=r),n.scrollLeft!=o&&(n.scrollLeft=o)}}}let nh;function Zn(i,e,t=e){let n=nh||(nh=document.createRange());return n.setEnd(i,t),n.setStart(i,e),n}function Kn(i,e,t){let n={key:e,code:e,keyCode:t,which:t,cancelable:!0},r=new KeyboardEvent("keydown",n);r.synthetic=!0,i.dispatchEvent(r);let o=new KeyboardEvent("keyup",n);return o.synthetic=!0,i.dispatchEvent(o),r.defaultPrevented||o.defaultPrevented}function Jb(i){for(;i;){if(i&&(i.nodeType==9||i.nodeType==11&&i.host))return i;i=i.assignedSlot||i.parentNode}return null}function sf(i){for(;i.attributes.length;)i.removeAttributeNode(i.attributes[0])}function Zb(i,e){let t=e.focusNode,n=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=n)return!1;for(n=Math.min(n,tn(t));;)if(n){if(t.nodeType!=1)return!1;let r=t.childNodes[n-1];r.contentEditable=="false"?n--:(t=r,n=tn(t))}else{if(t==i)return!0;n=Qo(t),t=t.parentNode}}class pt{constructor(e,t,n=!0){this.node=e,this.offset=t,this.precise=n}static before(e,t){return new pt(e.parentNode,Qo(e),t)}static after(e,t){return new pt(e.parentNode,Qo(e)+1,t)}}const Ba=[];class Fe{constructor(){this.parent=null,this.dom=null,this.dirty=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let n of this.children){if(n==e)return t;t+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.dirty&2){let n=this.dom,r=null,o;for(let s of this.children){if(s.dirty){if(!s.dom&&(o=r?r.nextSibling:n.firstChild)){let l=Fe.get(o);(!l||!l.parent&&l.canReuseDOM(s))&&s.reuseDOM(o)}s.sync(e,t),s.dirty=0}if(o=r?r.nextSibling:n.firstChild,t&&!t.written&&t.node==n&&o!=s.dom&&(t.written=!0),s.dom.parentNode==n)for(;o&&o!=s.dom;)o=rh(o);else n.insertBefore(s.dom,o);r=s.dom}for(o=r?r.nextSibling:n.firstChild,o&&t&&t.node==n&&(t.written=!0);o;)o=rh(o)}else if(this.dirty&1)for(let n of this.children)n.dirty&&(n.sync(e,t),n.dirty=0)}reuseDOM(e){}localPosFromDOM(e,t){let n;if(e==this.dom)n=this.dom.childNodes[t];else{let r=tn(e)==0?0:t==0?-1:1;for(;;){let o=e.parentNode;if(o==this.dom)break;r==0&&o.firstChild!=o.lastChild&&(e==o.firstChild?r=-1:r=1),e=o}r<0?n=e:n=e.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!Fe.get(n);)n=n.nextSibling;if(!n)return this.length;for(let r=0,o=0;;r++){let s=this.children[r];if(s.dom==n)return o;o+=s.length+s.breakAfter}}domBoundsAround(e,t,n=0){let r=-1,o=-1,s=-1,l=-1;for(let a=0,c=n,h=n;a<this.children.length;a++){let d=this.children[a],u=c+d.length;if(c<e&&u>t)return d.domBoundsAround(e,t,c);if(u>=e&&r==-1&&(r=a,o=c),c>t&&d.dom.parentNode==this.dom){s=a,l=h;break}h=u,c=u+d.breakAfter}return{from:o,to:l<0?n+this.length:l,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:s<this.children.length&&s>=0?this.children[s].dom:null}}markDirty(e=!1){this.dirty|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.dirty|=2),t.dirty&1)return;t.dirty|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.dirty&&this.markParentsDirty(!0))}setDOM(e){this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,n=Ba){this.markDirty();for(let r=e;r<t;r++){let o=this.children[r];o.parent==this&&o.destroy()}this.children.splice(e,t-e,...n);for(let r=0;r<n.length;r++)n[r].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new lf(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,n,r,o,s){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor}getSide(){return 0}destroy(){this.parent=null}}Fe.prototype.breakAfter=0;function rh(i){let e=i.nextSibling;return i.parentNode.removeChild(i),e}class lf{constructor(e,t,n){this.children=e,this.pos=t,this.i=n,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}}function af(i,e,t,n,r,o,s,l,a){let{children:c}=i,h=c.length?c[e]:null,d=o.length?o[o.length-1]:null,u=d?d.breakAfter:s;if(!(e==n&&h&&!s&&!u&&o.length<2&&h.merge(t,r,o.length?d:null,t==0,l,a))){if(n<c.length){let f=c[n];f&&r<f.length?(e==n&&(f=f.split(r),r=0),!u&&d&&f.merge(0,r,d,!0,0,a)?o[o.length-1]=f:(r&&f.merge(0,r,null,!1,0,a),o.push(f))):f!=null&&f.breakAfter&&(d?d.breakAfter=1:s=1),n++}for(h&&(h.breakAfter=s,t>0&&(!s&&o.length&&h.merge(t,h.length,o[0],!1,l,0)?h.breakAfter=o.shift().breakAfter:(t<h.length||h.children.length&&h.children[h.children.length-1].length==0)&&h.merge(t,h.length,null,!1,l,0),e++));e<n&&o.length;)if(c[n-1].become(o[o.length-1]))n--,o.pop(),a=o.length?0:l;else if(c[e].become(o[0]))e++,o.shift(),l=o.length?0:a;else break;!o.length&&e&&n<c.length&&!c[e-1].breakAfter&&c[n].merge(0,0,c[e-1],!1,l,a)&&e--,(e<n||o.length)&&i.replaceChildren(e,n,o)}}function cf(i,e,t,n,r,o){let s=i.childCursor(),{i:l,off:a}=s.findPos(t,1),{i:c,off:h}=s.findPos(e,-1),d=e-t;for(let u of n)d+=u.length;i.length+=d,af(i,c,h,l,a,n,0,r,o)}let Ut=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},Hl=typeof document<"u"?document:{documentElement:{style:{}}};const jl=/Edge\/(\d+)/.exec(Ut.userAgent),hf=/MSIE \d/.test(Ut.userAgent),Wl=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ut.userAgent),Ps=!!(hf||Wl||jl),oh=!Ps&&/gecko\/(\d+)/i.test(Ut.userAgent),nl=!Ps&&/Chrome\/(\d+)/.exec(Ut.userAgent),sh="webkitFontSmoothing"in Hl.documentElement.style,df=!Ps&&/Apple Computer/.test(Ut.vendor),lh=df&&(/Mobile\/\w+/.test(Ut.userAgent)||Ut.maxTouchPoints>2);var ce={mac:lh||/Mac/.test(Ut.platform),windows:/Win/.test(Ut.platform),linux:/Linux|X11/.test(Ut.platform),ie:Ps,ie_version:hf?Hl.documentMode||6:Wl?+Wl[1]:jl?+jl[1]:0,gecko:oh,gecko_version:oh?+(/Firefox\/(\d+)/.exec(Ut.userAgent)||[0,0])[1]:0,chrome:!!nl,chrome_version:nl?+nl[1]:0,ios:lh,android:/Android\b/.test(Ut.userAgent),webkit:sh,safari:df,webkit_version:sh?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:Hl.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const Qb=256;class wn extends Fe{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,n){return n&&(!(n instanceof wn)||this.length-(t-e)+n.length>Qb)?!1:(this.text=this.text.slice(0,e)+(n?n.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new wn(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new pt(this.dom,e)}domBoundsAround(e,t,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return Vl(this.dom,e,t)}}class Bi extends Fe{constructor(e,t=[],n=0){super(),this.mark=e,this.children=t,this.length=n;for(let r of t)r.setParent(this)}setAttrs(e){if(sf(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.dirty|=6)}sync(e,t){this.dom?this.dirty&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,n,r,o,s){return n&&(!(n instanceof Bi&&n.mark.eq(this.mark))||e&&o<=0||t<this.length&&s<=0)?!1:(cf(this,e,t,n?n.children:[],o-1,s-1),this.markDirty(),!0)}split(e){let t=[],n=0,r=-1,o=0;for(let l of this.children){let a=n+l.length;a>e&&t.push(n<e?l.split(e-n):l),r<0&&n>=e&&(r=o),n=a,o++}let s=this.length-e;return this.length=e,r>-1&&(this.children.length=r,this.markDirty()),new Bi(this.mark,t,s)}domAtPos(e){return mf(this,e)}coordsAt(e,t){return bf(this,e,t)}}function Vl(i,e,t){let n=i.nodeValue.length;e>n&&(e=n);let r=e,o=e,s=0;e==0&&t<0||e==n&&t>=0?ce.chrome||ce.gecko||(e?(r--,s=1):o<n&&(o++,s=-1)):t<0?r--:o<n&&o++;let l=Zn(i,r,o).getClientRects();if(!l.length)return null;let a=l[(s?s<0:t>=0)?0:l.length-1];return ce.safari&&!s&&a.width==0&&(a=Array.prototype.find.call(l,c=>c.width)||a),s?La(a,s<0):a||null}class qi extends Fe{static create(e,t,n){return new(e.customView||qi)(e,t,n)}constructor(e,t,n){super(),this.widget=e,this.length=t,this.side=n,this.prevWidget=null}split(e){let t=qi.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}getSide(){return this.side}merge(e,t,n,r,o,s){return n&&(!(n instanceof qi)||!this.widget.compare(n.widget)||e>0&&o<=0||t<this.length&&s<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}become(e){return e instanceof qi&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return Le.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,n=t&&t.state.doc,r=this.posAtStart;return n?n.slice(r,r+this.length):Le.empty}domAtPos(e){return(this.length?e==0:this.side>0)?pt.before(this.dom):pt.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let n=this.widget.coordsAt(this.dom,e,t);if(n)return n;let r=this.dom.getClientRects(),o=null;if(!r.length)return null;for(let s=e>0?r.length-1:0;o=r[s],!(e>0?s==0:s==r.length-1||o.top<o.bottom);s+=e>0?-1:1);return this.length?o:La(o,this.side>0)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class uf extends qi{domAtPos(e){let{topView:t,text:n}=this.widget;return t?Ul(e,0,t,n,this.length-t.length,(r,o)=>r.domAtPos(o),(r,o)=>new pt(r,Math.min(o,r.nodeValue.length))):new pt(n,Math.min(e,n.nodeValue.length))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(e,t){let{topView:n,text:r}=this.widget;return n?pf(e,t,n,r,this.length-n.length):Math.min(t,this.length)}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(e,t){let{topView:n,text:r}=this.widget;return n?Ul(e,t,n,r,this.length-n.length,(o,s,l)=>o.coordsAt(s,l),(o,s,l)=>Vl(o,s,l)):Vl(r,e,t)}destroy(){var e;super.destroy(),(e=this.widget.topView)===null||e===void 0||e.destroy()}get isEditable(){return!0}canReuseDOM(){return!0}}function Ul(i,e,t,n,r,o,s){if(t instanceof Bi){for(let l=t.dom.firstChild;l;l=l.nextSibling){let a=Fe.get(l);if(a){let c=Jn(l,n),h=a.length+(c?r:0);if(i<h||i==h&&a.getSide()<=0)return c?Ul(i,e,a,n,r,o,s):o(a,i,e);i-=h}else{let c=ff(i,e,l,s);if(typeof c!="number")return c;i=c}}return o(t,t.length,-1)}else return t.dom==n?s(n,i,e):o(t,i,e)}function ff(i,e,t,n){if(t.nodeType==3){let r=t.nodeValue.length;if(i<=r)return n(t,i,e);i-=r}else if(t.nodeType==1&&t.contentEditable!="false")for(let r=t.firstChild;r;r=r.nextSibling){let o=ff(i,e,r,n);if(typeof o!="number")return o;i=o}return i}function pf(i,e,t,n,r){if(t instanceof Bi){let o=0;for(let s=t.dom.firstChild;s;s=s.nextSibling){let l=Fe.get(s);if(l){let a=Jn(s,n);if(Jn(s,i))return o+(a?pf(i,e,l,n,r):l.localPosFromDOM(i,e));o+=l.length+(a?r:0)}else{let a=gf(i,e,s);if(a.result!=null)return o+a.result;o+=a.size}}}else if(t.dom==n)return Math.min(e,n.nodeValue.length);return t.localPosFromDOM(i,e)}function gf(i,e,t){if(t.nodeType==3)return i==t?{result:e}:{size:t.nodeValue.length};if(t.nodeType==1&&t.contentEditable!="false"){let n=0;for(let r=t.firstChild,o=0;;r=r.nextSibling,o++){if(i==t&&o==e)return{result:n};if(!r)return{size:n};let s=gf(i,e,r);if(s.result!=null)return{result:e+s.result};n+=s.size}}else return t.contains(i)?{result:0}:{size:0}}class Qn extends Fe{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Qn&&e.side==this.side}split(){return new Qn(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?pt.before(this.dom):pt.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return Le.empty}get isHidden(){return!0}}wn.prototype.children=qi.prototype.children=Qn.prototype.children=Ba;function mf(i,e){let t=i.dom,{children:n}=i,r=0;for(let o=0;r<n.length;r++){let s=n[r],l=o+s.length;if(!(l==o&&s.getSide()<=0)){if(e>o&&e<l&&s.dom.parentNode==t)return s.domAtPos(e-o);if(e<=o)break;o=l}}for(let o=r;o>0;o--){let s=n[o-1];if(s.dom.parentNode==t)return s.domAtPos(s.length)}for(let o=r;o<n.length;o++){let s=n[o];if(s.dom.parentNode==t)return s.domAtPos(0)}return new pt(t,0)}function vf(i,e,t){let n,{children:r}=i;t>0&&e instanceof Bi&&r.length&&(n=r[r.length-1])instanceof Bi&&n.mark.eq(e.mark)?vf(n,e.children[0],t-1):(r.push(e),e.setParent(i)),i.length+=e.length}function bf(i,e,t){let n=null,r=-1,o=null,s=-1;function l(c,h){for(let d=0,u=0;d<c.children.length&&u<=h;d++){let f=c.children[d],g=u+f.length;g>=h&&(f.children.length?l(f,h-u):(!o||o.isHidden&&t>0)&&(g>h||u==g&&f.getSide()>0)?(o=f,s=h-u):(u<h||u==g&&f.getSide()<0&&!f.isHidden)&&(n=f,r=h-u)),u=g}}l(i,e);let a=(t<0?n:o)||n||o;return a?a.coordsAt(Math.max(0,a==n?r:s),t):ey(i)}function ey(i){let e=i.dom.lastChild;if(!e)return i.dom.getBoundingClientRect();let t=Vr(e);return t[t.length-1]||null}function Kl(i,e){for(let t in i)t=="class"&&e.class?e.class+=" "+i.class:t=="style"&&e.style?e.style+=";"+i.style:e[t]=i[t];return e}function Ea(i,e){if(i==e)return!0;if(!i||!e)return!1;let t=Object.keys(i),n=Object.keys(e);if(t.length!=n.length)return!1;for(let r of t)if(n.indexOf(r)==-1||i[r]!==e[r])return!1;return!0}function ql(i,e,t){let n=null;if(e)for(let r in e)t&&r in t||i.removeAttribute(n=r);if(t)for(let r in t)e&&e[r]==t[r]||i.setAttribute(n=r,t[r]);return!!n}class rn{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}ignoreEvent(e){return!0}coordsAt(e,t,n){return null}get customView(){return null}get isHidden(){return!1}destroy(e){}}var Je=function(i){return i[i.Text=0]="Text",i[i.WidgetBefore=1]="WidgetBefore",i[i.WidgetAfter=2]="WidgetAfter",i[i.WidgetRange=3]="WidgetRange",i}(Je||(Je={}));class be extends yn{constructor(e,t,n,r){super(),this.startSide=e,this.endSide=t,this.widget=n,this.spec=r}get heightRelevant(){return!1}static mark(e){return new Ls(e)}static widget(e){let t=e.side||0,n=!!e.block;return t+=n?t>0?3e8:-4e8:t>0?1e8:-1e8,new xn(e,t,t,n,e.widget||null,!1)}static replace(e){let t=!!e.block,n,r;if(e.isBlockGap)n=-5e8,r=4e8;else{let{start:o,end:s}=yf(e,t);n=(o?t?-3e8:-1:5e8)-1,r=(s?t?2e8:1:-6e8)+1}return new xn(e,n,r,t,e.widget||null,!0)}static line(e){return new to(e)}static set(e,t=!1){return Be.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}be.none=Be.empty;class Ls extends be{constructor(e){let{start:t,end:n}=yf(e);super(t?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){return this==e||e instanceof Ls&&this.tagName==e.tagName&&this.class==e.class&&Ea(this.attrs,e.attrs)}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}Ls.prototype.point=!1;class to extends be{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof to&&this.spec.class==e.spec.class&&Ea(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}to.prototype.mapMode=St.TrackBefore;to.prototype.point=!0;class xn extends be{constructor(e,t,n,r,o,s){super(t,n,o,e),this.block=r,this.isReplace=s,this.mapMode=r?t<=0?St.TrackBefore:St.TrackAfter:St.TrackDel}get type(){return this.startSide<this.endSide?Je.WidgetRange:this.startSide<=0?Je.WidgetBefore:Je.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(e){return e instanceof xn&&ty(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}xn.prototype.point=!0;function yf(i,e=!1){let{inclusiveStart:t,inclusiveEnd:n}=i;return t==null&&(t=i.inclusive),n==null&&(n=i.inclusive),{start:t??e,end:n??e}}function ty(i,e){return i==e||!!(i&&e&&i.compare(e))}function _l(i,e,t,n=0){let r=t.length-1;r>=0&&t[r]+n>=i?t[r]=Math.max(t[r],e):t.push(i,e)}class Rt extends Fe{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,n,r,o,s){if(n){if(!(n instanceof Rt))return!1;this.dom||n.transferDOM(this)}return r&&this.setDeco(n?n.attrs:null),cf(this,e,t,n?n.children:[],o,s),!0}split(e){let t=new Rt;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i:n,off:r}=this.childPos(e);r&&(t.append(this.children[n].split(r),0),this.children[n].merge(r,this.children[n].length,null,!1,0,0),n++);for(let o=n;o<this.children.length;o++)t.append(this.children[o],0);for(;n>0&&this.children[n-1].length==0;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){Ea(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){vf(this,e,t)}addLineDeco(e){let t=e.spec.attributes,n=e.spec.class;t&&(this.attrs=Kl(t,this.attrs||{})),n&&(this.attrs=Kl({class:n},this.attrs||{}))}domAtPos(e){return mf(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.dirty|=6)}sync(e,t){var n;this.dom?this.dirty&4&&(sf(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(ql(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let r=this.dom.lastChild;for(;r&&Fe.get(r)instanceof Bi;)r=r.lastChild;if(!r||!this.length||r.nodeName!="BR"&&((n=Fe.get(r))===null||n===void 0?void 0:n.isEditable)==!1&&(!ce.ios||!this.children.some(o=>o instanceof wn))){let o=document.createElement("BR");o.cmIgnore=!0,this.dom.appendChild(o)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let n of this.children){if(!(n instanceof wn)||/[^ -~]/.test(n.text))return null;let r=Vr(n.dom);if(r.length!=1)return null;e+=r[0].width,t=r[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let n=bf(this,e,t);if(!this.children.length&&n&&this.parent){let{heightOracle:r}=this.parent.view.viewState,o=n.bottom-n.top;if(Math.abs(o-r.lineHeight)<2&&r.textHeight<o){let s=(o-r.textHeight)/2;return{top:n.top+s,bottom:n.bottom-s,left:n.left,right:n.left}}}return n}become(e){return!1}get type(){return Je.Text}static find(e,t){for(let n=0,r=0;n<e.children.length;n++){let o=e.children[n],s=r+o.length;if(s>=t){if(o instanceof Rt)return o;if(s>t)break}r=s+o.breakAfter}return null}}class gn extends Fe{constructor(e,t,n){super(),this.widget=e,this.length=t,this.type=n,this.breakAfter=0,this.prevWidget=null}merge(e,t,n,r,o,s){return n&&(!(n instanceof gn)||!this.widget.compare(n.widget)||e>0&&o<=0||t<this.length&&s<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?pt.before(this.dom):pt.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let n=new gn(this.widget,t,this.type);return n.breakAfter=this.breakAfter,n}get children(){return Ba}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Le.empty}domBoundsAround(){return null}become(e){return e instanceof gn&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.type=e.type,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){return this.widget.coordsAt(this.dom,e,t)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Ia{constructor(e,t,n,r){this.doc=e,this.pos=t,this.end=n,this.disallowBlockEffectsFor=r,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!e.breakAfter&&!(e instanceof gn&&e.type==Je.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new Rt),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(vo(new Qn(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||this.getLine()}buildText(e,t,n){for(;e>0;){if(this.textOff==this.text.length){let{value:o,lineBreak:s,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(s){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=o,this.textOff=0}let r=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-n)),this.getLine().append(vo(new wn(this.text.slice(this.textOff,this.textOff+r)),t),n),this.atCursorPos=!0,this.textOff+=r,e-=r,n=0}}span(e,t,n,r){this.buildText(t-e,n,r),this.pos=t,this.openStart<0&&(this.openStart=r)}point(e,t,n,r,o,s){if(this.disallowBlockEffectsFor[s]&&n instanceof xn){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let l=t-e;if(n instanceof xn)if(n.block){let{type:a}=n;a==Je.WidgetAfter&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new gn(n.widget||new ah("div"),l,a))}else{let a=qi.create(n.widget||new ah("span"),l,l?0:n.startSide),c=this.atCursorPos&&!a.isEditable&&o<=r.length&&(e<t||n.startSide>0),h=!a.isEditable&&(e<t||o>r.length||n.startSide<=0),d=this.getLine();this.pendingBuffer==2&&!c&&!a.isEditable&&(this.pendingBuffer=0),this.flushBuffer(r),c&&(d.append(vo(new Qn(1),r),o),o=r.length+Math.max(0,o-r.length)),d.append(vo(a,r),o),this.atCursorPos=h,this.pendingBuffer=h?e<t||o>r.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=r.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);l&&(this.textOff+l<=this.text.length?this.textOff+=l:(this.skip+=l-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=o)}static build(e,t,n,r,o){let s=new Ia(e,t,n,o);return s.openEnd=Be.spans(r,t,n,s),s.openStart<0&&(s.openStart=s.openEnd),s.finish(s.openEnd),s}}function vo(i,e){for(let t of e)i=new Bi(t,[i],i.length);return i}class ah extends rn{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}const wf=de.define(),xf=de.define(),kf=de.define(),Cf=de.define(),Gl=de.define(),Sf=de.define(),Af=de.define(),Rf=de.define({combine:i=>i.some(e=>e)}),Mf=de.define({combine:i=>i.some(e=>e)});class es{constructor(e,t="nearest",n="nearest",r=5,o=5){this.range=e,this.y=t,this.x=n,this.yMargin=r,this.xMargin=o}map(e){return e.empty?this:new es(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin)}}const ch=Ce.define({map:(i,e)=>i.map(e)});function Qt(i,e,t){let n=i.facet(Cf);n.length?n[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const Bs=de.define({combine:i=>i.length?i[0]:!0});let iy=0;const Ar=de.define();class ht{constructor(e,t,n,r){this.id=e,this.create=t,this.domEventHandlers=n,this.extension=r(this)}static define(e,t){const{eventHandlers:n,provide:r,decorations:o}=t||{};return new ht(iy++,e,n,s=>{let l=[Ar.of(s)];return o&&l.push(Ur.of(a=>{let c=a.plugin(s);return c?o(c):be.none})),r&&l.push(r(s)),l})}static fromClass(e,t){return ht.define(n=>new e(n),t)}}class rl{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(n){if(Qt(t.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){Qt(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(n){Qt(e.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const Of=de.define(),Na=de.define(),Ur=de.define(),za=de.define(),Df=de.define();function Tf(i){let e=0,t=0,n=0,r=0;for(let o of i.state.facet(Df)){let s=o(i);s&&(s.left!=null&&(e=Math.max(e,s.left)),s.right!=null&&(t=Math.max(t,s.right)),s.top!=null&&(n=Math.max(n,s.top)),s.bottom!=null&&(r=Math.max(r,s.bottom)))}return{left:e,right:t,top:n,bottom:r}}const Rr=de.define();class Si{constructor(e,t,n,r){this.fromA=e,this.toA=t,this.fromB=n,this.toB=r}join(e){return new Si(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,n=this;for(;t>0;t--){let r=e[t-1];if(!(r.fromA>n.toA)){if(r.toA<n.fromA)break;n=n.join(r),e.splice(t-1,1)}}return e.splice(t,0,n),e}static extendWithRanges(e,t){if(t.length==0)return e;let n=[];for(let r=0,o=0,s=0,l=0;;r++){let a=r==e.length?null:e[r],c=s-l,h=a?a.fromB:1e9;for(;o<t.length&&t[o]<h;){let d=t[o],u=t[o+1],f=Math.max(l,d),g=Math.min(h,u);if(f<=g&&new Si(f+c,g+c,f,g).addToSet(n),u>h)break;o+=2}if(!a)return n;new Si(a.fromA,a.toA,a.fromB,a.toB).addToSet(n),s=a.toA,l=a.toB}}}class ts{constructor(e,t,n){this.view=e,this.state=t,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=lt.empty(this.startState.doc.length);for(let o of n)this.changes=this.changes.compose(o.changes);let r=[];this.changes.iterChangedRanges((o,s,l,a)=>r.push(new Si(o,s,l,a))),this.changedRanges=r}static create(e,t,n){return new ts(e,t,n)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var Ge=function(i){return i[i.LTR=0]="LTR",i[i.RTL=1]="RTL",i}(Ge||(Ge={}));const Xl=Ge.LTR,ny=Ge.RTL;function Pf(i){let e=[];for(let t=0;t<i.length;t++)e.push(1<<+i[t]);return e}const ry=Pf("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),oy=Pf("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Yl=Object.create(null),fi=[];for(let i of["()","[]","{}"]){let e=i.charCodeAt(0),t=i.charCodeAt(1);Yl[e]=t,Yl[t]=-e}function sy(i){return i<=247?ry[i]:1424<=i&&i<=1524?2:1536<=i&&i<=1785?oy[i-1536]:1774<=i&&i<=2220?4:8192<=i&&i<=8203?256:64336<=i&&i<=65023?4:i==8204?256:1}const ly=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class qn{get dir(){return this.level%2?ny:Xl}constructor(e,t,n){this.from=e,this.to=t,this.level=n}side(e,t){return this.dir==t==e?this.to:this.from}static find(e,t,n,r){let o=-1;for(let s=0;s<e.length;s++){let l=e[s];if(l.from<=t&&l.to>=t){if(l.level==n)return s;(o<0||(r!=0?r<0?l.from<t:l.to>t:e[o].level>l.level))&&(o=s)}}if(o<0)throw new RangeError("Index out of range");return o}}const Ke=[];function ay(i,e){let t=i.length,n=e==Xl?1:2,r=e==Xl?2:1;if(!i||n==1&&!ly.test(i))return Lf(t);for(let s=0,l=n,a=n;s<t;s++){let c=sy(i.charCodeAt(s));c==512?c=l:c==8&&a==4&&(c=16),Ke[s]=c==4?2:c,c&7&&(a=c),l=c}for(let s=0,l=n,a=n;s<t;s++){let c=Ke[s];if(c==128)s<t-1&&l==Ke[s+1]&&l&24?c=Ke[s]=l:Ke[s]=256;else if(c==64){let h=s+1;for(;h<t&&Ke[h]==64;)h++;let d=s&&l==8||h<t&&Ke[h]==8?a==1?1:8:256;for(let u=s;u<h;u++)Ke[u]=d;s=h-1}else c==8&&a==1&&(Ke[s]=1);l=c,c&7&&(a=c)}for(let s=0,l=0,a=0,c,h,d;s<t;s++)if(h=Yl[c=i.charCodeAt(s)])if(h<0){for(let u=l-3;u>=0;u-=3)if(fi[u+1]==-h){let f=fi[u+2],g=f&2?n:f&4?f&1?r:n:0;g&&(Ke[s]=Ke[fi[u]]=g),l=u;break}}else{if(fi.length==189)break;fi[l++]=s,fi[l++]=c,fi[l++]=a}else if((d=Ke[s])==2||d==1){let u=d==n;a=u?0:1;for(let f=l-3;f>=0;f-=3){let g=fi[f+2];if(g&2)break;if(u)fi[f+2]|=2;else{if(g&4)break;fi[f+2]|=4}}}for(let s=0;s<t;s++)if(Ke[s]==256){let l=s+1;for(;l<t&&Ke[l]==256;)l++;let a=(s?Ke[s-1]:n)==1,c=(l<t?Ke[l]:n)==1,h=a==c?a?1:2:n;for(let d=s;d<l;d++)Ke[d]=h;s=l-1}let o=[];if(n==1)for(let s=0;s<t;){let l=s,a=Ke[s++]!=1;for(;s<t&&a==(Ke[s]!=1);)s++;if(a)for(let c=s;c>l;){let h=c,d=Ke[--c]!=2;for(;c>l&&d==(Ke[c-1]!=2);)c--;o.push(new qn(c,h,d?2:1))}else o.push(new qn(l,s,0))}else for(let s=0;s<t;){let l=s,a=Ke[s++]==2;for(;s<t&&a==(Ke[s]==2);)s++;o.push(new qn(l,s,a?1:2))}return o}function Lf(i){return[new qn(0,i,0)]}let Bf="";function cy(i,e,t,n,r){var o;let s=n.head-i.from,l=-1;if(s==0){if(!r||!i.length)return null;e[0].level!=t&&(s=e[0].side(!1,t),l=0)}else if(s==i.length){if(r)return null;let u=e[e.length-1];u.level!=t&&(s=u.side(!0,t),l=e.length-1)}l<0&&(l=qn.find(e,s,(o=n.bidiLevel)!==null&&o!==void 0?o:-1,n.assoc));let a=e[l];s==a.side(r,t)&&(a=e[l+=r?1:-1],s=a.side(!r,t));let c=r==(a.dir==t),h=At(i.text,s,c);if(Bf=i.text.slice(Math.min(s,h),Math.max(s,h)),h!=a.side(r,t))return z.cursor(h+i.from,c?-1:1,a.level);let d=l==(r?e.length-1:0)?null:e[l+(r?1:-1)];return!d&&a.level!=t?z.cursor(r?i.to:i.from,r?-1:1,t):d&&d.level<a.level?z.cursor(d.side(!r,t)+i.from,r?1:-1,d.level):z.cursor(h+i.from,r?-1:1,a.level)}const Fn="￿";class Ef{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(Te.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Fn}readRange(e,t){if(!e)return this;let n=e.parentNode;for(let r=e;;){this.findPointBefore(n,r);let o=this.text.length;this.readNode(r);let s=r.nextSibling;if(s==t)break;let l=Fe.get(r),a=Fe.get(s);(l&&a?l.breakAfter:(l?l.breakAfter:hh(r))||hh(s)&&(r.nodeName!="BR"||r.cmIgnore)&&this.text.length>o)&&this.lineBreak(),r=s}return this.findPointBefore(n,t),this}readTextNode(e){let t=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,t.length));for(let n=0,r=this.lineSeparator?null:/\r\n?|\n/g;;){let o=-1,s=1,l;if(this.lineSeparator?(o=t.indexOf(this.lineSeparator,n),s=this.lineSeparator.length):(l=r.exec(t))&&(o=l.index,s=l[0].length),this.append(t.slice(n,o<0?t.length:o)),o<0)break;if(this.lineBreak(),s>1)for(let a of this.points)a.node==e&&a.pos>this.text.length&&(a.pos-=s-1);n=o+s}}readNode(e){if(e.cmIgnore)return;let t=Fe.get(e),n=t&&t.overrideDOMText;if(n!=null){this.findPointInside(e,n.length);for(let r=n.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==t&&(n.pos=this.text.length)}findPointInside(e,t){for(let n of this.points)(e.nodeType==3?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+Math.min(t,n.offset))}}function hh(i){return i.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(i.nodeName)}class dh{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class uh extends Fe{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.compositionDeco=be.none,this.decorations=[],this.dynamicDecorationMap=[],this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Rt],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Si(0,0,0,e.state.doc.length)],0)}update(e){let t=e.changedRanges;this.minWidth>0&&t.length&&(t.every(({fromA:s,toA:l})=>l<this.minWidthFrom||s>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=be.none:(e.transactions.length||this.dirty)&&(this.compositionDeco=dy(this.view,e.changes)),(ce.ie||ce.chrome)&&!this.compositionDeco.size&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let n=this.decorations,r=this.updateDeco(),o=gy(n,r,e.changes);return t=Si.extendWithRanges(t,o),this.dirty==0&&t.length==0?!1:(this.updateInner(t,e.startState.doc.length),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t);let{observer:n}=this.view;n.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=ce.chrome||ce.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.dirty=0,o&&(o.written||n.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""});let r=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof gn&&o.widget instanceof fh&&r.push(o.dom);n.updateGaps(r)}updateChildren(e,t){let n=this.childCursor(t);for(let r=e.length-1;;r--){let o=r>=0?e[r]:null;if(!o)break;let{fromA:s,toA:l,fromB:a,toB:c}=o,{content:h,breakAtStart:d,openStart:u,openEnd:f}=Ia.build(this.view.state.doc,a,c,this.decorations,this.dynamicDecorationMap),{i:g,off:x}=n.findPos(l,1),{i:b,off:S}=n.findPos(s,-1);af(this,b,S,g,x,h,d,u,f)}}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,r=n==this.dom,o=!r&&zo(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(r||t||o))return;let s=this.forceSelection;this.forceSelection=!1;let l=this.view.state.selection.main,a=this.domAtPos(l.anchor),c=l.empty?a:this.domAtPos(l.head);if(ce.gecko&&l.empty&&!this.compositionDeco.size&&hy(a)){let d=document.createTextNode("");this.view.observer.ignore(()=>a.node.insertBefore(d,a.node.childNodes[a.offset]||null)),a=c=new pt(d,0),s=!0}let h=this.view.observer.selectionRange;(s||!h.focusNode||!Zo(a.node,a.offset,h.anchorNode,h.anchorOffset)||!Zo(c.node,c.offset,h.focusNode,h.focusOffset))&&(this.view.observer.ignore(()=>{ce.android&&ce.chrome&&this.dom.contains(h.focusNode)&&my(h.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let d=Jo(this.view.root);if(d)if(l.empty){if(ce.gecko){let u=fy(a.node,a.offset);if(u&&u!=3){let f=Nf(a.node,a.offset,u==1?1:-1);f&&(a=new pt(f,u==1?0:f.nodeValue.length))}}d.collapse(a.node,a.offset),l.bidiLevel!=null&&h.cursorBidiLevel!=null&&(h.cursorBidiLevel=l.bidiLevel)}else if(d.extend){d.collapse(a.node,a.offset);try{d.extend(c.node,c.offset)}catch{}}else{let u=document.createRange();l.anchor>l.head&&([a,c]=[c,a]),u.setEnd(c.node,c.offset),u.setStart(a.node,a.offset),d.removeAllRanges(),d.addRange(u)}o&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(a,c)),this.impreciseAnchor=a.precise?null:new pt(h.anchorNode,h.anchorOffset),this.impreciseHead=c.precise?null:new pt(h.focusNode,h.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let{view:e}=this,t=e.state.selection.main,n=Jo(e.root),{anchorNode:r,anchorOffset:o}=e.observer.selectionRange;if(!n||!t.empty||!t.assoc||!n.modify)return;let s=Rt.find(this,t.head);if(!s)return;let l=s.posAtStart;if(t.head==l||t.head==l+s.length)return;let a=this.coordsAt(t.head,-1),c=this.coordsAt(t.head,1);if(!a||!c||a.bottom>c.top)return;let h=this.domAtPos(t.head+t.assoc);n.collapse(h.node,h.offset),n.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let d=e.observer.selectionRange;e.docView.posFromDOM(d.anchorNode,d.anchorOffset)!=t.from&&n.collapse(r,o)}nearest(e){for(let t=e;t;){let n=Fe.get(t);if(n&&n.rootView==this)return n;t=t.parentNode}return null}posFromDOM(e,t){let n=this.nearest(e);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,t)+n.posAtStart}domAtPos(e){let{i:t,off:n}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let r=this.children[t];if(n<r.length||r instanceof Rt)break;t++,n=0}return this.children[t].domAtPos(n)}coordsAt(e,t){for(let n=this.length,r=this.children.length-1;;r--){let o=this.children[r],s=n-o.breakAfter-o.length;if(e>s||e==s&&o.type!=Je.WidgetBefore&&o.type!=Je.WidgetAfter&&(!r||t==2||this.children[r-1].breakAfter||this.children[r-1].type==Je.WidgetBefore&&t>-2))return o.coordsAt(e-s,t);n=s}}measureVisibleLineHeights(e){let t=[],{from:n,to:r}=e,o=this.view.contentDOM.clientWidth,s=o>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,l=-1,a=this.view.textDirection==Ge.LTR;for(let c=0,h=0;h<this.children.length;h++){let d=this.children[h],u=c+d.length;if(u>r)break;if(c>=n){let f=d.dom.getBoundingClientRect();if(t.push(f.height),s){let g=d.dom.lastChild,x=g?Vr(g):[];if(x.length){let b=x[x.length-1],S=a?b.right-f.left:f.right-b.left;S>l&&(l=S,this.minWidth=o,this.minWidthFrom=c,this.minWidthTo=u)}}}c=u+d.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?Ge.RTL:Ge.LTR}measureTextSize(){for(let o of this.children)if(o instanceof Rt){let s=o.measureTextSize();if(s)return s}let e=document.createElement("div"),t,n,r;return e.className="cm-line",e.style.width="99999px",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let o=Vr(e.firstChild)[0];t=e.getBoundingClientRect().height,n=o?o.width/27:7,r=o?o.height:t,e.remove()}),{lineHeight:t,charWidth:n,textHeight:r}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new lf(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let n=0,r=0;;r++){let o=r==t.viewports.length?null:t.viewports[r],s=o?o.from-1:this.length;if(s>n){let l=t.lineBlockAt(s).bottom-t.lineBlockAt(n).top;e.push(be.replace({widget:new fh(l),block:!0,inclusive:!0,isBlockGap:!0}).range(n,s))}if(!o)break;n=o.to+1}return be.set(e)}updateDeco(){let e=this.view.state.facet(Ur).map((t,n)=>(this.dynamicDecorationMap[n]=typeof t=="function")?t(this.view):t);for(let t=e.length;t<e.length+3;t++)this.dynamicDecorationMap[t]=!1;return this.decorations=[...e,this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){let{range:t}=e,n=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),r;if(!n)return;!t.empty&&(r=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(n={left:Math.min(n.left,r.left),top:Math.min(n.top,r.top),right:Math.max(n.right,r.right),bottom:Math.max(n.bottom,r.bottom)});let o=Tf(this.view),s={left:n.left-o.left,top:n.top-o.top,right:n.right+o.right,bottom:n.bottom+o.bottom};Gb(this.view.scrollDOM,s,t.head<t.anchor?-1:1,e.x,e.y,e.xMargin,e.yMargin,this.view.textDirection==Ge.LTR)}}function hy(i){return i.node.nodeType==1&&i.node.firstChild&&(i.offset==0||i.node.childNodes[i.offset-1].contentEditable=="false")&&(i.offset==i.node.childNodes.length||i.node.childNodes[i.offset].contentEditable=="false")}class fh extends rn{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function If(i){let e=i.observer.selectionRange,t=e.focusNode&&Nf(e.focusNode,e.focusOffset,0);if(!t)return null;let n=i.docView.nearest(t);if(!n)return null;if(n instanceof Rt){let r=t;for(;r.parentNode!=n.dom;)r=r.parentNode;let o=r.previousSibling;for(;o&&!Fe.get(o);)o=o.previousSibling;let s=o?Fe.get(o).posAtEnd:n.posAtStart;return{from:s,to:s,node:r,text:t}}else{for(;;){let{parent:o}=n;if(!o)return null;if(o instanceof Rt)break;n=o}let r=n.posAtStart;return{from:r,to:r+n.length,node:n.dom,text:t}}}function dy(i,e){let t=If(i);if(!t)return be.none;let{from:n,to:r,node:o,text:s}=t,l=e.mapPos(n,1),a=Math.max(l,e.mapPos(r,-1)),{state:c}=i,h=o.nodeType==3?o.nodeValue:new Ef([],c).readRange(o.firstChild,null).text;if(h.indexOf(Fn)>-1)return be.none;if(a-l<h.length)if(c.doc.sliceString(l,Math.min(c.doc.length,l+h.length))==h)a=l+h.length;else if(c.doc.sliceString(Math.max(0,a-h.length),a)==h)l=a-h.length;else return be.none;else if(c.doc.sliceString(l,a)!=h)return be.none;let d=Fe.get(o);return d instanceof uf?d=d.widget.topView:d&&(d.parent=null),be.set(be.replace({widget:new uy(o,s,d),inclusive:!0}).range(l,a))}class uy extends rn{constructor(e,t,n){super(),this.top=e,this.text=t,this.topView=n}eq(e){return this.top==e.top&&this.text==e.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return uf}}function Nf(i,e,t){if(t<=0)for(let n=i,r=e;;){if(n.nodeType==3)return n;if(n.nodeType==1&&r>0)n=n.childNodes[r-1],r=tn(n);else break}if(t>=0)for(let n=i,r=e;;){if(n.nodeType==3)return n;if(n.nodeType==1&&r<n.childNodes.length&&t>=0)n=n.childNodes[r],r=0;else break}return null}function fy(i,e){return i.nodeType!=1?0:(e&&i.childNodes[e-1].contentEditable=="false"?1:0)|(e<i.childNodes.length&&i.childNodes[e].contentEditable=="false"?2:0)}class py{constructor(){this.changes=[]}compareRange(e,t){_l(e,t,this.changes)}comparePoint(e,t){_l(e,t,this.changes)}}function gy(i,e,t){let n=new py;return Be.compare(i,e,t,n),n.changes}function my(i,e){for(let t=i;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function vy(i,e,t=1){let n=i.charCategorizer(e),r=i.doc.lineAt(e),o=e-r.from;if(r.length==0)return z.cursor(e);o==0?t=1:o==r.length&&(t=-1);let s=o,l=o;t<0?s=At(r.text,o,!1):l=At(r.text,o);let a=n(r.text.slice(s,l));for(;s>0;){let c=At(r.text,s,!1);if(n(r.text.slice(c,s))!=a)break;s=c}for(;l<r.length;){let c=At(r.text,l);if(n(r.text.slice(l,c))!=a)break;l=c}return z.range(s+r.from,l+r.from)}function by(i,e){return e.left>i?e.left-i:Math.max(0,i-e.right)}function yy(i,e){return e.top>i?e.top-i:Math.max(0,i-e.bottom)}function ol(i,e){return i.top<e.bottom-1&&i.bottom>e.top+1}function ph(i,e){return e<i.top?{top:e,left:i.left,right:i.right,bottom:i.bottom}:i}function gh(i,e){return e>i.bottom?{top:i.top,left:i.left,right:i.right,bottom:e}:i}function Jl(i,e,t){let n,r,o,s,l=!1,a,c,h,d;for(let g=i.firstChild;g;g=g.nextSibling){let x=Vr(g);for(let b=0;b<x.length;b++){let S=x[b];r&&ol(r,S)&&(S=ph(gh(S,r.bottom),r.top));let A=by(e,S),O=yy(t,S);if(A==0&&O==0)return g.nodeType==3?mh(g,e,t):Jl(g,e,t);if(!n||s>O||s==O&&o>A){n=g,r=S,o=A,s=O;let R=O?t<S.top?-1:1:A?e<S.left?-1:1:0;l=!R||(R>0?b<x.length-1:b>0)}A==0?t>S.bottom&&(!h||h.bottom<S.bottom)?(a=g,h=S):t<S.top&&(!d||d.top>S.top)&&(c=g,d=S):h&&ol(h,S)?h=gh(h,S.bottom):d&&ol(d,S)&&(d=ph(d,S.top))}}if(h&&h.bottom>=t?(n=a,r=h):d&&d.top<=t&&(n=c,r=d),!n)return{node:i,offset:0};let u=Math.max(r.left,Math.min(r.right,e));if(n.nodeType==3)return mh(n,u,t);if(l&&n.contentEditable!="false")return Jl(n,u,t);let f=Array.prototype.indexOf.call(i.childNodes,n)+(e>=(r.left+r.right)/2?1:0);return{node:i,offset:f}}function mh(i,e,t){let n=i.nodeValue.length,r=-1,o=1e9,s=0;for(let l=0;l<n;l++){let a=Zn(i,l,l+1).getClientRects();for(let c=0;c<a.length;c++){let h=a[c];if(h.top==h.bottom)continue;s||(s=e-h.left);let d=(h.top>t?h.top-t:t-h.bottom)-1;if(h.left-1<=e&&h.right+1>=e&&d<o){let u=e>=(h.left+h.right)/2,f=u;if((ce.chrome||ce.gecko)&&Zn(i,l).getBoundingClientRect().left==h.right&&(f=!u),d<=0)return{node:i,offset:l+(f?1:0)};r=l+(f?1:0),o=d}}}return{node:i,offset:r>-1?r:s>0?i.nodeValue.length:0}}function zf(i,e,t,n=-1){var r,o;let s=i.contentDOM.getBoundingClientRect(),l=s.top+i.viewState.paddingTop,a,{docHeight:c}=i.viewState,{x:h,y:d}=e,u=d-l;if(u<0)return 0;if(u>c)return i.state.doc.length;for(let R=i.defaultLineHeight/2,k=!1;a=i.elementAtHeight(u),a.type!=Je.Text;)for(;u=n>0?a.bottom+R:a.top-R,!(u>=0&&u<=c);){if(k)return t?null:0;k=!0,n=-n}d=l+u;let f=a.from;if(f<i.viewport.from)return i.viewport.from==0?0:t?null:vh(i,s,a,h,d);if(f>i.viewport.to)return i.viewport.to==i.state.doc.length?i.state.doc.length:t?null:vh(i,s,a,h,d);let g=i.dom.ownerDocument,x=i.root.elementFromPoint?i.root:g,b=x.elementFromPoint(h,d);b&&!i.contentDOM.contains(b)&&(b=null),b||(h=Math.max(s.left+1,Math.min(s.right-1,h)),b=x.elementFromPoint(h,d),b&&!i.contentDOM.contains(b)&&(b=null));let S,A=-1;if(b&&((r=i.docView.nearest(b))===null||r===void 0?void 0:r.isEditable)!=!1){if(g.caretPositionFromPoint){let R=g.caretPositionFromPoint(h,d);R&&({offsetNode:S,offset:A}=R)}else if(g.caretRangeFromPoint){let R=g.caretRangeFromPoint(h,d);R&&({startContainer:S,startOffset:A}=R,(!i.contentDOM.contains(S)||ce.safari&&wy(S,A,h)||ce.chrome&&xy(S,A,h))&&(S=void 0))}}if(!S||!i.docView.dom.contains(S)){let R=Rt.find(i.docView,f);if(!R)return u>a.top+a.height/2?a.to:a.from;({node:S,offset:A}=Jl(R.dom,h,d))}let O=i.docView.nearest(S);if(!O)return null;if(O.isWidget&&((o=O.dom)===null||o===void 0?void 0:o.nodeType)==1){let R=O.dom.getBoundingClientRect();return e.y<R.top||e.y<=R.bottom&&e.x<=(R.left+R.right)/2?O.posAtStart:O.posAtEnd}else return O.localPosFromDOM(S,A)+O.posAtStart}function vh(i,e,t,n,r){let o=Math.round((n-e.left)*i.defaultCharacterWidth);if(i.lineWrapping&&t.height>i.defaultLineHeight*1.5){let l=Math.floor((r-t.top)/i.defaultLineHeight);o+=l*i.viewState.heightOracle.lineLength}let s=i.state.sliceDoc(t.from,t.to);return t.from+zl(s,o,i.state.tabSize)}function wy(i,e,t){let n;if(i.nodeType!=3||e!=(n=i.nodeValue.length))return!1;for(let r=i.nextSibling;r;r=r.nextSibling)if(r.nodeType!=1||r.nodeName!="BR")return!1;return Zn(i,n-1,n).getBoundingClientRect().left>t}function xy(i,e,t){if(e!=0)return!1;for(let r=i;;){let o=r.parentNode;if(!o||o.nodeType!=1||o.firstChild!=r)return!1;if(o.classList.contains("cm-line"))break;r=o}let n=i.nodeType==1?i.getBoundingClientRect():Zn(i,0,Math.max(i.nodeValue.length,1)).getBoundingClientRect();return t-n.left>5}function ky(i,e,t,n){let r=i.state.doc.lineAt(e.head),o=!n||!i.lineWrapping?null:i.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head);if(o){let a=i.dom.getBoundingClientRect(),c=i.textDirectionAt(r.from),h=i.posAtCoords({x:t==(c==Ge.LTR)?a.right-1:a.left+1,y:(o.top+o.bottom)/2});if(h!=null)return z.cursor(h,t?-1:1)}let s=Rt.find(i.docView,e.head),l=s?t?s.posAtEnd:s.posAtStart:t?r.to:r.from;return z.cursor(l,t?-1:1)}function bh(i,e,t,n){let r=i.state.doc.lineAt(e.head),o=i.bidiSpans(r),s=i.textDirectionAt(r.from);for(let l=e,a=null;;){let c=cy(r,o,s,l,t),h=Bf;if(!c){if(r.number==(t?i.state.doc.lines:1))return l;h=`
`,r=i.state.doc.line(r.number+(t?1:-1)),o=i.bidiSpans(r),c=z.cursor(t?r.from:r.to)}if(a){if(!a(h))return l}else{if(!n)return c;a=n(h)}l=c}}function Cy(i,e,t){let n=i.state.charCategorizer(e),r=n(t);return o=>{let s=n(o);return r==Ve.Space&&(r=s),r==s}}function Sy(i,e,t,n){let r=e.head,o=t?1:-1;if(r==(t?i.state.doc.length:0))return z.cursor(r,e.assoc);let s=e.goalColumn,l,a=i.contentDOM.getBoundingClientRect(),c=i.coordsAtPos(r),h=i.documentTop;if(c)s==null&&(s=c.left-a.left),l=o<0?c.top:c.bottom;else{let f=i.viewState.lineBlockAt(r);s==null&&(s=Math.min(a.right-a.left,i.defaultCharacterWidth*(r-f.from))),l=(o<0?f.top:f.bottom)+h}let d=a.left+s,u=n??i.defaultLineHeight>>1;for(let f=0;;f+=10){let g=l+(u+f)*o,x=zf(i,{x:d,y:g},!1,o);if(g<a.top||g>a.bottom||(o<0?x<r:x>r))return z.cursor(x,e.assoc,void 0,s)}}function Fo(i,e,t){for(;;){let n=0;for(let r of i)r.between(e-1,e+1,(o,s,l)=>{if(e>o&&e<s){let a=n||t||(e-o<s-e?-1:1);e=a<0?o:s,n=a}});if(!n)return e}}function sl(i,e,t){let n=Fo(i.state.facet(za).map(r=>r(i)),t.from,e.head>t.from?-1:1);return n==t.from?t:z.cursor(n,n<t.from?1:-1)}class Ay{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null;let t=(n,r)=>{this.ignoreDuringComposition(r)||r.type=="keydown"&&this.keydown(e,r)||(this.mustFlushObserver(r)&&e.observer.forceFlush(),this.runCustomHandlers(r.type,e,r)?r.preventDefault():n(e,r))};for(let n in nt){let r=nt[n];e.contentDOM.addEventListener(n,o=>{yh(e,o)&&t(r,o)},Zl[n]),this.registeredEvents.push(n)}e.scrollDOM.addEventListener("mousedown",n=>{if(n.target==e.scrollDOM&&n.clientY>e.contentDOM.getBoundingClientRect().bottom&&(t(nt.mousedown,n),!n.defaultPrevented&&n.button==2)){let r=e.contentDOM.style.minHeight;e.contentDOM.style.minHeight="100%",setTimeout(()=>e.contentDOM.style.minHeight=r,200)}}),e.scrollDOM.addEventListener("drop",n=>{n.target==e.scrollDOM&&n.clientY>e.contentDOM.getBoundingClientRect().bottom&&t(nt.drop,n)}),ce.chrome&&ce.chrome_version==102&&e.scrollDOM.addEventListener("wheel",()=>{this.chromeScrollHack<0?e.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack),this.chromeScrollHack=setTimeout(()=>{this.chromeScrollHack=-1,e.contentDOM.style.pointerEvents=""},100)},{passive:!0}),this.notifiedFocused=e.hasFocus,ce.safari&&e.contentDOM.addEventListener("input",()=>null)}ensureHandlers(e,t){var n;let r;this.customHandlers=[];for(let o of t)if(r=(n=o.update(e).spec)===null||n===void 0?void 0:n.domEventHandlers){this.customHandlers.push({plugin:o.value,handlers:r});for(let s in r)this.registeredEvents.indexOf(s)<0&&s!="scroll"&&(this.registeredEvents.push(s),e.contentDOM.addEventListener(s,l=>{yh(e,l)&&this.runCustomHandlers(s,e,l)&&l.preventDefault()}))}}runCustomHandlers(e,t,n){for(let r of this.customHandlers){let o=r.handlers[e];if(o)try{if(o.call(r.plugin,n,t)||n.defaultPrevented)return!0}catch(s){Qt(t.state,s)}}return!1}runScrollHandlers(e,t){this.lastScrollTop=e.scrollDOM.scrollTop,this.lastScrollLeft=e.scrollDOM.scrollLeft;for(let n of this.customHandlers){let r=n.handlers.scroll;if(r)try{r.call(n.plugin,t,e)}catch(o){Qt(e.state,o)}}}keydown(e,t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(t.keyCode!=27&&$f.indexOf(t.keyCode)<0&&(e.inputState.lastEscPress=0),ce.android&&ce.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return e.observer.delayAndroidKey(t.key,t.keyCode),!0;let n;return ce.ios&&!t.synthetic&&!t.altKey&&!t.metaKey&&((n=Ff.find(r=>r.keyCode==t.keyCode))&&!t.ctrlKey||Ry.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(this.pendingIOSKey=n||t,setTimeout(()=>this.flushIOSKey(e),250),!0):!1}flushIOSKey(e){let t=this.pendingIOSKey;return t?(this.pendingIOSKey=void 0,Kn(e.contentDOM,t.key,t.keyCode)):!1}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:ce.safari&&!ce.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}mustFlushObserver(e){return e.type=="keydown"&&e.keyCode!=229}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const Ff=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Ry="dthko",$f=[16,17,18,20,91,92,224,225],bo=6;function yo(i){return Math.max(0,i)*.7+8}class My{constructor(e,t,n,r){this.view=e,this.style=n,this.mustSelect=r,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParent=Xb(e.contentDOM),this.atoms=e.state.facet(za).map(s=>s(e));let o=e.contentDOM.ownerDocument;o.addEventListener("mousemove",this.move=this.move.bind(this)),o.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(Te.allowMultipleSelections)&&Oy(e,t),this.dragMove=Dy(e,t),this.dragging=Ty(e,t)&&Vf(t)==1?null:!1}start(e){this.dragging===!1&&(e.preventDefault(),this.select(e))}move(e){var t;if(e.buttons==0)return this.destroy();if(this.dragging!==!1)return;this.select(this.lastEvent=e);let n=0,r=0,o=((t=this.scrollParent)===null||t===void 0?void 0:t.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},s=Tf(this.view);e.clientX-s.left<=o.left+bo?n=-yo(o.left-e.clientX):e.clientX+s.right>=o.right-bo&&(n=yo(e.clientX-o.right)),e.clientY-s.top<=o.top+bo?r=-yo(o.top-e.clientY):e.clientY+s.bottom>=o.bottom-bo&&(r=yo(e.clientY-o.bottom)),this.setScrollSpeed(n,r)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let n=0;n<e.ranges.length;n++){let r=e.ranges[n],o=null;if(r.empty){let s=Fo(this.atoms,r.from,0);s!=r.from&&(o=z.cursor(s,-1))}else{let s=Fo(this.atoms,r.from,-1),l=Fo(this.atoms,r.to,1);(s!=r.from||l!=r.to)&&(o=z.range(r.from==r.anchor?s:l,r.from==r.head?s:l))}o&&(t||(t=e.ranges.slice()),t[n]=o)}return t?z.create(t,e.mainIndex):e}select(e){let{view:t}=this,n=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!n.eq(t.state.selection)||n.main.assoc!=t.state.selection.main.assoc)&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.docChanged&&this.dragging&&(this.dragging=this.dragging.map(e.changes)),this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Oy(i,e){let t=i.state.facet(wf);return t.length?t[0](e):ce.mac?e.metaKey:e.ctrlKey}function Dy(i,e){let t=i.state.facet(xf);return t.length?t[0](e):ce.mac?!e.altKey:!e.ctrlKey}function Ty(i,e){let{main:t}=i.state.selection;if(t.empty)return!1;let n=Jo(i.root);if(!n||n.rangeCount==0)return!0;let r=n.getRangeAt(0).getClientRects();for(let o=0;o<r.length;o++){let s=r[o];if(s.left<=e.clientX&&s.right>=e.clientX&&s.top<=e.clientY&&s.bottom>=e.clientY)return!0}return!1}function yh(i,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,n;t!=i.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(n=Fe.get(t))&&n.ignoreEvent(e))return!1;return!0}const nt=Object.create(null),Zl=Object.create(null),Hf=ce.ie&&ce.ie_version<15||ce.ios&&ce.webkit_version<604;function Py(i){let e=i.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{i.focus(),t.remove(),jf(i,t.value)},50)}function jf(i,e){let{state:t}=i,n,r=1,o=t.toText(e),s=o.lines==t.selection.ranges.length;if(Ql!=null&&t.selection.ranges.every(l=>l.empty)&&Ql==o.toString()){let l=-1;n=t.changeByRange(a=>{let c=t.doc.lineAt(a.from);if(c.from==l)return{range:a};l=c.from;let h=t.toText((s?o.line(r++).text:e)+t.lineBreak);return{changes:{from:c.from,insert:h},range:z.cursor(a.from+h.length)}})}else s?n=t.changeByRange(l=>{let a=o.line(r++);return{changes:{from:l.from,to:l.to,insert:a.text},range:z.cursor(l.from+a.length)}}):n=t.replaceSelection(o);i.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}nt.keydown=(i,e)=>{i.inputState.setSelectionOrigin("select"),e.keyCode==27&&(i.inputState.lastEscPress=Date.now())};nt.touchstart=(i,e)=>{i.inputState.lastTouchTime=Date.now(),i.inputState.setSelectionOrigin("select.pointer")};nt.touchmove=i=>{i.inputState.setSelectionOrigin("select.pointer")};Zl.touchstart=Zl.touchmove={passive:!0};nt.mousedown=(i,e)=>{if(i.observer.flush(),i.inputState.lastTouchTime>Date.now()-2e3)return;let t=null;for(let n of i.state.facet(kf))if(t=n(i,e),t)break;if(!t&&e.button==0&&(t=Ey(i,e)),t){let n=i.root.activeElement!=i.contentDOM;i.inputState.startMouseSelection(new My(i,e,t,n)),n&&i.observer.ignore(()=>of(i.contentDOM)),i.inputState.mouseSelection&&i.inputState.mouseSelection.start(e)}};function wh(i,e,t,n){if(n==1)return z.cursor(e,t);if(n==2)return vy(i.state,e,t);{let r=Rt.find(i.docView,e),o=i.state.doc.lineAt(r?r.posAtEnd:e),s=r?r.posAtStart:o.from,l=r?r.posAtEnd:o.to;return l<i.state.doc.length&&l==o.to&&l++,z.range(s,l)}}let Wf=(i,e)=>i>=e.top&&i<=e.bottom,xh=(i,e,t)=>Wf(e,t)&&i>=t.left&&i<=t.right;function Ly(i,e,t,n){let r=Rt.find(i.docView,e);if(!r)return 1;let o=e-r.posAtStart;if(o==0)return 1;if(o==r.length)return-1;let s=r.coordsAt(o,-1);if(s&&xh(t,n,s))return-1;let l=r.coordsAt(o,1);return l&&xh(t,n,l)?1:s&&Wf(n,s)?-1:1}function kh(i,e){let t=i.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:Ly(i,t,e.clientX,e.clientY)}}const By=ce.ie&&ce.ie_version<=11;let Ch=null,Sh=0,Ah=0;function Vf(i){if(!By)return i.detail;let e=Ch,t=Ah;return Ch=i,Ah=Date.now(),Sh=!e||t>Date.now()-400&&Math.abs(e.clientX-i.clientX)<2&&Math.abs(e.clientY-i.clientY)<2?(Sh+1)%3:1}function Ey(i,e){let t=kh(i,e),n=Vf(e),r=i.state.selection;return{update(o){o.docChanged&&(t.pos=o.changes.mapPos(t.pos),r=r.map(o.changes))},get(o,s,l){let a=kh(i,o),c,h=wh(i,a.pos,a.bias,n);if(t.pos!=a.pos&&!s){let d=wh(i,t.pos,t.bias,n),u=Math.min(d.from,h.from),f=Math.max(d.to,h.to);h=u<h.from?z.range(u,f):z.range(f,u)}return s?r.replaceRange(r.main.extend(h.from,h.to)):l&&n==1&&r.ranges.length>1&&(c=Iy(r,a.pos))?c:l?r.addRange(h):z.create([h])}}}function Iy(i,e){for(let t=0;t<i.ranges.length;t++){let{from:n,to:r}=i.ranges[t];if(n<=e&&r>=e)return z.create(i.ranges.slice(0,t).concat(i.ranges.slice(t+1)),i.mainIndex==t?0:i.mainIndex-(i.mainIndex>t?1:0))}return null}nt.dragstart=(i,e)=>{let{selection:{main:t}}=i.state,{mouseSelection:n}=i.inputState;n&&(n.dragging=t),e.dataTransfer&&(e.dataTransfer.setData("Text",i.state.sliceDoc(t.from,t.to)),e.dataTransfer.effectAllowed="copyMove")};function Rh(i,e,t,n){if(!t)return;let r=i.posAtCoords({x:e.clientX,y:e.clientY},!1);e.preventDefault();let{mouseSelection:o}=i.inputState,s=n&&o&&o.dragging&&o.dragMove?{from:o.dragging.from,to:o.dragging.to}:null,l={from:r,insert:t},a=i.state.changes(s?[s,l]:l);i.focus(),i.dispatch({changes:a,selection:{anchor:a.mapPos(r,-1),head:a.mapPos(r,1)},userEvent:s?"move.drop":"input.drop"})}nt.drop=(i,e)=>{if(!e.dataTransfer)return;if(i.state.readOnly)return e.preventDefault();let t=e.dataTransfer.files;if(t&&t.length){e.preventDefault();let n=Array(t.length),r=0,o=()=>{++r==t.length&&Rh(i,e,n.filter(s=>s!=null).join(i.state.lineBreak),!1)};for(let s=0;s<t.length;s++){let l=new FileReader;l.onerror=o,l.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(l.result)||(n[s]=l.result),o()},l.readAsText(t[s])}}else Rh(i,e,e.dataTransfer.getData("Text"),!0)};nt.paste=(i,e)=>{if(i.state.readOnly)return e.preventDefault();i.observer.flush();let t=Hf?null:e.clipboardData;t?(jf(i,t.getData("text/plain")||t.getData("text/uri-text")),e.preventDefault()):Py(i)};function Ny(i,e){let t=i.dom.parentNode;if(!t)return;let n=t.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout(()=>{n.remove(),i.focus()},50)}function zy(i){let e=[],t=[],n=!1;for(let r of i.selection.ranges)r.empty||(e.push(i.sliceDoc(r.from,r.to)),t.push(r));if(!e.length){let r=-1;for(let{from:o}of i.selection.ranges){let s=i.doc.lineAt(o);s.number>r&&(e.push(s.text),t.push({from:s.from,to:Math.min(i.doc.length,s.to+1)})),r=s.number}n=!0}return{text:e.join(i.lineBreak),ranges:t,linewise:n}}let Ql=null;nt.copy=nt.cut=(i,e)=>{let{text:t,ranges:n,linewise:r}=zy(i.state);if(!t&&!r)return;Ql=r?t:null;let o=Hf?null:e.clipboardData;o?(e.preventDefault(),o.clearData(),o.setData("text/plain",t)):Ny(i,t),e.type=="cut"&&!i.state.readOnly&&i.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"})};const Uf=zi.define();function Kf(i,e){let t=[];for(let n of i.facet(Af)){let r=n(i,e);r&&t.push(r)}return t?i.update({effects:t,annotations:Uf.of(!0)}):null}function qf(i){setTimeout(()=>{let e=i.hasFocus;if(e!=i.inputState.notifiedFocused){let t=Kf(i.state,e);t?i.dispatch(t):i.update([])}},10)}nt.focus=i=>{i.inputState.lastFocusTime=Date.now(),!i.scrollDOM.scrollTop&&(i.inputState.lastScrollTop||i.inputState.lastScrollLeft)&&(i.scrollDOM.scrollTop=i.inputState.lastScrollTop,i.scrollDOM.scrollLeft=i.inputState.lastScrollLeft),qf(i)};nt.blur=i=>{i.observer.clearSelectionRange(),qf(i)};nt.compositionstart=nt.compositionupdate=i=>{i.inputState.compositionFirstChange==null&&(i.inputState.compositionFirstChange=!0),i.inputState.composing<0&&(i.inputState.composing=0)};nt.compositionend=i=>{i.inputState.composing=-1,i.inputState.compositionEndedAt=Date.now(),i.inputState.compositionPendingKey=!0,i.inputState.compositionPendingChange=i.observer.pendingRecords().length>0,i.inputState.compositionFirstChange=null,ce.chrome&&ce.android?i.observer.flushSoon():i.inputState.compositionPendingChange?Promise.resolve().then(()=>i.observer.flush()):setTimeout(()=>{i.inputState.composing<0&&i.docView.compositionDeco.size&&i.update([])},50)};nt.contextmenu=i=>{i.inputState.lastContextMenu=Date.now()};nt.beforeinput=(i,e)=>{var t;let n;if(ce.chrome&&ce.android&&(n=Ff.find(r=>r.inputType==e.inputType))&&(i.observer.delayAndroidKey(n.key,n.keyCode),n.key=="Backspace"||n.key=="Delete")){let r=((t=window.visualViewport)===null||t===void 0?void 0:t.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>r+10&&i.hasFocus&&(i.contentDOM.blur(),i.focus())},100)}};const Mh=["pre-wrap","normal","pre-line","break-spaces"];class Fy{constructor(e){this.lineWrapping=e,this.doc=Le.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(e,t){let n=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((t-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return Mh.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let n=0;n<e.length;n++){let r=e[n];r<0?n++:this.heightSamples[Math.floor(r*10)]||(t=!0,this.heightSamples[Math.floor(r*10)]=!0)}return t}refresh(e,t,n,r,o,s){let l=Mh.indexOf(e)>-1,a=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=l;if(this.lineWrapping=l,this.lineHeight=t,this.charWidth=n,this.textHeight=r,this.lineLength=o,a){this.heightSamples={};for(let c=0;c<s.length;c++){let h=s[c];h<0?c++:this.heightSamples[Math.floor(h*10)]=!0}}return a}}class $y{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class Di{constructor(e,t,n,r,o,s){this.from=e,this.length=t,this.top=n,this.height=r,this.children=o,this.deco=s}get type(){var e,t,n;return(n=(e=this.children)!==null&&e!==void 0?e:(t=this.deco)===null||t===void 0?void 0:t.type)!==null&&n!==void 0?n:Je.Text}get widget(){return this.deco&&this.deco.widget}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(e){let t=(this.children||[this]).concat(e.children||[e]);return new Di(this.from,this.length+e.length,this.top,this.height+e.height,t,null)}}var We=function(i){return i[i.ByPos=0]="ByPos",i[i.ByHeight=1]="ByHeight",i[i.ByPosNoHeight=2]="ByPosNoHeight",i}(We||(We={}));const $o=.001;class Mt{constructor(e,t,n=2){this.length=e,this.height=t,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e,t){this.height!=t&&(Math.abs(this.height-t)>$o&&(e.heightChanged=!0),this.height=t)}replace(e,t,n){return Mt.of(n)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,n,r){let o=this,s=n.doc;for(let l=r.length-1;l>=0;l--){let{fromA:a,toA:c,fromB:h,toB:d}=r[l],u=o.lineAt(a,We.ByPosNoHeight,n.setDoc(t),0,0),f=u.to>=c?u:o.lineAt(c,We.ByPosNoHeight,n,0,0);for(d+=f.to-c,c=f.to;l>0&&u.from<=r[l-1].toA;)a=r[l-1].fromA,h=r[l-1].fromB,l--,a<u.from&&(u=o.lineAt(a,We.ByPosNoHeight,n,0,0));h+=u.from-a,a=u.from;let g=Fa.build(n.setDoc(s),e,h,d);o=o.replace(a,c,g)}return o.updateHeight(n,0)}static empty(){return new Wt(0,0)}static of(e){if(e.length==1)return e[0];let t=0,n=e.length,r=0,o=0;for(;;)if(t==n)if(r>o*2){let l=e[t-1];l.break?e.splice(--t,1,l.left,null,l.right):e.splice(--t,1,l.left,l.right),n+=1+l.break,r-=l.size}else if(o>r*2){let l=e[n];l.break?e.splice(n,1,l.left,null,l.right):e.splice(n,1,l.left,l.right),n+=2+l.break,o-=l.size}else break;else if(r<o){let l=e[t++];l&&(r+=l.size)}else{let l=e[--n];l&&(o+=l.size)}let s=0;return e[t-1]==null?(s=1,t--):e[t]==null&&(s=1,n++),new Hy(Mt.of(e.slice(0,t)),s,Mt.of(e.slice(n)))}}Mt.prototype.size=1;class _f extends Mt{constructor(e,t,n){super(e,t),this.deco=n}blockAt(e,t,n,r){return new Di(r,this.length,n,this.height,null,this.deco)}lineAt(e,t,n,r,o){return this.blockAt(0,n,r,o)}forEachLine(e,t,n,r,o,s){e<=o+this.length&&t>=o&&s(this.blockAt(0,n,r,o))}updateHeight(e,t=0,n=!1,r){return r&&r.from<=t&&r.more&&this.setHeight(e,r.heights[r.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Wt extends _f{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0}replace(e,t,n){let r=n[0];return n.length==1&&(r instanceof Wt||r instanceof dt&&r.flags&4)&&Math.abs(this.length-r.length)<10?(r instanceof dt?r=new Wt(r.length,this.height):r.height=this.height,this.outdated||(r.outdated=!1),r):Mt.of(n)}updateHeight(e,t=0,n=!1,r){return r&&r.from<=t&&r.more?this.setHeight(e,r.heights[r.index++]):(n||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class dt extends Mt{constructor(e){super(e,0)}heightMetrics(e,t){let n=e.doc.lineAt(t).number,r=e.doc.lineAt(t+this.length).number,o=r-n+1,s,l=0;if(e.lineWrapping){let a=Math.min(this.height,e.lineHeight*o);s=a/o,this.length>o+1&&(l=(this.height-a)/(this.length-o-1))}else s=this.height/o;return{firstLine:n,lastLine:r,perLine:s,perChar:l}}blockAt(e,t,n,r){let{firstLine:o,lastLine:s,perLine:l,perChar:a}=this.heightMetrics(t,r);if(t.lineWrapping){let c=r+Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length),h=t.doc.lineAt(c),d=l+h.length*a,u=Math.max(n,e-d/2);return new Di(h.from,h.length,u,d,null,null)}else{let c=Math.max(0,Math.min(s-o,Math.floor((e-n)/l))),{from:h,length:d}=t.doc.line(o+c);return new Di(h,d,n+l*c,l,null,null)}}lineAt(e,t,n,r,o){if(t==We.ByHeight)return this.blockAt(e,n,r,o);if(t==We.ByPosNoHeight){let{from:f,to:g}=n.doc.lineAt(e);return new Di(f,g-f,0,0,null,null)}let{firstLine:s,perLine:l,perChar:a}=this.heightMetrics(n,o),c=n.doc.lineAt(e),h=l+c.length*a,d=c.number-s,u=r+l*d+a*(c.from-o-d);return new Di(c.from,c.length,Math.max(r,Math.min(u,r+this.height-h)),h,null,null)}forEachLine(e,t,n,r,o,s){e=Math.max(e,o),t=Math.min(t,o+this.length);let{firstLine:l,perLine:a,perChar:c}=this.heightMetrics(n,o);for(let h=e,d=r;h<=t;){let u=n.doc.lineAt(h);if(h==e){let g=u.number-l;d+=a*g+c*(e-o-g)}let f=a+c*u.length;s(new Di(u.from,u.length,d,f,null,null)),d+=f,h=u.to+1}}replace(e,t,n){let r=this.length-t;if(r>0){let o=n[n.length-1];o instanceof dt?n[n.length-1]=new dt(o.length+r):n.push(null,new dt(r-1))}if(e>0){let o=n[0];o instanceof dt?n[0]=new dt(e+o.length):n.unshift(new dt(e-1),null)}return Mt.of(n)}decomposeLeft(e,t){t.push(new dt(e-1),null)}decomposeRight(e,t){t.push(null,new dt(this.length-e-1))}updateHeight(e,t=0,n=!1,r){let o=t+this.length;if(r&&r.from<=t+this.length&&r.more){let s=[],l=Math.max(t,r.from),a=-1;for(r.from>t&&s.push(new dt(r.from-t-1).updateHeight(e,t));l<=o&&r.more;){let h=e.doc.lineAt(l).length;s.length&&s.push(null);let d=r.heights[r.index++];a==-1?a=d:Math.abs(d-a)>=$o&&(a=-2);let u=new Wt(h,d);u.outdated=!1,s.push(u),l+=h+1}l<=o&&s.push(null,new dt(o-l).updateHeight(e,l));let c=Mt.of(s);return(a<0||Math.abs(c.height-this.height)>=$o||Math.abs(a-this.heightMetrics(e,t).perLine)>=$o)&&(e.heightChanged=!0),c}else(n||this.outdated)&&(this.setHeight(e,e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Hy extends Mt{constructor(e,t,n){super(e.length+t+n.length,e.height+n.height,t|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return this.flags&1}blockAt(e,t,n,r){let o=n+this.left.height;return e<o?this.left.blockAt(e,t,n,r):this.right.blockAt(e,t,o,r+this.left.length+this.break)}lineAt(e,t,n,r,o){let s=r+this.left.height,l=o+this.left.length+this.break,a=t==We.ByHeight?e<s:e<l,c=a?this.left.lineAt(e,t,n,r,o):this.right.lineAt(e,t,n,s,l);if(this.break||(a?c.to<l:c.from>l))return c;let h=t==We.ByPosNoHeight?We.ByPosNoHeight:We.ByPos;return a?c.join(this.right.lineAt(l,h,n,s,l)):this.left.lineAt(l,h,n,r,o).join(c)}forEachLine(e,t,n,r,o,s){let l=r+this.left.height,a=o+this.left.length+this.break;if(this.break)e<a&&this.left.forEachLine(e,t,n,r,o,s),t>=a&&this.right.forEachLine(e,t,n,l,a,s);else{let c=this.lineAt(a,We.ByPos,n,r,o);e<c.from&&this.left.forEachLine(e,c.from-1,n,r,o,s),c.to>=e&&c.from<=t&&s(c),t>c.to&&this.right.forEachLine(c.to+1,t,n,l,a,s)}}replace(e,t,n){let r=this.left.length+this.break;if(t<r)return this.balanced(this.left.replace(e,t,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,t-r,n));let o=[];e>0&&this.decomposeLeft(e,o);let s=o.length;for(let l of n)o.push(l);if(e>0&&Oh(o,s-1),t<this.length){let l=o.length;this.decomposeRight(t,o),Oh(o,l)}return Mt.of(o)}decomposeLeft(e,t){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(n++,e>=n&&t.push(null)),e>n&&this.right.decomposeLeft(e-n,t)}decomposeRight(e,t){let n=this.left.length,r=n+this.break;if(e>=r)return this.right.decomposeRight(e-r,t);e<n&&this.left.decomposeRight(e,t),this.break&&e<r&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?Mt.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,n=!1,r){let{left:o,right:s}=this,l=t+o.length+this.break,a=null;return r&&r.from<=t+o.length&&r.more?a=o=o.updateHeight(e,t,n,r):o.updateHeight(e,t,n),r&&r.from<=l+s.length&&r.more?a=s=s.updateHeight(e,l,n,r):s.updateHeight(e,l,n),a?this.balanced(o,s):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Oh(i,e){let t,n;i[e]==null&&(t=i[e-1])instanceof dt&&(n=i[e+1])instanceof dt&&i.splice(e-1,3,new dt(t.length+1+n.length))}const jy=5;class Fa{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let n=Math.min(t,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof Wt?r.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new Wt(n-this.pos,-1)),this.writtenTo=n,t>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,n){if(e<t||n.heightRelevant){let r=n.widget?n.widget.estimatedHeight:0;r<0&&(r=this.oracle.lineHeight);let o=t-e;n.block?this.addBlock(new _f(o,r,n)):(o||r>=jy)&&this.addLineDeco(r,o)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Wt(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let n=new dt(t-e);return this.oracle.doc.lineAt(e).to==t&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Wt)return e;let t=new Wt(0,-1);return this.nodes.push(t),t}addBlock(e){var t;this.enterLine();let n=(t=e.deco)===null||t===void 0?void 0:t.type;n==Je.WidgetAfter&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,n!=Je.WidgetBefore&&(this.covering=e)}addLineDeco(e,t){let n=this.ensureLine();n.length+=t,n.collapsed+=t,n.widgetHeight=Math.max(n.widgetHeight,e),this.writtenTo=this.pos=this.pos+t}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Wt)&&!this.isCovered?this.nodes.push(new Wt(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=e;for(let r of this.nodes)r instanceof Wt&&r.updateHeight(this.oracle,n),n+=r?r.length:1;return this.nodes}static build(e,t,n,r){let o=new Fa(n,e);return Be.spans(t,n,r,o,0),o.finish(n)}}function Wy(i,e,t){let n=new Vy;return Be.compare(i,e,t,n,0),n.changes}class Vy{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,n,r){(e<t||n&&n.heightRelevant||r&&r.heightRelevant)&&_l(e,t,this.changes,5)}}function Uy(i,e){let t=i.getBoundingClientRect(),n=i.ownerDocument,r=n.defaultView||window,o=Math.max(0,t.left),s=Math.min(r.innerWidth,t.right),l=Math.max(0,t.top),a=Math.min(r.innerHeight,t.bottom);for(let c=i.parentNode;c&&c!=n.body;)if(c.nodeType==1){let h=c,d=window.getComputedStyle(h);if((h.scrollHeight>h.clientHeight||h.scrollWidth>h.clientWidth)&&d.overflow!="visible"){let u=h.getBoundingClientRect();o=Math.max(o,u.left),s=Math.min(s,u.right),l=Math.max(l,u.top),a=c==i.parentNode?u.bottom:Math.min(a,u.bottom)}c=d.position=="absolute"||d.position=="fixed"?h.offsetParent:h.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:o-t.left,right:Math.max(o,s)-t.left,top:l-(t.top+e),bottom:Math.max(l,a)-(t.top+e)}}function Ky(i,e){let t=i.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class ll{constructor(e,t,n){this.from=e,this.to=t,this.size=n}static same(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++){let r=e[n],o=t[n];if(r.from!=o.from||r.to!=o.to||r.size!=o.size)return!1}return!0}draw(e){return be.replace({widget:new qy(this.size,e)}).range(this.from,this.to)}}class qy extends rn{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class Dh{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scaler=Th,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Ge.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(Na).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new Fy(t),this.stateDeco=e.facet(Ur).filter(n=>typeof n!="function"),this.heightMap=Mt.empty().applyChanges(this.stateDeco,Le.empty,this.heightOracle.setDoc(e.doc),[new Si(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=be.set(this.lineGaps.map(n=>n.draw(!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let n=0;n<=1;n++){let r=n?t.head:t.anchor;if(!e.some(({from:o,to:s})=>r>=o&&r<=s)){let{from:o,to:s}=this.lineBlockAt(r);e.push(new wo(o,s))}}this.viewports=e.sort((n,r)=>n.from-r.from),this.scaler=this.heightMap.height<=7e6?Th:new Xy(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(this.scaler.scale==1?e:Mr(e,this.scaler))})}update(e,t=null){this.state=e.state;let n=this.stateDeco;this.stateDeco=this.state.facet(Ur).filter(c=>typeof c!="function");let r=e.changedRanges,o=Si.extendWithRanges(r,Wy(n,this.stateDeco,e?e.changes:lt.empty(this.state.doc.length))),s=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),o),this.heightMap.height!=s&&(e.flags|=2);let l=o.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<l.from||t.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,t));let a=!e.changes.empty||e.flags&2||l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,this.updateForViewport(),a&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(Mf)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,n=window.getComputedStyle(t),r=this.heightOracle,o=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?Ge.RTL:Ge.LTR;let s=this.heightOracle.mustRefreshForWrapping(o),l=t.getBoundingClientRect(),a=s||this.mustMeasureContent||this.contentDOMHeight!=l.height;this.contentDOMHeight=l.height,this.mustMeasureContent=!1;let c=0,h=0,d=parseInt(n.paddingTop)||0,u=parseInt(n.paddingBottom)||0;(this.paddingTop!=d||this.paddingBottom!=u)&&(this.paddingTop=d,this.paddingBottom=u,c|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(r.lineWrapping&&(a=!0),this.editorWidth=e.scrollDOM.clientWidth,c|=8);let f=(this.printing?Ky:Uy)(t,this.paddingTop),g=f.top-this.pixelViewport.top,x=f.bottom-this.pixelViewport.bottom;this.pixelViewport=f;let b=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(b!=this.inView&&(this.inView=b,b&&(a=!0)),!this.inView&&!this.scrollTarget)return 0;let S=l.width;if((this.contentDOMWidth!=S||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=l.width,this.editorHeight=e.scrollDOM.clientHeight,c|=8),a){let O=e.docView.measureVisibleLineHeights(this.viewport);if(r.mustRefreshForHeights(O)&&(s=!0),s||r.lineWrapping&&Math.abs(S-this.contentDOMWidth)>r.charWidth){let{lineHeight:R,charWidth:k,textHeight:C}=e.docView.measureTextSize();s=R>0&&r.refresh(o,R,k,C,S/k,O),s&&(e.docView.minWidth=0,c|=8)}g>0&&x>0?h=Math.max(g,x):g<0&&x<0&&(h=Math.min(g,x)),r.heightChanged=!1;for(let R of this.viewports){let k=R.from==this.viewport.from?O:e.docView.measureVisibleLineHeights(R);this.heightMap=(s?Mt.empty().applyChanges(this.stateDeco,Le.empty,this.heightOracle,[new Si(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(r,0,s,new $y(R.from,k))}r.heightChanged&&(c|=2)}let A=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return A&&(this.viewport=this.getViewport(h,this.scrollTarget)),this.updateForViewport(),(c&2||A)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(s?[]:this.lineGaps,e)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,o=this.heightOracle,{visibleTop:s,visibleBottom:l}=this,a=new wo(r.lineAt(s-n*1e3,We.ByHeight,o,0,0).from,r.lineAt(l+(1-n)*1e3,We.ByHeight,o,0,0).to);if(t){let{head:c}=t.range;if(c<a.from||c>a.to){let h=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),d=r.lineAt(c,We.ByPos,o,0,0),u;t.y=="center"?u=(d.top+d.bottom)/2-h/2:t.y=="start"||t.y=="nearest"&&c<a.from?u=d.top:u=d.bottom-h,a=new wo(r.lineAt(u-1e3/2,We.ByHeight,o,0,0).from,r.lineAt(u+h+1e3/2,We.ByHeight,o,0,0).to)}}return a}mapViewport(e,t){let n=t.mapPos(e.from,-1),r=t.mapPos(e.to,1);return new wo(this.heightMap.lineAt(n,We.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(r,We.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},n=0){if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(e,We.ByPos,this.heightOracle,0,0),{bottom:o}=this.heightMap.lineAt(t,We.ByPos,this.heightOracle,0,0),{visibleTop:s,visibleBottom:l}=this;return(e==0||r<=s-Math.max(10,Math.min(-n,250)))&&(t==this.state.doc.length||o>=l+Math.max(10,Math.min(n,250)))&&r>s-2*1e3&&o<l+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let n=[];for(let r of e)t.touchesRange(r.from,r.to)||n.push(new ll(t.mapPos(r.from),t.mapPos(r.to),r.size));return n}ensureLineGaps(e,t){let n=this.heightOracle.lineWrapping,r=n?1e4:2e3,o=r>>1,s=r<<1;if(this.defaultTextDirection!=Ge.LTR&&!n)return[];let l=[],a=(c,h,d,u)=>{if(h-c<o)return;let f=this.state.selection.main,g=[f.from];f.empty||g.push(f.to);for(let b of g)if(b>c&&b<h){a(c,b-10,d,u),a(b+10,h,d,u);return}let x=Gy(e,b=>b.from>=d.from&&b.to<=d.to&&Math.abs(b.from-c)<o&&Math.abs(b.to-h)<o&&!g.some(S=>b.from<S&&b.to>S));if(!x){if(h<d.to&&t&&n&&t.visibleRanges.some(b=>b.from<=h&&b.to>=h)){let b=t.moveToLineBoundary(z.cursor(h),!1,!0).head;b>c&&(h=b)}x=new ll(c,h,this.gapSize(d,c,h,u))}l.push(x)};for(let c of this.viewportLines){if(c.length<s)continue;let h=_y(c.from,c.to,this.stateDeco);if(h.total<s)continue;let d=this.scrollTarget?this.scrollTarget.range.head:null,u,f;if(n){let g=r/this.heightOracle.lineLength*this.heightOracle.lineHeight,x,b;if(d!=null){let S=ko(h,d),A=((this.visibleBottom-this.visibleTop)/2+g)/c.height;x=S-A,b=S+A}else x=(this.visibleTop-c.top-g)/c.height,b=(this.visibleBottom-c.top+g)/c.height;u=xo(h,x),f=xo(h,b)}else{let g=h.total*this.heightOracle.charWidth,x=r*this.heightOracle.charWidth,b,S;if(d!=null){let A=ko(h,d),O=((this.pixelViewport.right-this.pixelViewport.left)/2+x)/g;b=A-O,S=A+O}else b=(this.pixelViewport.left-x)/g,S=(this.pixelViewport.right+x)/g;u=xo(h,b),f=xo(h,S)}u>c.from&&a(c.from,u,c,h),f<c.to&&a(f,c.to,c,h)}return l}gapSize(e,t,n,r){let o=ko(r,n)-ko(r,t);return this.heightOracle.lineWrapping?e.height*o:r.total*this.heightOracle.charWidth*o}updateLineGaps(e){ll.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=be.set(e.map(t=>t.draw(this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let t=[];Be.spans(e,this.viewport.from,this.viewport.to,{span(r,o){t.push({from:r,to:o})},point(){}},20);let n=t.length!=this.visibleRanges.length||this.visibleRanges.some((r,o)=>r.from!=t[o].from||r.to!=t[o].to);return this.visibleRanges=t,n?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||Mr(this.heightMap.lineAt(e,We.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return Mr(this.heightMap.lineAt(this.scaler.fromDOM(e),We.ByHeight,this.heightOracle,0,0),this.scaler)}elementAtHeight(e){return Mr(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class wo{constructor(e,t){this.from=e,this.to=t}}function _y(i,e,t){let n=[],r=i,o=0;return Be.spans(t,i,e,{span(){},point(s,l){s>r&&(n.push({from:r,to:s}),o+=s-r),r=l}},20),r<e&&(n.push({from:r,to:e}),o+=e-r),{total:o,ranges:n}}function xo({total:i,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let n=Math.floor(i*t);for(let r=0;;r++){let{from:o,to:s}=e[r],l=s-o;if(n<=l)return o+n;n-=l}}function ko(i,e){let t=0;for(let{from:n,to:r}of i.ranges){if(e<=r){t+=e-n;break}t+=r-n}return t/i.total}function Gy(i,e){for(let t of i)if(e(t))return t}const Th={toDOM(i){return i},fromDOM(i){return i},scale:1};class Xy{constructor(e,t,n){let r=0,o=0,s=0;this.viewports=n.map(({from:l,to:a})=>{let c=t.lineAt(l,We.ByPos,e,0,0).top,h=t.lineAt(a,We.ByPos,e,0,0).bottom;return r+=h-c,{from:l,to:a,top:c,bottom:h,domTop:0,domBottom:0}}),this.scale=(7e6-r)/(t.height-r);for(let l of this.viewports)l.domTop=s+(l.top-o)*this.scale,s=l.domBottom=l.domTop+(l.bottom-l.top),o=l.bottom}toDOM(e){for(let t=0,n=0,r=0;;t++){let o=t<this.viewports.length?this.viewports[t]:null;if(!o||e<o.top)return r+(e-n)*this.scale;if(e<=o.bottom)return o.domTop+(e-o.top);n=o.bottom,r=o.domBottom}}fromDOM(e){for(let t=0,n=0,r=0;;t++){let o=t<this.viewports.length?this.viewports[t]:null;if(!o||e<o.domTop)return n+(e-r)/this.scale;if(e<=o.domBottom)return o.top+(e-o.domTop);n=o.bottom,r=o.domBottom}}}function Mr(i,e){if(e.scale==1)return i;let t=e.toDOM(i.top),n=e.toDOM(i.bottom);return new Di(i.from,i.length,t,n-t,i.children&&i.children.map(r=>Mr(r,e)),i.deco)}const Co=de.define({combine:i=>i.join(" ")}),ea=de.define({combine:i=>i.indexOf(!0)>-1}),ta=Qi.newName(),Gf=Qi.newName(),Xf=Qi.newName(),Yf={"&light":"."+Gf,"&dark":"."+Xf};function ia(i,e,t){return new Qi(e,{finish(n){return/&/.test(n)?n.replace(/&\w*/,r=>{if(r=="&")return i;if(!t||!t[r])throw new RangeError(`Unsupported selector: ${r}`);return t[r]}):i+" "+n}})}const Yy=ia("."+ta,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Yf);class Jy{constructor(e,t,n,r){this.typeOver=r,this.bounds=null,this.text="";let{impreciseHead:o,impreciseAnchor:s}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,n,0))){let l=o||s?[]:Qy(e),a=new Ef(l,e.state);a.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=a.text,this.newSel=ew(l,this.bounds.from)}else{let l=e.observer.selectionRange,a=o&&o.node==l.focusNode&&o.offset==l.focusOffset||!Jn(e.contentDOM,l.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(l.focusNode,l.focusOffset),c=s&&s.node==l.anchorNode&&s.offset==l.anchorOffset||!Jn(e.contentDOM,l.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(l.anchorNode,l.anchorOffset);this.newSel=z.single(c,a)}}}function Jf(i,e){let t,{newSel:n}=e,r=i.state.selection.main,o=i.inputState.lastKeyTime>Date.now()-100?i.inputState.lastKeyCode:-1;if(e.bounds){let{from:s,to:l}=e.bounds,a=r.from,c=null;(o===8||ce.android&&e.text.length<l-s)&&(a=r.to,c="end");let h=Zy(i.state.doc.sliceString(s,l,Fn),e.text,a-s,c);h&&(ce.chrome&&o==13&&h.toB==h.from+2&&e.text.slice(h.from,h.toB)==Fn+Fn&&h.toB--,t={from:s+h.from,to:s+h.toA,insert:Le.of(e.text.slice(h.from,h.toB).split(Fn))})}else n&&(!i.hasFocus&&i.state.facet(Bs)||n.main.eq(r))&&(n=null);if(!t&&!n)return!1;if(!t&&e.typeOver&&!r.empty&&n&&n.main.empty?t={from:r.from,to:r.to,insert:i.state.doc.slice(r.from,r.to)}:t&&t.from>=r.from&&t.to<=r.to&&(t.from!=r.from||t.to!=r.to)&&r.to-r.from-(t.to-t.from)<=4?t={from:r.from,to:r.to,insert:i.state.doc.slice(r.from,t.from).append(t.insert).append(i.state.doc.slice(t.to,r.to))}:(ce.mac||ce.android)&&t&&t.from==t.to&&t.from==r.head-1&&/^\. ?$/.test(t.insert.toString())&&i.contentDOM.getAttribute("autocorrect")=="off"?(n&&t.insert.length==2&&(n=z.single(n.main.anchor-1,n.main.head-1)),t={from:r.from,to:r.to,insert:Le.of([" "])}):ce.chrome&&t&&t.from==t.to&&t.from==r.head&&t.insert.toString()==`
 `&&i.lineWrapping&&(n&&(n=z.single(n.main.anchor-1,n.main.head-1)),t={from:r.from,to:r.to,insert:Le.of([" "])}),t){let s=i.state;if(ce.ios&&i.inputState.flushIOSKey(i)||ce.android&&(t.from==r.from&&t.to==r.to&&t.insert.length==1&&t.insert.lines==2&&Kn(i.contentDOM,"Enter",13)||(t.from==r.from-1&&t.to==r.to&&t.insert.length==0||o==8&&t.insert.length<t.to-t.from)&&Kn(i.contentDOM,"Backspace",8)||t.from==r.from&&t.to==r.to+1&&t.insert.length==0&&Kn(i.contentDOM,"Delete",46)))return!0;let l=t.insert.toString();if(i.state.facet(Sf).some(h=>h(i,t.from,t.to,l)))return!0;i.inputState.composing>=0&&i.inputState.composing++;let a;if(t.from>=r.from&&t.to<=r.to&&t.to-t.from>=(r.to-r.from)/3&&(!n||n.main.empty&&n.main.from==t.from+t.insert.length)&&i.inputState.composing<0){let h=r.from<t.from?s.sliceDoc(r.from,t.from):"",d=r.to>t.to?s.sliceDoc(t.to,r.to):"";a=s.replaceSelection(i.state.toText(h+t.insert.sliceString(0,void 0,i.state.lineBreak)+d))}else{let h=s.changes(t),d=n&&n.main.to<=h.newLength?n.main:void 0;if(s.selection.ranges.length>1&&i.inputState.composing>=0&&t.to<=r.to&&t.to>=r.to-10){let u=i.state.sliceDoc(t.from,t.to),f=If(i)||i.state.doc.lineAt(r.head),g=r.to-t.to,x=r.to-r.from;a=s.changeByRange(b=>{if(b.from==r.from&&b.to==r.to)return{changes:h,range:d||b.map(h)};let S=b.to-g,A=S-u.length;if(b.to-b.from!=x||i.state.sliceDoc(A,S)!=u||f&&b.to>=f.from&&b.from<=f.to)return{range:b};let O=s.changes({from:A,to:S,insert:t.insert}),R=b.to-r.to;return{changes:O,range:d?z.range(Math.max(0,d.anchor+R),Math.max(0,d.head+R)):b.map(O)}})}else a={changes:h,selection:d&&s.selection.replaceRange(d)}}let c="input.type";return(i.composing||i.inputState.compositionPendingChange&&i.inputState.compositionEndedAt>Date.now()-50)&&(i.inputState.compositionPendingChange=!1,c+=".compose",i.inputState.compositionFirstChange&&(c+=".start",i.inputState.compositionFirstChange=!1)),i.dispatch(a,{scrollIntoView:!0,userEvent:c}),!0}else if(n&&!n.main.eq(r)){let s=!1,l="select";return i.inputState.lastSelectionTime>Date.now()-50&&(i.inputState.lastSelectionOrigin=="select"&&(s=!0),l=i.inputState.lastSelectionOrigin),i.dispatch({selection:n,scrollIntoView:s,userEvent:l}),!0}else return!1}function Zy(i,e,t,n){let r=Math.min(i.length,e.length),o=0;for(;o<r&&i.charCodeAt(o)==e.charCodeAt(o);)o++;if(o==r&&i.length==e.length)return null;let s=i.length,l=e.length;for(;s>0&&l>0&&i.charCodeAt(s-1)==e.charCodeAt(l-1);)s--,l--;if(n=="end"){let a=Math.max(0,o-Math.min(s,l));t-=s+a-o}if(s<o&&i.length<e.length){let a=t<=o&&t>=s?o-t:0;o-=a,l=o+(l-s),s=o}else if(l<o){let a=t<=o&&t>=l?o-t:0;o-=a,s=o+(s-l),l=o}return{from:o,toA:s,toB:l}}function Qy(i){let e=[];if(i.root.activeElement!=i.contentDOM)return e;let{anchorNode:t,anchorOffset:n,focusNode:r,focusOffset:o}=i.observer.selectionRange;return t&&(e.push(new dh(t,n)),(r!=t||o!=n)&&e.push(new dh(r,o))),e}function ew(i,e){if(i.length==0)return null;let t=i[0].pos,n=i.length==2?i[1].pos:t;return t>-1&&n>-1?z.single(t+e,n+e):null}const tw={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},al=ce.ie&&ce.ie_version<=11;class iw{constructor(e){this.view=e,this.active=!1,this.selectionRange=new Yb,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.resizeContent=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let n of t)this.queue.push(n);(ce.ie&&ce.ie_version<=11||ce.ios&&e.composing)&&t.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),al&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM),this.resizeContent=new ResizeObserver(()=>this.view.requestMeasure()),this.resizeContent.observe(e.contentDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runScrollHandlers(this.view,e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,n)=>t!=e[n]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,r=this.selectionRange;if(n.state.facet(Bs)?n.root.activeElement!=this.dom:!zo(n.dom,r))return;let o=r.anchorNode&&n.docView.nearest(r.anchorNode);if(o&&o.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(ce.ie&&ce.ie_version<=11||ce.android&&ce.chrome)&&!n.state.selection.main.empty&&r.focusNode&&Zo(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=ce.safari&&e.root.nodeType==11&&qb(this.dom.ownerDocument)==this.dom&&nw(this.view)||Jo(e.root);if(!t||this.selectionRange.eq(t))return!1;let n=zo(this.dom,t);return n&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&Zb(this.dom,t)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(t),n&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let n=this.dom;n;)if(n.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=t)n.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,tw),al&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),al&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var n;if(!this.delayedAndroidKey){let r=()=>{let o=this.delayedAndroidKey;o&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=o.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&o.force&&Kn(this.dom,o.key,o.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(r)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,n=-1,r=!1;for(let o of e){let s=this.readMutation(o);s&&(s.typeOver&&(r=!0),t==-1?{from:t,to:n}=s:(t=Math.min(s.from,t),n=Math.max(s.to,n)))}return{from:t,to:n,typeOver:r}}readChange(){let{from:e,to:t,typeOver:n}=this.processRecords(),r=this.selectionChanged&&zo(this.dom,this.selectionRange);return e<0&&!r?null:(e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1,new Jy(this.view,e,t,n))}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return!1;let n=this.view.state,r=Jf(this.view,t);return this.view.state==n&&this.view.update([]),r}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.dirty|=4),e.type=="childList"){let n=Ph(t,e.previousSibling||e.target.previousSibling,-1),r=Ph(t,e.nextSibling||e.target.nextSibling,1);return{from:n?t.posAfter(n):t.posAtStart,to:r?t.posBefore(r):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var e,t,n,r;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect(),(r=this.resizeContent)===null||r===void 0||r.disconnect();for(let o of this.scrollTargets)o.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function Ph(i,e,t){for(;e;){let n=Fe.get(e);if(n&&n.parent==i)return n;let r=e.parentNode;e=r!=i.dom?r:t>0?e.nextSibling:e.previousSibling}return null}function nw(i){let e=null;function t(a){a.preventDefault(),a.stopImmediatePropagation(),e=a.getTargetRanges()[0]}if(i.contentDOM.addEventListener("beforeinput",t,!0),i.dom.ownerDocument.execCommand("indent"),i.contentDOM.removeEventListener("beforeinput",t,!0),!e)return null;let n=e.startContainer,r=e.startOffset,o=e.endContainer,s=e.endOffset,l=i.docView.domAtPos(i.state.selection.main.anchor);return Zo(l.node,l.offset,o,s)&&([n,r,o,s]=[o,s,n,r]),{anchorNode:n,anchorOffset:r,focusNode:o,focusOffset:s}}class he{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: fixed; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=e.dispatch||(t=>this.update([t])),this.dispatch=this.dispatch.bind(this),this._root=e.root||Jb(e.parent)||document,this.viewState=new Dh(e.state||Te.create(e)),this.plugins=this.state.facet(Ar).map(t=>new rl(t));for(let t of this.plugins)t.update(this);this.observer=new iw(this),this.inputState=new Ay(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new uh(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),e.parent&&e.parent.appendChild(this.dom)}dispatch(...e){let t=e.length==1&&e[0]instanceof at?e[0]:this.state.update(...e);this._dispatch(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,n=!1,r,o=this.state;for(let u of e){if(u.startState!=o)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");o=u.state}if(this.destroyed){this.viewState.state=o;return}let s=this.hasFocus,l=0,a=null;e.some(u=>u.annotation(Uf))?(this.inputState.notifiedFocused=s,l=1):s!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=s,a=Kf(o,s),a||(l=1));let c=this.observer.delayedAndroidKey,h=null;if(c?(this.observer.clearDelayedAndroidKey(),h=this.observer.readChange(),(h&&!this.state.doc.eq(o.doc)||!this.state.selection.eq(o.selection))&&(h=null)):this.observer.clear(),o.facet(Te.phrases)!=this.state.facet(Te.phrases))return this.setState(o);r=ts.create(this,o,e),r.flags|=l;let d=this.viewState.scrollTarget;try{this.updateState=2;for(let u of e){if(d&&(d=d.map(u.changes)),u.scrollIntoView){let{main:f}=u.state.selection;d=new es(f.empty?f:z.cursor(f.head,f.head>f.anchor?-1:1))}for(let f of u.effects)f.is(ch)&&(d=f.value)}this.viewState.update(r,d),this.bidiCache=is.update(this.bidiCache,r.changes),r.empty||(this.updatePlugins(r),this.inputState.update(r)),t=this.docView.update(r),this.state.facet(Rr)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(u=>u.isUserEvent("select.pointer")))}finally{this.updateState=0}if(r.startState.facet(Co)!=r.state.facet(Co)&&(this.viewState.mustMeasureContent=!0),(t||n||d||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!r.empty)for(let u of this.state.facet(Gl))u(r);(a||h)&&Promise.resolve().then(()=>{a&&this.state==a.startState&&this.dispatch(a),h&&!Jf(this,h)&&c.force&&Kn(this.contentDOM,c.key,c.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new Dh(e),this.plugins=e.facet(Ar).map(n=>new rl(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView=new uh(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(Ar),n=e.state.facet(Ar);if(t!=n){let r=[];for(let o of n){let s=t.indexOf(o);if(s<0)r.push(new rl(o));else{let l=this.plugins[s];l.mustUpdate=e,r.push(l)}}for(let o of this.plugins)o.mustUpdate!=e&&o.destroy(this);this.plugins=r,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let r of this.plugins)r.mustUpdate=e;for(let r=0;r<this.plugins.length;r++)this.plugins[r].update(this)}measure(e=!0){if(this.destroyed)return;this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,{scrollHeight:n,scrollTop:r,clientHeight:o}=this.scrollDOM,s=r>n-o-4?n:r;try{for(let l=0;;l++){this.updateState=1;let a=this.viewport,c=this.viewState.lineBlockAtHeight(s),h=this.viewState.measure(this);if(!h&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(l>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let d=[];h&4||([this.measureRequests,d]=[d,this.measureRequests]);let u=d.map(b=>{try{return b.read(this)}catch(S){return Qt(this.state,S),Lh}}),f=ts.create(this,this.state,[]),g=!1,x=!1;f.flags|=h,t?t.flags|=h:t=f,this.updateState=2,f.empty||(this.updatePlugins(f),this.inputState.update(f),this.updateAttrs(),g=this.docView.update(f));for(let b=0;b<d.length;b++)if(u[b]!=Lh)try{let S=d[b];S.write&&S.write(u[b],this)}catch(S){Qt(this.state,S)}if(this.viewState.editorHeight)if(this.viewState.scrollTarget)this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,x=!0;else{let b=this.viewState.lineBlockAt(c.from).top-c.top;(b>1||b<-1)&&(this.scrollDOM.scrollTop+=b,x=!0)}if(g&&this.docView.updateSelection(!0),this.viewport.from==a.from&&this.viewport.to==a.to&&!x&&this.measureRequests.length==0)break}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let l of this.state.facet(Gl))l(t)}get themeClasses(){return ta+" "+(this.state.facet(ea)?Xf:Gf)+" "+this.state.facet(Co)}updateAttrs(){let e=Bh(this,Of,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Bs)?"true":"false",class:"cm-content",style:`${ce.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),Bh(this,Na,t);let n=this.observer.ignore(()=>{let r=ql(this.contentDOM,this.contentAttrs,t),o=ql(this.dom,this.editorAttrs,e);return r||o});return this.editorAttrs=e,this.contentAttrs=t,n}showAnnouncements(e){let t=!0;for(let n of e)for(let r of n.effects)if(r.is(he.announce)){t&&(this.announceDOM.textContent=""),t=!1;let o=this.announceDOM.appendChild(document.createElement("div"));o.textContent=r.value}}mountStyles(){this.styleModules=this.state.facet(Rr),Qi.mount(this.root,this.styleModules.concat(Yy).reverse())}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(n=>n.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,n){return sl(this,e,bh(this,e,t,n))}moveByGroup(e,t){return sl(this,e,bh(this,e,t,n=>Cy(this,e.head,n)))}moveToLineBoundary(e,t,n=!0){return ky(this,e,t,n)}moveVertically(e,t,n){return sl(this,e,Sy(this,e,t,n))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),zf(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let n=this.docView.coordsAt(e,t);if(!n||n.left==n.right)return n;let r=this.state.doc.lineAt(e),o=this.bidiSpans(r),s=o[qn.find(o,e-r.from,-1,t)];return La(n,s.dir==Ge.LTR==t>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(Rf)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>rw)return Lf(e.length);let t=this.textDirectionAt(e.from);for(let r of this.bidiCache)if(r.from==e.from&&r.dir==t)return r.order;let n=ay(e.text,t);return this.bidiCache.push(new is(e.from,e.to,t,n)),n}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||ce.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{of(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return ch.of(new es(typeof e=="number"?z.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}static domEventHandlers(e){return ht.define(()=>({}),{eventHandlers:e})}static theme(e,t){let n=Qi.newName(),r=[Co.of(n),Rr.of(ia(`.${n}`,e))];return t&&t.dark&&r.push(ea.of(!0)),r}static baseTheme(e){return lr.lowest(Rr.of(ia("."+ta,e,Yf)))}static findFromDOM(e){var t;let n=e.querySelector(".cm-content"),r=n&&Fe.get(n)||Fe.get(e);return((t=r==null?void 0:r.rootView)===null||t===void 0?void 0:t.view)||null}}he.styleModule=Rr;he.inputHandler=Sf;he.focusChangeEffect=Af;he.perLineTextDirection=Rf;he.exceptionSink=Cf;he.updateListener=Gl;he.editable=Bs;he.mouseSelectionStyle=kf;he.dragMovesSelection=xf;he.clickAddsSelectionRange=wf;he.decorations=Ur;he.atomicRanges=za;he.scrollMargins=Df;he.darkTheme=ea;he.contentAttributes=Na;he.editorAttributes=Of;he.lineWrapping=he.contentAttributes.of({class:"cm-lineWrapping"});he.announce=Ce.define();const rw=4096,Lh={};class is{constructor(e,t,n,r){this.from=e,this.to=t,this.dir=n,this.order=r}static update(e,t){if(t.empty)return e;let n=[],r=e.length?e[e.length-1].dir:Ge.LTR;for(let o=Math.max(0,e.length-10);o<e.length;o++){let s=e[o];s.dir==r&&!t.touchesRange(s.from,s.to)&&n.push(new is(t.mapPos(s.from,1),t.mapPos(s.to,-1),s.dir,s.order))}return n}}function Bh(i,e,t){for(let n=i.state.facet(e),r=n.length-1;r>=0;r--){let o=n[r],s=typeof o=="function"?o(i):o;s&&Kl(s,t)}return t}const ow=ce.mac?"mac":ce.windows?"win":ce.linux?"linux":"key";function sw(i,e){const t=i.split(/-(?!$)/);let n=t[t.length-1];n=="Space"&&(n=" ");let r,o,s,l;for(let a=0;a<t.length-1;++a){const c=t[a];if(/^(cmd|meta|m)$/i.test(c))l=!0;else if(/^a(lt)?$/i.test(c))r=!0;else if(/^(c|ctrl|control)$/i.test(c))o=!0;else if(/^s(hift)?$/i.test(c))s=!0;else if(/^mod$/i.test(c))e=="mac"?l=!0:o=!0;else throw new Error("Unrecognized modifier name: "+c)}return r&&(n="Alt-"+n),o&&(n="Ctrl-"+n),l&&(n="Meta-"+n),s&&(n="Shift-"+n),n}function So(i,e,t){return e.altKey&&(i="Alt-"+i),e.ctrlKey&&(i="Ctrl-"+i),e.metaKey&&(i="Meta-"+i),t!==!1&&e.shiftKey&&(i="Shift-"+i),i}const lw=lr.default(he.domEventHandlers({keydown(i,e){return Qf(Zf(e.state),i,e,"editor")}})),Es=de.define({enables:lw}),Eh=new WeakMap;function Zf(i){let e=i.facet(Es),t=Eh.get(e);return t||Eh.set(e,t=hw(e.reduce((n,r)=>n.concat(r),[]))),t}function aw(i,e,t){return Qf(Zf(i.state),e,i,t)}let Ui=null;const cw=4e3;function hw(i,e=ow){let t=Object.create(null),n=Object.create(null),r=(s,l)=>{let a=n[s];if(a==null)n[s]=l;else if(a!=l)throw new Error("Key binding "+s+" is used both as a regular binding and as a multi-stroke prefix")},o=(s,l,a,c)=>{var h,d;let u=t[s]||(t[s]=Object.create(null)),f=l.split(/ (?!$)/).map(b=>sw(b,e));for(let b=1;b<f.length;b++){let S=f.slice(0,b).join(" ");r(S,!0),u[S]||(u[S]={preventDefault:!0,run:[A=>{let O=Ui={view:A,prefix:S,scope:s};return setTimeout(()=>{Ui==O&&(Ui=null)},cw),!0}]})}let g=f.join(" ");r(g,!1);let x=u[g]||(u[g]={preventDefault:!1,run:((d=(h=u._any)===null||h===void 0?void 0:h.run)===null||d===void 0?void 0:d.slice())||[]});a&&x.run.push(a),c&&(x.preventDefault=!0)};for(let s of i){let l=s.scope?s.scope.split(" "):["editor"];if(s.any)for(let c of l){let h=t[c]||(t[c]=Object.create(null));h._any||(h._any={preventDefault:!1,run:[]});for(let d in h)h[d].run.push(s.any)}let a=s[e]||s.key;if(a)for(let c of l)o(c,a,s.run,s.preventDefault),s.shift&&o(c,"Shift-"+a,s.shift,s.preventDefault)}return t}function Qf(i,e,t,n){let r=Kb(e),o=ut(r,0),s=Jt(o)==r.length&&r!=" ",l="",a=!1;Ui&&Ui.view==t&&Ui.scope==n&&(l=Ui.prefix+" ",(a=$f.indexOf(e.keyCode)<0)&&(Ui=null));let c=new Set,h=g=>{if(g){for(let x of g.run)if(!c.has(x)&&(c.add(x),x(t,e)))return!0;g.preventDefault&&(a=!0)}return!1},d=i[n],u,f;if(d){if(h(d[l+So(r,e,!s)]))return!0;if(s&&(e.altKey||e.metaKey||e.ctrlKey)&&!(ce.windows&&e.ctrlKey&&e.altKey)&&(u=en[e.keyCode])&&u!=r){if(h(d[l+So(u,e,!0)])||e.shiftKey&&(f=Wr[e.keyCode])!=r&&f!=u&&h(d[l+So(f,e,!1)]))return!0}else if(s&&e.shiftKey&&h(d[l+So(r,e,!0)]))return!0;if(h(d._any))return!0}return a}class io{constructor(e,t,n,r,o){this.className=e,this.left=t,this.top=n,this.width=r,this.height=o}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,n){if(n.empty){let r=e.coordsAtPos(n.head,n.assoc||1);if(!r)return[];let o=ep(e);return[new io(t,r.left-o.left,r.top-o.top,null,r.bottom-r.top)]}else return dw(e,t,n)}}function ep(i){let e=i.scrollDOM.getBoundingClientRect();return{left:(i.textDirection==Ge.LTR?e.left:e.right-i.scrollDOM.clientWidth)-i.scrollDOM.scrollLeft,top:e.top-i.scrollDOM.scrollTop}}function Ih(i,e,t){let n=z.cursor(e);return{from:Math.max(t.from,i.moveToLineBoundary(n,!1,!0).from),to:Math.min(t.to,i.moveToLineBoundary(n,!0,!0).from),type:Je.Text}}function Nh(i,e){let t=i.lineBlockAt(e);if(Array.isArray(t.type)){for(let n of t.type)if(n.to>e||n.to==e&&(n.to==t.to||n.type==Je.Text))return n}return t}function dw(i,e,t){if(t.to<=i.viewport.from||t.from>=i.viewport.to)return[];let n=Math.max(t.from,i.viewport.from),r=Math.min(t.to,i.viewport.to),o=i.textDirection==Ge.LTR,s=i.contentDOM,l=s.getBoundingClientRect(),a=ep(i),c=s.querySelector(".cm-line"),h=c&&window.getComputedStyle(c),d=l.left+(h?parseInt(h.paddingLeft)+Math.min(0,parseInt(h.textIndent)):0),u=l.right-(h?parseInt(h.paddingRight):0),f=Nh(i,n),g=Nh(i,r),x=f.type==Je.Text?f:null,b=g.type==Je.Text?g:null;if(i.lineWrapping&&(x&&(x=Ih(i,n,x)),b&&(b=Ih(i,r,b))),x&&b&&x.from==b.from)return A(O(t.from,t.to,x));{let k=x?O(t.from,null,x):R(f,!1),C=b?O(null,t.to,b):R(g,!0),w=[];return(x||f).to<(b||g).from-(x&&b?1:0)?w.push(S(d,k.bottom,u,C.top)):k.bottom<C.top&&i.elementAtHeight((k.bottom+C.top)/2).type==Je.Text&&(k.bottom=C.top=(k.bottom+C.top)/2),A(k).concat(w).concat(A(C))}function S(k,C,w,D){return new io(e,k-a.left,C-a.top-.01,w-k,D-C+.01)}function A({top:k,bottom:C,horizontal:w}){let D=[];for(let v=0;v<w.length;v+=2)D.push(S(w[v],k,w[v+1],C));return D}function O(k,C,w){let D=1e9,v=-1e9,W=[];function q(re,oe,$,te,E){let V=i.coordsAtPos(re,re==w.to?-2:2),H=i.coordsAtPos($,$==w.from?2:-2);!V||!H||(D=Math.min(V.top,H.top,D),v=Math.max(V.bottom,H.bottom,v),E==Ge.LTR?W.push(o&&oe?d:V.left,o&&te?u:H.right):W.push(!o&&te?d:H.left,!o&&oe?u:V.right))}let ne=k??w.from,Y=C??w.to;for(let re of i.visibleRanges)if(re.to>ne&&re.from<Y)for(let oe=Math.max(re.from,ne),$=Math.min(re.to,Y);;){let te=i.state.doc.lineAt(oe);for(let E of i.bidiSpans(te)){let V=E.from+te.from,H=E.to+te.from;if(V>=$)break;H>oe&&q(Math.max(V,oe),k==null&&V<=ne,Math.min(H,$),C==null&&H>=Y,E.dir)}if(oe=te.to+1,oe>=$)break}return W.length==0&&q(ne,k==null,Y,C==null,i.textDirection),{top:D,bottom:v,horizontal:W}}function R(k,C){let w=l.top+(C?k.top:k.bottom);return{top:w,bottom:w,horizontal:[]}}}function uw(i,e){return i.constructor==e.constructor&&i.eq(e)}class fw{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(Ho)!=e.state.facet(Ho)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&e.view.requestMeasure(this.measureReq)}setOrder(e){let t=0,n=e.facet(Ho);for(;t<n.length&&n[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}draw(e){if(e.length!=this.drawn.length||e.some((t,n)=>!uw(t,this.drawn[n]))){let t=this.dom.firstChild,n=0;for(let r of e)r.update&&t&&r.constructor&&this.drawn[n].constructor&&r.update(t,this.drawn[n])?(t=t.nextSibling,n++):this.dom.insertBefore(r.draw(),t);for(;t;){let r=t.nextSibling;t.remove(),t=r}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Ho=de.define();function tp(i){return[ht.define(e=>new fw(e,i)),Ho.of(i)]}const ip=!ce.ios,Kr=de.define({combine(i){return Ai(i,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function pw(i={}){return[Kr.of(i),gw,mw,vw,Mf.of(!0)]}function np(i){return i.startState.facet(Kr)!=i.state.facet(Kr)}const gw=tp({above:!0,markers(i){let{state:e}=i,t=e.facet(Kr),n=[];for(let r of e.selection.ranges){let o=r==e.selection.main;if(r.empty?!o||ip:t.drawRangeCursor){let s=o?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",l=r.empty?r:z.cursor(r.head,r.head>r.anchor?-1:1);for(let a of io.forRange(i,s,l))n.push(a)}}return n},update(i,e){i.transactions.some(n=>n.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=np(i);return t&&zh(i.state,e),i.docChanged||i.selectionSet||t},mount(i,e){zh(e.state,i)},class:"cm-cursorLayer"});function zh(i,e){e.style.animationDuration=i.facet(Kr).cursorBlinkRate+"ms"}const mw=tp({above:!1,markers(i){return i.state.selection.ranges.map(e=>e.empty?[]:io.forRange(i,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(i,e){return i.docChanged||i.selectionSet||i.viewportChanged||np(i)},class:"cm-selectionLayer"}),rp={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};ip&&(rp[".cm-line"].caretColor="transparent !important");const vw=lr.highest(he.theme(rp)),op=Ce.define({map(i,e){return i==null?null:e.mapPos(i)}}),Or=mt.define({create(){return null},update(i,e){return i!=null&&(i=e.changes.mapPos(i)),e.effects.reduce((t,n)=>n.is(op)?n.value:t,i)}}),bw=ht.fromClass(class{constructor(i){this.view=i,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(i){var e;let t=i.state.field(Or);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(i.startState.field(Or)!=t||i.docChanged||i.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let i=this.view.state.field(Or),e=i!=null&&this.view.coordsAtPos(i);if(!e)return null;let t=this.view.scrollDOM.getBoundingClientRect();return{left:e.left-t.left+this.view.scrollDOM.scrollLeft,top:e.top-t.top+this.view.scrollDOM.scrollTop,height:e.bottom-e.top}}drawCursor(i){this.cursor&&(i?(this.cursor.style.left=i.left+"px",this.cursor.style.top=i.top+"px",this.cursor.style.height=i.height+"px"):this.cursor.style.left="-100000px")}destroy(){this.cursor&&this.cursor.remove()}setDropPos(i){this.view.state.field(Or)!=i&&this.view.dispatch({effects:op.of(i)})}},{eventHandlers:{dragover(i){this.setDropPos(this.view.posAtCoords({x:i.clientX,y:i.clientY}))},dragleave(i){(i.target==this.view.contentDOM||!this.view.contentDOM.contains(i.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function yw(){return[Or,bw]}function Fh(i,e,t,n,r){e.lastIndex=0;for(let o=i.iterRange(t,n),s=t,l;!o.next().done;s+=o.value.length)if(!o.lineBreak)for(;l=e.exec(o.value);)r(s+l.index,l)}function ww(i,e){let t=i.visibleRanges;if(t.length==1&&t[0].from==i.viewport.from&&t[0].to==i.viewport.to)return t;let n=[];for(let{from:r,to:o}of t)r=Math.max(i.state.doc.lineAt(r).from,r-e),o=Math.min(i.state.doc.lineAt(o).to,o+e),n.length&&n[n.length-1].to>=r?n[n.length-1].to=o:n.push({from:r,to:o});return n}class xw{constructor(e){const{regexp:t,decoration:n,decorate:r,boundary:o,maxLength:s=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,r)this.addMatch=(l,a,c,h)=>r(h,c,c+l[0].length,l,a);else if(typeof n=="function")this.addMatch=(l,a,c,h)=>{let d=n(l,a,c);d&&h(c,c+l[0].length,d)};else if(n)this.addMatch=(l,a,c,h)=>h(c,c+l[0].length,n);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=o,this.maxLength=s}createDeco(e){let t=new Zi,n=t.add.bind(t);for(let{from:r,to:o}of ww(e,this.maxLength))Fh(e.state.doc,this.regexp,r,o,(s,l)=>this.addMatch(l,e,s,n));return t.finish()}updateDeco(e,t){let n=1e9,r=-1;return e.docChanged&&e.changes.iterChanges((o,s,l,a)=>{a>e.view.viewport.from&&l<e.view.viewport.to&&(n=Math.min(l,n),r=Math.max(a,r))}),e.viewportChanged||r-n>1e3?this.createDeco(e.view):r>-1?this.updateRange(e.view,t.map(e.changes),n,r):t}updateRange(e,t,n,r){for(let o of e.visibleRanges){let s=Math.max(o.from,n),l=Math.min(o.to,r);if(l>s){let a=e.state.doc.lineAt(s),c=a.to<l?e.state.doc.lineAt(l):a,h=Math.max(o.from,a.from),d=Math.min(o.to,c.to);if(this.boundary){for(;s>a.from;s--)if(this.boundary.test(a.text[s-1-a.from])){h=s;break}for(;l<c.to;l++)if(this.boundary.test(c.text[l-c.from])){d=l;break}}let u=[],f,g=(x,b,S)=>u.push(S.range(x,b));if(a==c)for(this.regexp.lastIndex=h-a.from;(f=this.regexp.exec(a.text))&&f.index<d-a.from;)this.addMatch(f,e,f.index+a.from,g);else Fh(e.state.doc,this.regexp,h,d,(x,b)=>this.addMatch(b,e,x,g));t=t.update({filterFrom:h,filterTo:d,filter:(x,b)=>x<h||b>d,add:u})}}return t}}const na=/x/.unicode!=null?"gu":"g",kw=new RegExp(`[\0-\b
--­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\uFEFF￹-￼]`,na),Cw={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let cl=null;function Sw(){var i;if(cl==null&&typeof document<"u"&&document.body){let e=document.body.style;cl=((i=e.tabSize)!==null&&i!==void 0?i:e.MozTabSize)!=null}return cl||!1}const jo=de.define({combine(i){let e=Ai(i,{render:null,specialChars:kw,addSpecialChars:null});return(e.replaceTabs=!Sw())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,na)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,na)),e}});function Aw(i={}){return[jo.of(i),Rw()]}let $h=null;function Rw(){return $h||($h=ht.fromClass(class{constructor(i){this.view=i,this.decorations=be.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(i.state.facet(jo)),this.decorations=this.decorator.createDeco(i)}makeDecorator(i){return new xw({regexp:i.specialChars,decoration:(e,t,n)=>{let{doc:r}=t.state,o=ut(e[0],0);if(o==9){let s=r.lineAt(n),l=t.state.tabSize,a=eo(s.text,l,n-s.from);return be.replace({widget:new Tw((l-a%l)*this.view.defaultCharacterWidth)})}return this.decorationCache[o]||(this.decorationCache[o]=be.replace({widget:new Dw(i,o)}))},boundary:i.replaceTabs?void 0:/[^]/})}update(i){let e=i.state.facet(jo);i.startState.facet(jo)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(i.view)):this.decorations=this.decorator.updateDeco(i,this.decorations)}},{decorations:i=>i.decorations}))}const Mw="•";function Ow(i){return i>=32?Mw:i==10?"␤":String.fromCharCode(9216+i)}class Dw extends rn{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=Ow(this.code),n=e.state.phrase("Control character")+" "+(Cw[this.code]||"0x"+this.code.toString(16)),r=this.options.render&&this.options.render(this.code,n,t);if(r)return r;let o=document.createElement("span");return o.textContent=t,o.title=n,o.setAttribute("aria-label",n),o.className="cm-specialChar",o}ignoreEvent(){return!1}}class Tw extends rn{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function Pw(){return Bw}const Lw=be.line({class:"cm-activeLine"}),Bw=ht.fromClass(class{constructor(i){this.decorations=this.getDeco(i)}update(i){(i.docChanged||i.selectionSet)&&(this.decorations=this.getDeco(i.view))}getDeco(i){let e=-1,t=[];for(let n of i.state.selection.ranges){let r=i.lineBlockAt(n.head);r.from>e&&(t.push(Lw.range(r.from)),e=r.from)}return be.set(t)}},{decorations:i=>i.decorations}),ra=2e3;function Ew(i,e,t){let n=Math.min(e.line,t.line),r=Math.max(e.line,t.line),o=[];if(e.off>ra||t.off>ra||e.col<0||t.col<0){let s=Math.min(e.off,t.off),l=Math.max(e.off,t.off);for(let a=n;a<=r;a++){let c=i.doc.line(a);c.length<=l&&o.push(z.range(c.from+s,c.to+l))}}else{let s=Math.min(e.col,t.col),l=Math.max(e.col,t.col);for(let a=n;a<=r;a++){let c=i.doc.line(a),h=zl(c.text,s,i.tabSize,!0);if(h<0)o.push(z.cursor(c.to));else{let d=zl(c.text,l,i.tabSize);o.push(z.range(c.from+h,c.from+d))}}}return o}function Iw(i,e){let t=i.coordsAtPos(i.viewport.from);return t?Math.round(Math.abs((t.left-e)/i.defaultCharacterWidth)):-1}function Hh(i,e){let t=i.posAtCoords({x:e.clientX,y:e.clientY},!1),n=i.state.doc.lineAt(t),r=t-n.from,o=r>ra?-1:r==n.length?Iw(i,e.clientX):eo(n.text,i.state.tabSize,t-n.from);return{line:n.number,col:o,off:r}}function Nw(i,e){let t=Hh(i,e),n=i.state.selection;return t?{update(r){if(r.docChanged){let o=r.changes.mapPos(r.startState.doc.line(t.line).from),s=r.state.doc.lineAt(o);t={line:s.number,col:t.col,off:Math.min(t.off,s.length)},n=n.map(r.changes)}},get(r,o,s){let l=Hh(i,r);if(!l)return n;let a=Ew(i.state,t,l);return a.length?s?z.create(a.concat(n.ranges)):z.create(a):n}}:null}function zw(i){let e=(i==null?void 0:i.eventFilter)||(t=>t.altKey&&t.button==0);return he.mouseSelectionStyle.of((t,n)=>e(n)?Nw(t,n):null)}const Fw={Alt:[18,i=>!!i.altKey],Control:[17,i=>!!i.ctrlKey],Shift:[16,i=>!!i.shiftKey],Meta:[91,i=>!!i.metaKey]},$w={style:"cursor: crosshair"};function Hw(i={}){let[e,t]=Fw[i.key||"Alt"],n=ht.fromClass(class{constructor(r){this.view=r,this.isDown=!1}set(r){this.isDown!=r&&(this.isDown=r,this.view.update([]))}},{eventHandlers:{keydown(r){this.set(r.keyCode==e||t(r))},keyup(r){(r.keyCode==e||!t(r))&&this.set(!1)},mousemove(r){this.set(t(r))}}});return[n,he.contentAttributes.of(r=>{var o;return!((o=r.plugin(n))===null||o===void 0)&&o.isDown?$w:null})]}const Ao="-10000px";class sp{constructor(e,t,n){this.facet=t,this.createTooltipView=n,this.input=e.state.facet(t),this.tooltips=this.input.filter(r=>r),this.tooltipViews=this.tooltips.map(n)}update(e){var t;let n=e.state.facet(this.facet),r=n.filter(s=>s);if(n===this.input){for(let s of this.tooltipViews)s.update&&s.update(e);return!1}let o=[];for(let s=0;s<r.length;s++){let l=r[s],a=-1;if(l){for(let c=0;c<this.tooltips.length;c++){let h=this.tooltips[c];h&&h.create==l.create&&(a=c)}if(a<0)o[s]=this.createTooltipView(l);else{let c=o[s]=this.tooltipViews[a];c.update&&c.update(e)}}}for(let s of this.tooltipViews)o.indexOf(s)<0&&(s.dom.remove(),(t=s.destroy)===null||t===void 0||t.call(s));return this.input=n,this.tooltips=r,this.tooltipViews=o,!0}}function jw(i){let{win:e}=i;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const hl=de.define({combine:i=>{var e,t,n;return{position:ce.ios?"absolute":((e=i.find(r=>r.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=i.find(r=>r.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((n=i.find(r=>r.tooltipSpace))===null||n===void 0?void 0:n.tooltipSpace)||jw}}}),jh=new WeakMap,lp=ht.fromClass(class{constructor(i){this.view=i,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1;let e=i.state.facet(hl);this.position=e.position,this.parent=e.parent,this.classes=i.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new sp(i,$a,t=>this.createTooltip(t)),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),i.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let i of this.manager.tooltipViews)this.intersectionObserver.observe(i.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(i){i.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(i);e&&this.observeIntersection();let t=e||i.geometryChanged,n=i.state.facet(hl);if(n.position!=this.position){this.position=n.position;for(let r of this.manager.tooltipViews)r.dom.style.position=this.position;t=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let r of this.manager.tooltipViews)this.container.appendChild(r.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(i){let e=i.create(this.view);if(e.dom.classList.add("cm-tooltip"),i.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let t=document.createElement("div");t.className="cm-tooltip-arrow",e.dom.appendChild(t)}return e.dom.style.position=this.position,e.dom.style.top=Ao,this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}destroy(){var i,e;this.view.win.removeEventListener("resize",this.measureSoon);for(let t of this.manager.tooltipViews)t.dom.remove(),(i=t.destroy)===null||i===void 0||i.call(t);(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let i=this.view.dom.getBoundingClientRect();return{editor:i,parent:this.parent?this.container.getBoundingClientRect():i,pos:this.manager.tooltips.map((e,t)=>{let n=this.manager.tooltipViews[t];return n.getCoords?n.getCoords(e.pos):this.view.coordsAtPos(e.pos)}),size:this.manager.tooltipViews.map(({dom:e})=>e.getBoundingClientRect()),space:this.view.state.facet(hl).tooltipSpace(this.view)}}writeMeasure(i){var e;let{editor:t,space:n}=i,r=[];for(let o=0;o<this.manager.tooltips.length;o++){let s=this.manager.tooltips[o],l=this.manager.tooltipViews[o],{dom:a}=l,c=i.pos[o],h=i.size[o];if(!c||c.bottom<=Math.max(t.top,n.top)||c.top>=Math.min(t.bottom,n.bottom)||c.right<Math.max(t.left,n.left)-.1||c.left>Math.min(t.right,n.right)+.1){a.style.top=Ao;continue}let d=s.arrow?l.dom.querySelector(".cm-tooltip-arrow"):null,u=d?7:0,f=h.right-h.left,g=(e=jh.get(l))!==null&&e!==void 0?e:h.bottom-h.top,x=l.offset||Vw,b=this.view.textDirection==Ge.LTR,S=h.width>n.right-n.left?b?n.left:n.right-h.width:b?Math.min(c.left-(d?14:0)+x.x,n.right-f):Math.max(n.left,c.left-f+(d?14:0)-x.x),A=!!s.above;!s.strictSide&&(A?c.top-(h.bottom-h.top)-x.y<n.top:c.bottom+(h.bottom-h.top)+x.y>n.bottom)&&A==n.bottom-c.bottom>c.top-n.top&&(A=!A);let O=(A?c.top-n.top:n.bottom-c.bottom)-u;if(O<g&&l.resize!==!1){if(O<this.view.defaultLineHeight){a.style.top=Ao;continue}jh.set(l,g),a.style.height=(g=O)+"px"}else a.style.height&&(a.style.height="");let R=A?c.top-g-u-x.y:c.bottom+u+x.y,k=S+f;if(l.overlap!==!0)for(let C of r)C.left<k&&C.right>S&&C.top<R+g&&C.bottom>R&&(R=A?C.top-g-2-u:C.bottom+u+2);this.position=="absolute"?(a.style.top=R-i.parent.top+"px",a.style.left=S-i.parent.left+"px"):(a.style.top=R+"px",a.style.left=S+"px"),d&&(d.style.left=`${c.left+(b?x.x:-x.x)-(S+14-7)}px`),l.overlap!==!0&&r.push({left:S,top:R,right:k,bottom:R+g}),a.classList.toggle("cm-tooltip-above",A),a.classList.toggle("cm-tooltip-below",!A),l.positioned&&l.positioned(i.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let i of this.manager.tooltipViews)i.dom.style.top=Ao}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),Ww=he.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),Vw={x:0,y:0},$a=de.define({enables:[lp,Ww]}),ns=de.define();class Ha{static create(e){return new Ha(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new sp(e,ns,t=>this.createHostedView(t))}createHostedView(e){let t=e.create(this.view);return t.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(t.dom),this.mounted&&t.mount&&t.mount(this.view),t}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}}const Uw=$a.compute([ns],i=>{let e=i.facet(ns).filter(t=>t);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.filter(t=>t.end!=null).map(t=>t.end)),create:Ha.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class Kw{constructor(e,t,n,r,o){this.view=e,this.source=t,this.field=n,this.setHover=r,this.hoverTime=o,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{lastMove:e}=this,t=this.view.contentDOM.contains(e.target)?this.view.posAtCoords(e):null;if(t==null)return;let n=this.view.coordsAtPos(t);if(n==null||e.y<n.top||e.y>n.bottom||e.x<n.left-this.view.defaultCharacterWidth||e.x>n.right+this.view.defaultCharacterWidth)return;let r=this.view.bidiSpans(this.view.state.doc.lineAt(t)).find(l=>l.from<=t&&l.to>=t),o=r&&r.dir==Ge.RTL?-1:1,s=this.source(this.view,t,e.x<n.left?-o:o);if(s!=null&&s.then){let l=this.pending={pos:t};s.then(a=>{this.pending==l&&(this.pending=null,a&&this.view.dispatch({effects:this.setHover.of(a)}))},a=>Qt(this.view.state,a,"hover tooltip"))}else s&&this.view.dispatch({effects:this.setHover.of(s)})}mousemove(e){var t;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let n=this.active;if(n&&!Wh(this.lastMove.target)||this.pending){let{pos:r}=n||this.pending,o=(t=n==null?void 0:n.end)!==null&&t!==void 0?t:r;(r==o?this.view.posAtCoords(this.lastMove)!=r:!qw(this.view,r,o,e.clientX,e.clientY,6))&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&!Wh(e.relatedTarget)&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function Wh(i){for(let e=i;e;e=e.parentNode)if(e.nodeType==1&&e.classList.contains("cm-tooltip"))return!0;return!1}function qw(i,e,t,n,r,o){let s=document.createRange(),l=i.domAtPos(e),a=i.domAtPos(t);s.setEnd(a.node,a.offset),s.setStart(l.node,l.offset);let c=s.getClientRects();s.detach();for(let h=0;h<c.length;h++){let d=c[h];if(Math.max(d.top-r,r-d.bottom,d.left-n,n-d.right)<=o)return!0}return!1}function _w(i,e={}){let t=Ce.define(),n=mt.define({create(){return null},update(r,o){if(r&&(e.hideOnChange&&(o.docChanged||o.selection)||e.hideOn&&e.hideOn(o,r)))return null;if(r&&o.docChanged){let s=o.changes.mapPos(r.pos,-1,St.TrackDel);if(s==null)return null;let l=Object.assign(Object.create(null),r);l.pos=s,r.end!=null&&(l.end=o.changes.mapPos(r.end)),r=l}for(let s of o.effects)s.is(t)&&(r=s.value),s.is(Gw)&&(r=null);return r},provide:r=>ns.from(r)});return[n,ht.define(r=>new Kw(r,i,n,t,e.hoverTime||300)),Uw]}function ap(i,e){let t=i.plugin(lp);if(!t)return null;let n=t.manager.tooltips.indexOf(e);return n<0?null:t.manager.tooltipViews[n]}const Gw=Ce.define(),Vh=de.define({combine(i){let e,t;for(let n of i)e=e||n.topContainer,t=t||n.bottomContainer;return{topContainer:e,bottomContainer:t}}});function qr(i,e){let t=i.plugin(cp),n=t?t.specs.indexOf(e):-1;return n>-1?t.panels[n]:null}const cp=ht.fromClass(class{constructor(i){this.input=i.state.facet(_r),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(i));let e=i.state.facet(Vh);this.top=new Ro(i,!0,e.topContainer),this.bottom=new Ro(i,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(i){let e=i.state.facet(Vh);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Ro(i.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Ro(i.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=i.state.facet(_r);if(t!=this.input){let n=t.filter(a=>a),r=[],o=[],s=[],l=[];for(let a of n){let c=this.specs.indexOf(a),h;c<0?(h=a(i.view),l.push(h)):(h=this.panels[c],h.update&&h.update(i)),r.push(h),(h.top?o:s).push(h)}this.specs=n,this.panels=r,this.top.sync(o),this.bottom.sync(s);for(let a of l)a.dom.classList.add("cm-panel"),a.mount&&a.mount()}else for(let n of this.panels)n.update&&n.update(i)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:i=>he.scrollMargins.of(e=>{let t=e.plugin(i);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class Ro{constructor(e,t,n){this.view=e,this.top=t,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=Uh(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=Uh(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function Uh(i){let e=i.nextSibling;return i.remove(),e}const _r=de.define({enables:cp});class Ei extends yn{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Ei.prototype.elementClass="";Ei.prototype.toDOM=void 0;Ei.prototype.mapMode=St.TrackBefore;Ei.prototype.startSide=Ei.prototype.endSide=-1;Ei.prototype.point=!0;const Wo=de.define(),Xw={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>Be.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Br=de.define();function Yw(i){return[hp(),Br.of(Object.assign(Object.assign({},Xw),i))]}const oa=de.define({combine:i=>i.some(e=>e)});function hp(i){let e=[Jw];return i&&i.fixed===!1&&e.push(oa.of(!0)),e}const Jw=ht.fromClass(class{constructor(i){this.view=i,this.prevViewport=i.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=i.state.facet(Br).map(e=>new qh(i,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!i.state.facet(oa),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),i.scrollDOM.insertBefore(this.dom,i.contentDOM)}update(i){if(this.updateGutters(i)){let e=this.prevViewport,t=i.view.viewport,n=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(n<(t.to-t.from)*.8)}i.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(oa)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=i.view.viewport}syncGutters(i){let e=this.dom.nextSibling;i&&this.dom.remove();let t=Be.iter(this.view.state.facet(Wo),this.view.viewport.from),n=[],r=this.gutters.map(o=>new Zw(o,this.view.viewport,-this.view.documentPadding.top));for(let o of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(o.type)){let s=!0;for(let l of o.type)if(l.type==Je.Text&&s){sa(t,n,l.from);for(let a of r)a.line(this.view,l,n);s=!1}else if(l.widget)for(let a of r)a.widget(this.view,l)}else if(o.type==Je.Text){sa(t,n,o.from);for(let s of r)s.line(this.view,o,n)}for(let o of r)o.finish();i&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(i){let e=i.startState.facet(Br),t=i.state.facet(Br),n=i.docChanged||i.heightChanged||i.viewportChanged||!Be.eq(i.startState.facet(Wo),i.state.facet(Wo),i.view.viewport.from,i.view.viewport.to);if(e==t)for(let r of this.gutters)r.update(i)&&(n=!0);else{n=!0;let r=[];for(let o of t){let s=e.indexOf(o);s<0?r.push(new qh(this.view,o)):(this.gutters[s].update(i),r.push(this.gutters[s]))}for(let o of this.gutters)o.dom.remove(),r.indexOf(o)<0&&o.destroy();for(let o of r)this.dom.appendChild(o.dom);this.gutters=r}return n}destroy(){for(let i of this.gutters)i.destroy();this.dom.remove()}},{provide:i=>he.scrollMargins.of(e=>{let t=e.plugin(i);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==Ge.LTR?{left:t.dom.offsetWidth}:{right:t.dom.offsetWidth}})});function Kh(i){return Array.isArray(i)?i:[i]}function sa(i,e,t){for(;i.value&&i.from<=t;)i.from==t&&e.push(i.value),i.next()}class Zw{constructor(e,t,n){this.gutter=e,this.height=n,this.i=0,this.cursor=Be.iter(e.markers,t.from)}addElement(e,t,n){let{gutter:r}=this,o=t.top-this.height;if(this.i==r.elements.length){let s=new dp(e,t.height,o,n);r.elements.push(s),r.dom.appendChild(s.dom)}else r.elements[this.i].update(e,t.height,o,n);this.height=t.bottom,this.i++}line(e,t,n){let r=[];sa(this.cursor,r,t.from),n.length&&(r=r.concat(n));let o=this.gutter.config.lineMarker(e,t,r);o&&r.unshift(o);let s=this.gutter;r.length==0&&!s.config.renderEmptyElements||this.addElement(e,t,r)}widget(e,t){let n=this.gutter.config.widgetMarker(e,t.widget,t);n&&this.addElement(e,t,[n])}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class qh{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in t.domEventHandlers)this.dom.addEventListener(n,r=>{let o=r.target,s;if(o!=this.dom&&this.dom.contains(o)){for(;o.parentNode!=this.dom;)o=o.parentNode;let a=o.getBoundingClientRect();s=(a.top+a.bottom)/2}else s=r.clientY;let l=e.lineBlockAtHeight(s-e.documentTop);t.domEventHandlers[n](e,l,r)&&r.preventDefault()});this.markers=Kh(t.markers(e)),t.initialSpacer&&(this.spacer=new dp(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=Kh(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let r=this.config.updateSpacer(this.spacer.markers[0],e);r!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[r])}let n=e.view.viewport;return!Be.eq(this.markers,t,n.from,n.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class dp{constructor(e,t,n,r){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,n,r)}update(e,t,n,r){this.height!=t&&(this.dom.style.height=(this.height=t)+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),Qw(this.markers,r)||this.setMarkers(e,r)}setMarkers(e,t){let n="cm-gutterElement",r=this.dom.firstChild;for(let o=0,s=0;;){let l=s,a=o<t.length?t[o++]:null,c=!1;if(a){let h=a.elementClass;h&&(n+=" "+h);for(let d=s;d<this.markers.length;d++)if(this.markers[d].compare(a)){l=d,c=!0;break}}else l=this.markers.length;for(;s<l;){let h=this.markers[s++];if(h.toDOM){h.destroy(r);let d=r.nextSibling;r.remove(),r=d}}if(!a)break;a.toDOM&&(c?r=r.nextSibling:this.dom.insertBefore(a.toDOM(e),r)),c&&s++}this.dom.className=n,this.markers=t}destroy(){this.setMarkers(null,[])}}function Qw(i,e){if(i.length!=e.length)return!1;for(let t=0;t<i.length;t++)if(!i[t].compare(e[t]))return!1;return!0}const ex=de.define(),$n=de.define({combine(i){return Ai(i,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let n=Object.assign({},e);for(let r in t){let o=n[r],s=t[r];n[r]=o?(l,a,c)=>o(l,a,c)||s(l,a,c):s}return n}})}});class dl extends Ei{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function ul(i,e){return i.state.facet($n).formatNumber(e,i.state)}const tx=Br.compute([$n],i=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(ex)},lineMarker(e,t,n){return n.some(r=>r.toDOM)?null:new dl(ul(e,e.state.doc.lineAt(t.from).number))},widgetMarker:()=>null,lineMarkerChange:e=>e.startState.facet($n)!=e.state.facet($n),initialSpacer(e){return new dl(ul(e,_h(e.state.doc.lines)))},updateSpacer(e,t){let n=ul(t.view,_h(t.view.state.doc.lines));return n==e.number?e:new dl(n)},domEventHandlers:i.facet($n).domEventHandlers}));function ix(i={}){return[$n.of(i),hp(),tx]}function _h(i){let e=9;for(;e<i;)e=e*10+9;return e}const nx=new class extends Ei{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},rx=Wo.compute(["selection"],i=>{let e=[],t=-1;for(let n of i.selection.ranges){let r=i.doc.lineAt(n.head).from;r>t&&(t=r,e.push(nx.range(r)))}return Be.of(e)});function ox(){return rx}const sx=1024;let lx=0;class fl{constructor(e,t){this.from=e,this.to=t}}class Re{constructor(e={}){this.id=lx++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Nt.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}}Re.closedBy=new Re({deserialize:i=>i.split(" ")});Re.openedBy=new Re({deserialize:i=>i.split(" ")});Re.group=new Re({deserialize:i=>i.split(" ")});Re.contextHash=new Re({perNode:!0});Re.lookAhead=new Re({perNode:!0});Re.mounted=new Re({perNode:!0});const ax=Object.create(null);class Nt{constructor(e,t,n,r=0){this.name=e,this.props=t,this.id=n,this.flags=r}static define(e){let t=e.props&&e.props.length?Object.create(null):ax,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),r=new Nt(e.name||"",t,e.id,n);if(e.props){for(let o of e.props)if(Array.isArray(o)||(o=o(r)),o){if(o[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[o[0].id]=o[1]}}return r}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(Re.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let r of n.split(" "))t[r]=e[n];return n=>{for(let r=n.prop(Re.group),o=-1;o<(r?r.length:0);o++){let s=t[o<0?n.name:r[o]];if(s)return s}}}}Nt.none=new Nt("",Object.create(null),0,8);class ja{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let n of this.types){let r=null;for(let o of e){let s=o(n);s&&(r||(r=Object.assign({},n.props)),r[s[0].id]=s[1])}t.push(r?new Nt(n.name,r,n.id,n.flags):n)}return new ja(t)}}const Mo=new WeakMap,Gh=new WeakMap;var xt;(function(i){i[i.ExcludeBuffers=1]="ExcludeBuffers",i[i.IncludeAnonymous=2]="IncludeAnonymous",i[i.IgnoreMounts=4]="IgnoreMounts",i[i.IgnoreOverlays=8]="IgnoreOverlays"})(xt||(xt={}));class Xe{constructor(e,t,n,r,o){if(this.type=e,this.children=t,this.positions=n,this.length=r,this.props=null,o&&o.length){this.props=Object.create(null);for(let[s,l]of o)this.props[typeof s=="number"?s:s.id]=l}}toString(){let e=this.prop(Re.mounted);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let r=n.toString();r&&(t&&(t+=","),t+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new ss(this.topNode,e)}cursorAt(e,t=0,n=0){let r=Mo.get(this)||this.topNode,o=new ss(r);return o.moveTo(e,t),Mo.set(this,o._tree),o}get topNode(){return new Pi(this,0,0,null)}resolve(e,t=0){let n=er(Mo.get(this)||this.topNode,e,t,!1);return Mo.set(this,n),n}resolveInner(e,t=0){let n=er(Gh.get(this)||this.topNode,e,t,!0);return Gh.set(this,n),n}iterate(e){let{enter:t,leave:n,from:r=0,to:o=this.length}=e;for(let s=this.cursor((e.mode||0)|xt.IncludeAnonymous);;){let l=!1;if(s.from<=o&&s.to>=r&&(s.type.isAnonymous||t(s)!==!1)){if(s.firstChild())continue;l=!0}for(;l&&n&&!s.type.isAnonymous&&n(s),!s.nextSibling();){if(!s.parent())return;l=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Ua(Nt.none,this.children,this.positions,0,this.children.length,0,this.length,(t,n,r)=>new Xe(this.type,t,n,r,this.propValues),e.makeTree||((t,n,r)=>new Xe(Nt.none,t,n,r)))}static build(e){return hx(e)}}Xe.empty=new Xe(Nt.none,[],[],0);class Wa{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Wa(this.buffer,this.index)}}class An{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return Nt.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],r=this.set.types[t],o=r.name;if(/\W/.test(o)&&!r.isError&&(o=JSON.stringify(o)),e+=4,n==e)return o;let s=[];for(;e<n;)s.push(this.childString(e)),e=this.buffer[e+3];return o+"("+s.join(",")+")"}findChild(e,t,n,r,o){let{buffer:s}=this,l=-1;for(let a=e;a!=t&&!(up(o,r,s[a+1],s[a+2])&&(l=a,n>0));a=s[a+3]);return l}slice(e,t,n){let r=this.buffer,o=new Uint16Array(t-e),s=0;for(let l=e,a=0;l<t;){o[a++]=r[l++],o[a++]=r[l++]-n;let c=o[a++]=r[l++]-n;o[a++]=r[l++]-e,s=Math.max(s,c)}return new An(o,s,this.set)}}function up(i,e,t,n){switch(i){case-2:return t<e;case-1:return n>=e&&t<e;case 0:return t<e&&n>e;case 1:return t<=e&&n>e;case 2:return n>e;case 4:return!0}}function fp(i,e){let t=i.childBefore(e);for(;t;){let n=t.lastChild;if(!n||n.to!=t.to)break;n.type.isError&&n.from==n.to?(i=t,t=n.prevSibling):t=n}return i}function er(i,e,t,n){for(var r;i.from==i.to||(t<1?i.from>=e:i.from>e)||(t>-1?i.to<=e:i.to<e);){let s=!n&&i instanceof Pi&&i.index<0?null:i.parent;if(!s)return i;i=s}let o=n?0:xt.IgnoreOverlays;if(n)for(let s=i,l=s.parent;l;s=l,l=s.parent)s instanceof Pi&&s.index<0&&((r=l.enter(e,t,o))===null||r===void 0?void 0:r.from)!=s.from&&(i=l);for(;;){let s=i.enter(e,t,o);if(!s)return i;i=s}}class Pi{constructor(e,t,n,r){this._tree=e,this.from=t,this.index=n,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,r,o=0){for(let s=this;;){for(let{children:l,positions:a}=s._tree,c=t>0?l.length:-1;e!=c;e+=t){let h=l[e],d=a[e]+s.from;if(up(r,n,d,d+h.length)){if(h instanceof An){if(o&xt.ExcludeBuffers)continue;let u=h.findChild(0,h.buffer.length,t,n-d,r);if(u>-1)return new _i(new cx(s,h,e,d),null,u)}else if(o&xt.IncludeAnonymous||!h.type.isAnonymous||Va(h)){let u;if(!(o&xt.IgnoreMounts)&&h.props&&(u=h.prop(Re.mounted))&&!u.overlay)return new Pi(u.tree,d,e,s);let f=new Pi(h,d,e,s);return o&xt.IncludeAnonymous||!f.type.isAnonymous?f:f.nextChild(t<0?h.children.length-1:0,t,n,r)}}}if(o&xt.IncludeAnonymous||!s.type.isAnonymous||(s.index>=0?e=s.index+t:e=t<0?-1:s._parent._tree.children.length,s=s._parent,!s))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let r;if(!(n&xt.IgnoreOverlays)&&(r=this._tree.prop(Re.mounted))&&r.overlay){let o=e-this.from;for(let{from:s,to:l}of r.overlay)if((t>0?s<=o:s<o)&&(t<0?l>=o:l>o))return new Pi(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(e=0){return new ss(this,e)}get tree(){return this._tree}toTree(){return this._tree}resolve(e,t=0){return er(this,e,t,!1)}resolveInner(e,t=0){return er(this,e,t,!0)}enterUnfinishedNodesBefore(e){return fp(this,e)}getChild(e,t=null,n=null){let r=rs(this,e,t,n);return r.length?r[0]:null}getChildren(e,t=null,n=null){return rs(this,e,t,n)}toString(){return this._tree.toString()}get node(){return this}matchContext(e){return os(this,e)}}function rs(i,e,t,n){let r=i.cursor(),o=[];if(!r.firstChild())return o;if(t!=null){for(;!r.type.is(t);)if(!r.nextSibling())return o}for(;;){if(n!=null&&r.type.is(n))return o;if(r.type.is(e)&&o.push(r.node),!r.nextSibling())return n==null?o:[]}}function os(i,e,t=e.length-1){for(let n=i.parent;t>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[t]&&e[t]!=n.name)return!1;t--}}return!0}class cx{constructor(e,t,n,r){this.parent=e,this.buffer=t,this.index=n,this.start=r}}class _i{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:r}=this.context,o=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.context.start,n);return o<0?null:new _i(this.context,this,o)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&xt.ExcludeBuffers)return null;let{buffer:r}=this.context,o=r.findChild(this.index+4,r.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return o<0?null:new _i(this.context,this,o)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new _i(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new _i(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}cursor(e=0){return new ss(this,e)}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,r=this.index+4,o=n.buffer[this.index+3];if(o>r){let s=n.buffer[this.index+1];e.push(n.slice(r,o,s)),t.push(0)}return new Xe(this.type,e,t,this.to-this.from)}resolve(e,t=0){return er(this,e,t,!1)}resolveInner(e,t=0){return er(this,e,t,!0)}enterUnfinishedNodesBefore(e){return fp(this,e)}toString(){return this.context.buffer.childString(this.index)}getChild(e,t=null,n=null){let r=rs(this,e,t,n);return r.length?r[0]:null}getChildren(e,t=null,n=null){return rs(this,e,t,n)}get node(){return this}matchContext(e){return os(this,e)}}class ss{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Pi)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:n,buffer:r}=this.buffer;return this.type=t||r.set.types[r.buffer[e]],this.from=n+r.buffer[e+1],this.to=n+r.buffer[e+2],!0}yield(e){return e?e instanceof Pi?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:r}=this.buffer,o=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.buffer.start,n);return o<0?!1:(this.stack.push(this.index),this.yieldBuf(o))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?n&xt.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&xt.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&xt.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let r=n<0?0:this.stack[n]+4;if(this.index!=r)return this.yieldBuf(t.findChild(r,this.index,-1,0,4))}else{let r=t.buffer[this.index+3];if(r<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(r)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:r}=this;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return!1}else for(let o=0;o<this.index;o++)if(r.buffer.buffer[o+3]<this.index)return!1;({index:t,parent:n}=r)}else({index:t,_parent:n}=this._tree);for(;n;{index:t,_parent:n}=n)if(t>-1)for(let o=t+e,s=e<0?-1:n._tree.children.length;o!=s;o+=e){let l=n._tree.children[o];if(this.mode&xt.IncludeAnonymous||l instanceof An||!l.type.isAnonymous||Va(l))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let r=this.index,o=this.stack.length;o>=0;){for(let s=e;s;s=s._parent)if(s.index==r){if(r==this.index)return s;t=s,n=o+1;break e}r=this.stack[--o]}for(let r=n;r<this.stack.length;r++)t=new _i(this.buffer,t,this.stack[r]);return this.bufferNode=new _i(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let r=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(r=!0)}for(;r&&t&&t(this),r=this.type.isAnonymous,!this.nextSibling();){if(!n)return;this.parent(),n--,r=!0}}}matchContext(e){if(!this.buffer)return os(this.node,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let r=e.length-1,o=this.stack.length-1;r>=0;o--){if(o<0)return os(this.node,e,r);let s=n[t.buffer[this.stack[o]]];if(!s.isAnonymous){if(e[r]&&e[r]!=s.name)return!1;r--}}return!0}}function Va(i){return i.children.some(e=>e instanceof An||!e.type.isAnonymous||Va(e))}function hx(i){var e;let{buffer:t,nodeSet:n,maxBufferLength:r=sx,reused:o=[],minRepeatType:s=n.types.length}=i,l=Array.isArray(t)?new Wa(t,t.length):t,a=n.types,c=0,h=0;function d(R,k,C,w,D){let{id:v,start:W,end:q,size:ne}=l,Y=h;for(;ne<0;)if(l.next(),ne==-1){let E=o[v];C.push(E),w.push(W-R);return}else if(ne==-3){c=v;return}else if(ne==-4){h=v;return}else throw new RangeError(`Unrecognized record size: ${ne}`);let re=a[v],oe,$,te=W-R;if(q-W<=r&&($=x(l.pos-k,D))){let E=new Uint16Array($.size-$.skip),V=l.pos-$.size,H=E.length;for(;l.pos>V;)H=b($.start,E,H);oe=new An(E,q-$.start,n),te=$.start-R}else{let E=l.pos-ne;l.next();let V=[],H=[],G=v>=s?v:-1,ue=0,ke=q;for(;l.pos>E;)G>=0&&l.id==G&&l.size>=0?(l.end<=ke-r&&(f(V,H,W,ue,l.end,ke,G,Y),ue=V.length,ke=l.end),l.next()):d(W,E,V,H,G);if(G>=0&&ue>0&&ue<V.length&&f(V,H,W,ue,W,ke,G,Y),V.reverse(),H.reverse(),G>-1&&ue>0){let $e=u(re);oe=Ua(re,V,H,0,V.length,0,q-W,$e,$e)}else oe=g(re,V,H,q-W,Y-q)}C.push(oe),w.push(te)}function u(R){return(k,C,w)=>{let D=0,v=k.length-1,W,q;if(v>=0&&(W=k[v])instanceof Xe){if(!v&&W.type==R&&W.length==w)return W;(q=W.prop(Re.lookAhead))&&(D=C[v]+W.length+q)}return g(R,k,C,w,D)}}function f(R,k,C,w,D,v,W,q){let ne=[],Y=[];for(;R.length>w;)ne.push(R.pop()),Y.push(k.pop()+C-D);R.push(g(n.types[W],ne,Y,v-D,q-v)),k.push(D-C)}function g(R,k,C,w,D=0,v){if(c){let W=[Re.contextHash,c];v=v?[W].concat(v):[W]}if(D>25){let W=[Re.lookAhead,D];v=v?[W].concat(v):[W]}return new Xe(R,k,C,w,v)}function x(R,k){let C=l.fork(),w=0,D=0,v=0,W=C.end-r,q={size:0,start:0,skip:0};e:for(let ne=C.pos-R;C.pos>ne;){let Y=C.size;if(C.id==k&&Y>=0){q.size=w,q.start=D,q.skip=v,v+=4,w+=4,C.next();continue}let re=C.pos-Y;if(Y<0||re<ne||C.start<W)break;let oe=C.id>=s?4:0,$=C.start;for(C.next();C.pos>re;){if(C.size<0)if(C.size==-3)oe+=4;else break e;else C.id>=s&&(oe+=4);C.next()}D=$,w+=Y,v+=oe}return(k<0||w==R)&&(q.size=w,q.start=D,q.skip=v),q.size>4?q:void 0}function b(R,k,C){let{id:w,start:D,end:v,size:W}=l;if(l.next(),W>=0&&w<s){let q=C;if(W>4){let ne=l.pos-(W-4);for(;l.pos>ne;)C=b(R,k,C)}k[--C]=q,k[--C]=v-R,k[--C]=D-R,k[--C]=w}else W==-3?c=w:W==-4&&(h=w);return C}let S=[],A=[];for(;l.pos>0;)d(i.start||0,i.bufferStart||0,S,A,-1);let O=(e=i.length)!==null&&e!==void 0?e:S.length?A[0]+S[0].length:0;return new Xe(a[i.topID],S.reverse(),A.reverse(),O)}const Xh=new WeakMap;function Vo(i,e){if(!i.isAnonymous||e instanceof An||e.type!=i)return 1;let t=Xh.get(e);if(t==null){t=1;for(let n of e.children){if(n.type!=i||!(n instanceof Xe)){t=1;break}t+=Vo(i,n)}Xh.set(e,t)}return t}function Ua(i,e,t,n,r,o,s,l,a){let c=0;for(let g=n;g<r;g++)c+=Vo(i,e[g]);let h=Math.ceil(c*1.5/8),d=[],u=[];function f(g,x,b,S,A){for(let O=b;O<S;){let R=O,k=x[O],C=Vo(i,g[O]);for(O++;O<S;O++){let w=Vo(i,g[O]);if(C+w>=h)break;C+=w}if(O==R+1){if(C>h){let w=g[R];f(w.children,w.positions,0,w.children.length,x[R]+A);continue}d.push(g[R])}else{let w=x[O-1]+g[O-1].length-k;d.push(Ua(i,g,x,R,O,k,w,null,a))}u.push(k+A-o)}}return f(e,t,n,r,0),(l||a)(d,u,s)}class mn{constructor(e,t,n,r,o=!1,s=!1){this.from=e,this.to=t,this.tree=n,this.offset=r,this.open=(o?1:0)|(s?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],n=!1){let r=[new mn(0,e.length,e,0,!1,n)];for(let o of t)o.to>e.length&&r.push(o);return r}static applyChanges(e,t,n=128){if(!t.length)return e;let r=[],o=1,s=e.length?e[0]:null;for(let l=0,a=0,c=0;;l++){let h=l<t.length?t[l]:null,d=h?h.fromA:1e9;if(d-a>=n)for(;s&&s.from<d;){let u=s;if(a>=u.from||d<=u.to||c){let f=Math.max(u.from,a)-c,g=Math.min(u.to,d)-c;u=f>=g?null:new mn(f,g,u.tree,u.offset+c,l>0,!!h)}if(u&&r.push(u),s.to>d)break;s=o<e.length?e[o++]:null}if(!h)break;a=h.toA,c=h.toA-h.toB}return r}}class pp{startParse(e,t,n){return typeof e=="string"&&(e=new dx(e)),n=n?n.length?n.map(r=>new fl(r.from,r.to)):[new fl(0,0)]:[new fl(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let r=this.startParse(e,t,n);for(;;){let o=r.advance();if(o)return o}}}class dx{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new Re({perNode:!0});let ux=0;class bi{constructor(e,t,n){this.set=e,this.base=t,this.modified=n,this.id=ux++}static define(e){if(e!=null&&e.base)throw new Error("Can not derive from a modified tag");let t=new bi([],null,[]);if(t.set.push(t),e)for(let n of e.set)t.set.push(n);return t}static defineModifier(){let e=new ls;return t=>t.modified.indexOf(e)>-1?t:ls.get(t.base||t,t.modified.concat(e).sort((n,r)=>n.id-r.id))}}let fx=0;class ls{constructor(){this.instances=[],this.id=fx++}static get(e,t){if(!t.length)return e;let n=t[0].instances.find(l=>l.base==e&&px(t,l.modified));if(n)return n;let r=[],o=new bi(r,e,t);for(let l of t)l.instances.push(o);let s=gx(t);for(let l of e.set)if(!l.modified.length)for(let a of s)r.push(ls.get(l,a));return o}}function px(i,e){return i.length==e.length&&i.every((t,n)=>t==e[n])}function gx(i){let e=[[]];for(let t=0;t<i.length;t++)for(let n=0,r=e.length;n<r;n++)e.push(e[n].concat(i[t]));return e.sort((t,n)=>n.length-t.length)}function mx(i){let e=Object.create(null);for(let t in i){let n=i[t];Array.isArray(n)||(n=[n]);for(let r of t.split(" "))if(r){let o=[],s=2,l=r;for(let d=0;;){if(l=="..."&&d>0&&d+3==r.length){s=1;break}let u=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(l);if(!u)throw new RangeError("Invalid path: "+r);if(o.push(u[0]=="*"?"":u[0][0]=='"'?JSON.parse(u[0]):u[0]),d+=u[0].length,d==r.length)break;let f=r[d++];if(d==r.length&&f=="!"){s=0;break}if(f!="/")throw new RangeError("Invalid path: "+r);l=r.slice(d)}let a=o.length-1,c=o[a];if(!c)throw new RangeError("Invalid path: "+r);let h=new as(n,s,a>0?o.slice(0,a):null);e[c]=h.sort(e[c])}}return gp.add(e)}const gp=new Re;class as{constructor(e,t,n,r){this.tags=e,this.mode=t,this.context=n,this.next=r}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}as.empty=new as([],2,null);function mp(i,e){let t=Object.create(null);for(let o of i)if(!Array.isArray(o.tag))t[o.tag.id]=o.class;else for(let s of o.tag)t[s.id]=o.class;let{scope:n,all:r=null}=e||{};return{style:o=>{let s=r;for(let l of o)for(let a of l.set){let c=t[a.id];if(c){s=s?s+" "+c:c;break}}return s},scope:n}}function vx(i,e){let t=null;for(let n of i){let r=n.style(e);r&&(t=t?t+" "+r:r)}return t}function bx(i,e,t,n=0,r=i.length){let o=new yx(n,Array.isArray(e)?e:[e],t);o.highlightRange(i.cursor(),n,r,"",o.highlighters),o.flush(r)}class yx{constructor(e,t,n){this.at=e,this.highlighters=t,this.span=n,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,n,r,o){let{type:s,from:l,to:a}=e;if(l>=n||a<=t)return;s.isTop&&(o=this.highlighters.filter(f=>!f.scope||f.scope(s)));let c=r,h=wx(e)||as.empty,d=vx(o,h.tags);if(d&&(c&&(c+=" "),c+=d,h.mode==1&&(r+=(r?" ":"")+d)),this.startSpan(e.from,c),h.opaque)return;let u=e.tree&&e.tree.prop(Re.mounted);if(u&&u.overlay){let f=e.node.enter(u.overlay[0].from+l,1),g=this.highlighters.filter(b=>!b.scope||b.scope(u.tree.type)),x=e.firstChild();for(let b=0,S=l;;b++){let A=b<u.overlay.length?u.overlay[b]:null,O=A?A.from+l:a,R=Math.max(t,S),k=Math.min(n,O);if(R<k&&x)for(;e.from<k&&(this.highlightRange(e,R,k,r,o),this.startSpan(Math.min(k,e.to),c),!(e.to>=O||!e.nextSibling())););if(!A||O>n)break;S=A.to+l,S>t&&(this.highlightRange(f.cursor(),Math.max(t,A.from+l),Math.min(n,S),r,g),this.startSpan(S,c))}x&&e.parent()}else if(e.firstChild()){do if(!(e.to<=t)){if(e.from>=n)break;this.highlightRange(e,t,n,r,o),this.startSpan(Math.min(n,e.to),c)}while(e.nextSibling());e.parent()}}}function wx(i){let e=i.type.prop(gp);for(;e&&e.context&&!i.matchContext(e.context);)e=e.next;return e||null}const X=bi.define,Oo=X(),Wi=X(),Yh=X(Wi),Jh=X(Wi),Vi=X(),Do=X(Vi),pl=X(Vi),mi=X(),ln=X(mi),pi=X(),gi=X(),la=X(),xr=X(la),To=X(),P={comment:Oo,lineComment:X(Oo),blockComment:X(Oo),docComment:X(Oo),name:Wi,variableName:X(Wi),typeName:Yh,tagName:X(Yh),propertyName:Jh,attributeName:X(Jh),className:X(Wi),labelName:X(Wi),namespace:X(Wi),macroName:X(Wi),literal:Vi,string:Do,docString:X(Do),character:X(Do),attributeValue:X(Do),number:pl,integer:X(pl),float:X(pl),bool:X(Vi),regexp:X(Vi),escape:X(Vi),color:X(Vi),url:X(Vi),keyword:pi,self:X(pi),null:X(pi),atom:X(pi),unit:X(pi),modifier:X(pi),operatorKeyword:X(pi),controlKeyword:X(pi),definitionKeyword:X(pi),moduleKeyword:X(pi),operator:gi,derefOperator:X(gi),arithmeticOperator:X(gi),logicOperator:X(gi),bitwiseOperator:X(gi),compareOperator:X(gi),updateOperator:X(gi),definitionOperator:X(gi),typeOperator:X(gi),controlOperator:X(gi),punctuation:la,separator:X(la),bracket:xr,angleBracket:X(xr),squareBracket:X(xr),paren:X(xr),brace:X(xr),content:mi,heading:ln,heading1:X(ln),heading2:X(ln),heading3:X(ln),heading4:X(ln),heading5:X(ln),heading6:X(ln),contentSeparator:X(mi),list:X(mi),quote:X(mi),emphasis:X(mi),strong:X(mi),link:X(mi),monospace:X(mi),strikethrough:X(mi),inserted:X(),deleted:X(),changed:X(),invalid:X(),meta:To,documentMeta:X(To),annotation:X(To),processingInstruction:X(To),definition:bi.defineModifier(),constant:bi.defineModifier(),function:bi.defineModifier(),standard:bi.defineModifier(),local:bi.defineModifier(),special:bi.defineModifier()};mp([{tag:P.link,class:"tok-link"},{tag:P.heading,class:"tok-heading"},{tag:P.emphasis,class:"tok-emphasis"},{tag:P.strong,class:"tok-strong"},{tag:P.keyword,class:"tok-keyword"},{tag:P.atom,class:"tok-atom"},{tag:P.bool,class:"tok-bool"},{tag:P.url,class:"tok-url"},{tag:P.labelName,class:"tok-labelName"},{tag:P.inserted,class:"tok-inserted"},{tag:P.deleted,class:"tok-deleted"},{tag:P.literal,class:"tok-literal"},{tag:P.string,class:"tok-string"},{tag:P.number,class:"tok-number"},{tag:[P.regexp,P.escape,P.special(P.string)],class:"tok-string2"},{tag:P.variableName,class:"tok-variableName"},{tag:P.local(P.variableName),class:"tok-variableName tok-local"},{tag:P.definition(P.variableName),class:"tok-variableName tok-definition"},{tag:P.special(P.variableName),class:"tok-variableName2"},{tag:P.definition(P.propertyName),class:"tok-propertyName tok-definition"},{tag:P.typeName,class:"tok-typeName"},{tag:P.namespace,class:"tok-namespace"},{tag:P.className,class:"tok-className"},{tag:P.macroName,class:"tok-macroName"},{tag:P.propertyName,class:"tok-propertyName"},{tag:P.operator,class:"tok-operator"},{tag:P.comment,class:"tok-comment"},{tag:P.meta,class:"tok-meta"},{tag:P.invalid,class:"tok-invalid"},{tag:P.punctuation,class:"tok-punctuation"}]);var gl;const Hn=new Re;function xx(i){return de.define({combine:i?e=>e.concat(i):void 0})}const kx=new Re;class oi{constructor(e,t,n=[],r=""){this.data=e,this.name=r,Te.prototype.hasOwnProperty("tree")||Object.defineProperty(Te.prototype,"tree",{get(){return gt(this)}}),this.parser=t,this.extension=[nn.of(this),Te.languageData.of((o,s,l)=>{let a=Zh(o,s,l),c=a.type.prop(Hn);if(!c)return[];let h=o.facet(c),d=a.type.prop(kx);if(d){let u=a.resolve(s-a.from,l);for(let f of d)if(f.test(u,o)){let g=o.facet(f.facet);return f.type=="replace"?g:g.concat(h)}}return h})].concat(n)}isActiveAt(e,t,n=-1){return Zh(e,t,n).type.prop(Hn)==this.data}findRegions(e){let t=e.facet(nn);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],r=(o,s)=>{if(o.prop(Hn)==this.data){n.push({from:s,to:s+o.length});return}let l=o.prop(Re.mounted);if(l){if(l.tree.prop(Hn)==this.data){if(l.overlay)for(let a of l.overlay)n.push({from:a.from+s,to:a.to+s});else n.push({from:s,to:s+o.length});return}else if(l.overlay){let a=n.length;if(r(l.tree,l.overlay[0].from+s),n.length>a)return}}for(let a=0;a<o.children.length;a++){let c=o.children[a];c instanceof Xe&&r(c,o.positions[a]+s)}};return r(gt(e),0),n}get allowsNesting(){return!0}}oi.setState=Ce.define();function Zh(i,e,t){let n=i.facet(nn),r=gt(i).topNode;if(!n||n.allowsNesting)for(let o=r;o;o=o.enter(e,t,xt.ExcludeBuffers))o.type.isTop&&(r=o);return r}function gt(i){let e=i.field(oi.state,!1);return e?e.tree:Xe.empty}class Cx{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}}let kr=null;class tr{constructor(e,t,n=[],r,o,s,l,a){this.parser=e,this.state=t,this.fragments=n,this.tree=r,this.treeLen=o,this.viewport=s,this.skipped=l,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(e,t,n){return new tr(e,t,[],Xe.empty,0,n,[],null)}startParse(){return this.parser.startParse(new Cx(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=Xe.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let r=Date.now()+e;e=()=>Date.now()>r}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let r=this.parse.advance();if(r)if(this.fragments=this.withoutTempSkipped(mn.addTree(r,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=r,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(mn.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=kr;kr=this;try{return e()}finally{kr=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=Qh(e,t.from,t.to);return e}changes(e,t){let{fragments:n,tree:r,treeLen:o,viewport:s,skipped:l}=this;if(this.takeTree(),!e.empty){let a=[];if(e.iterChangedRanges((c,h,d,u)=>a.push({fromA:c,toA:h,fromB:d,toB:u})),n=mn.applyChanges(n,a),r=Xe.empty,o=0,s={from:e.mapPos(s.from,-1),to:e.mapPos(s.to,1)},this.skipped.length){l=[];for(let c of this.skipped){let h=e.mapPos(c.from,1),d=e.mapPos(c.to,-1);h<d&&l.push({from:h,to:d})}}}return new tr(this.parser,t,n,r,o,s,l,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:r,to:o}=this.skipped[n];r<e.to&&o>e.from&&(this.fragments=Qh(this.fragments,r,o),this.skipped.splice(n--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends pp{createParse(t,n,r){let o=r[0].from,s=r[r.length-1].to;return{parsedPos:o,advance(){let l=kr;if(l){for(let a of r)l.tempSkipped.push(a);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=s,new Xe(Nt.none,[],[],s-o)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return kr}}function Qh(i,e,t){return mn.applyChanges(i,[{fromA:e,toA:t,fromB:e,toB:t}])}class ir{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new ir(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=tr.create(e.facet(nn).parser,e,{from:0,to:t});return n.work(20,t)||n.takeTree(),new ir(n)}}oi.state=mt.define({create:ir.init,update(i,e){for(let t of e.effects)if(t.is(oi.setState))return t.value;return e.startState.facet(nn)!=e.state.facet(nn)?ir.init(e.state):i.apply(e)}});let vp=i=>{let e=setTimeout(()=>i(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(vp=i=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(i,{timeout:500-100})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const ml=typeof navigator<"u"&&!((gl=navigator.scheduling)===null||gl===void 0)&&gl.isInputPending?()=>navigator.scheduling.isInputPending():null,Sx=ht.fromClass(class{constructor(i){this.view=i,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(i){let e=this.view.state.field(oi.state).context;(e.updateViewport(i.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),i.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:i}=this.view,e=i.field(oi.state);(e.tree!=e.context.tree||!e.context.isDone(i.doc.length))&&(this.working=vp(this.work))}work(i){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:t,viewport:{to:n}}=this.view,r=t.field(oi.state);if(r.tree==r.context.tree&&r.context.isDone(n+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,i&&!ml?Math.max(25,i.timeRemaining()-5):1e9),s=r.context.treeLen<n&&t.doc.length>n+1e3,l=r.context.work(()=>ml&&ml()||Date.now()>o,n+(s?0:1e5));this.chunkBudget-=Date.now()-e,(l||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:oi.setState.of(new ir(r.context))})),this.chunkBudget>0&&!(l&&!s)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(i){i.scheduleOn&&(this.workScheduled++,i.scheduleOn.then(()=>this.scheduleWork()).catch(e=>Qt(this.view.state,e)).then(()=>this.workScheduled--),i.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),nn=de.define({combine(i){return i.length?i[0]:null},enables:i=>[oi.state,Sx,he.contentAttributes.compute([i],e=>{let t=e.facet(i);return t&&t.name?{"data-language":t.name}:{}})]}),bp=de.define(),Ka=de.define({combine:i=>{if(!i.length)return"  ";let e=i[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(i[0]));return e}});function kn(i){let e=i.facet(Ka);return e.charCodeAt(0)==9?i.tabSize*e.length:e.length}function Gr(i,e){let t="",n=i.tabSize,r=i.facet(Ka)[0];if(r=="	"){for(;e>=n;)t+="	",e-=n;r=" "}for(let o=0;o<e;o++)t+=r;return t}function qa(i,e){i instanceof Te&&(i=new Is(i));for(let n of i.state.facet(bp)){let r=n(i,e);if(r!==void 0)return r}let t=gt(i.state);return t?Rx(i,t,e):null}class Is{constructor(e,t={}){this.state=e,this.options=t,this.unit=kn(e)}lineAt(e,t=1){let n=this.state.doc.lineAt(e),{simulateBreak:r,simulateDoubleBreak:o}=this.options;return r!=null&&r>=n.from&&r<=n.to?o&&r==e?{text:"",from:e}:(t<0?r<e:r<=e)?{text:n.text.slice(r-n.from),from:r}:{text:n.text.slice(0,r-n.from),from:n.from}:n}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:n,from:r}=this.lineAt(e,t);return n.slice(e-r,Math.min(n.length,e+100-r))}column(e,t=1){let{text:n,from:r}=this.lineAt(e,t),o=this.countColumn(n,e-r),s=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return s>-1&&(o+=s-this.countColumn(n,n.search(/\S|$/))),o}countColumn(e,t=e.length){return eo(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:n,from:r}=this.lineAt(e,t),o=this.options.overrideIndentation;if(o){let s=o(r);if(s>-1)return s}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Ax=new Re;function Rx(i,e,t){return yp(e.resolveInner(t).enterUnfinishedNodesBefore(t),t,i)}function Mx(i){return i.pos==i.options.simulateBreak&&i.options.simulateDoubleBreak}function Ox(i){let e=i.type.prop(Ax);if(e)return e;let t=i.firstChild,n;if(t&&(n=t.type.prop(Re.closedBy))){let r=i.lastChild,o=r&&n.indexOf(r.name)>-1;return s=>Lx(s,!0,1,void 0,o&&!Mx(s)?r.from:void 0)}return i.parent==null?Dx:null}function yp(i,e,t){for(;i;i=i.parent){let n=Ox(i);if(n)return n(_a.create(t,e,i))}return null}function Dx(){return 0}class _a extends Is{constructor(e,t,n){super(e.state,e.options),this.base=e,this.pos=t,this.node=n}static create(e,t,n){return new _a(e,t,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let e=this.state.doc.lineAt(this.node.from);for(;;){let t=this.node.resolve(e.from);for(;t.parent&&t.parent.from==t.from;)t=t.parent;if(Tx(t,this.node))break;e=this.state.doc.lineAt(t.from)}return this.lineIndent(e.from)}continue(){let e=this.node.parent;return e?yp(e,this.pos,this.base):0}}function Tx(i,e){for(let t=e;t;t=t.parent)if(i==t)return!0;return!1}function Px(i){let e=i.node,t=e.childAfter(e.from),n=e.lastChild;if(!t)return null;let r=i.options.simulateBreak,o=i.state.doc.lineAt(t.from),s=r==null||r<=o.from?o.to:Math.min(o.to,r);for(let l=t.to;;){let a=e.childAfter(l);if(!a||a==n)return null;if(!a.type.isSkipped)return a.from<s?t:null;l=a.to}}function Lx(i,e,t,n,r){let o=i.textAfter,s=o.match(/^\s*/)[0].length,l=n&&o.slice(s,s+n.length)==n||r==i.pos+s,a=e?Px(i):null;return a?l?i.column(a.from):i.column(a.to):i.baseIndent+(l?0:i.unit*t)}const Bx=200;function Ex(){return Te.transactionFilter.of(i=>{if(!i.docChanged||!i.isUserEvent("input.type")&&!i.isUserEvent("input.complete"))return i;let e=i.startState.languageDataAt("indentOnInput",i.startState.selection.main.head);if(!e.length)return i;let t=i.newDoc,{head:n}=i.newSelection.main,r=t.lineAt(n);if(n>r.from+Bx)return i;let o=t.sliceString(r.from,n);if(!e.some(c=>c.test(o)))return i;let{state:s}=i,l=-1,a=[];for(let{head:c}of s.selection.ranges){let h=s.doc.lineAt(c);if(h.from==l)continue;l=h.from;let d=qa(s,h.from);if(d==null)continue;let u=/^\s*/.exec(h.text)[0],f=Gr(s,d);u!=f&&a.push({from:h.from,to:h.from+u.length,insert:f})}return a.length?[i,{changes:a,sequential:!0}]:i})}const Ix=de.define(),Nx=new Re;function zx(i,e,t){let n=gt(i);if(n.length<t)return null;let r=n.resolveInner(t,1),o=null;for(let s=r;s;s=s.parent){if(s.to<=t||s.from>t)continue;if(o&&s.from<e)break;let l=s.type.prop(Nx);if(l&&(s.to<n.length-50||n.length==i.doc.length||!Fx(s))){let a=l(s,i);a&&a.from<=t&&a.from>=e&&a.to>t&&(o=a)}}return o}function Fx(i){let e=i.lastChild;return e&&e.to==i.to&&e.type.isError}function cs(i,e,t){for(let n of i.facet(Ix)){let r=n(i,e,t);if(r)return r}return zx(i,e,t)}function wp(i,e){let t=e.mapPos(i.from,1),n=e.mapPos(i.to,-1);return t>=n?void 0:{from:t,to:n}}const Ns=Ce.define({map:wp}),no=Ce.define({map:wp});function xp(i){let e=[];for(let{head:t}of i.state.selection.ranges)e.some(n=>n.from<=t&&n.to>=t)||e.push(i.lineBlockAt(t));return e}const Cn=mt.define({create(){return be.none},update(i,e){i=i.map(e.changes);for(let t of e.effects)t.is(Ns)&&!$x(i,t.value.from,t.value.to)?i=i.update({add:[ed.range(t.value.from,t.value.to)]}):t.is(no)&&(i=i.update({filter:(n,r)=>t.value.from!=n||t.value.to!=r,filterFrom:t.value.from,filterTo:t.value.to}));if(e.selection){let t=!1,{head:n}=e.selection.main;i.between(n,n,(r,o)=>{r<n&&o>n&&(t=!0)}),t&&(i=i.update({filterFrom:n,filterTo:n,filter:(r,o)=>o<=n||r>=n}))}return i},provide:i=>he.decorations.from(i),toJSON(i,e){let t=[];return i.between(0,e.doc.length,(n,r)=>{t.push(n,r)}),t},fromJSON(i){if(!Array.isArray(i)||i.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<i.length;){let n=i[t++],r=i[t++];if(typeof n!="number"||typeof r!="number")throw new RangeError("Invalid JSON for fold state");e.push(ed.range(n,r))}return be.set(e,!0)}});function hs(i,e,t){var n;let r=null;return(n=i.field(Cn,!1))===null||n===void 0||n.between(e,t,(o,s)=>{(!r||r.from>o)&&(r={from:o,to:s})}),r}function $x(i,e,t){let n=!1;return i.between(e,e,(r,o)=>{r==e&&o==t&&(n=!0)}),n}function kp(i,e){return i.field(Cn,!1)?e:e.concat(Ce.appendConfig.of(Ap()))}const Hx=i=>{for(let e of xp(i)){let t=cs(i.state,e.from,e.to);if(t)return i.dispatch({effects:kp(i.state,[Ns.of(t),Cp(i,t)])}),!0}return!1},jx=i=>{if(!i.state.field(Cn,!1))return!1;let e=[];for(let t of xp(i)){let n=hs(i.state,t.from,t.to);n&&e.push(no.of(n),Cp(i,n,!1))}return e.length&&i.dispatch({effects:e}),e.length>0};function Cp(i,e,t=!0){let n=i.state.doc.lineAt(e.from).number,r=i.state.doc.lineAt(e.to).number;return he.announce.of(`${i.state.phrase(t?"Folded lines":"Unfolded lines")} ${n} ${i.state.phrase("to")} ${r}.`)}const Wx=i=>{let{state:e}=i,t=[];for(let n=0;n<e.doc.length;){let r=i.lineBlockAt(n),o=cs(e,r.from,r.to);o&&t.push(Ns.of(o)),n=(o?i.lineBlockAt(o.to):r).to+1}return t.length&&i.dispatch({effects:kp(i.state,t)}),!!t.length},Vx=i=>{let e=i.state.field(Cn,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,i.state.doc.length,(n,r)=>{t.push(no.of({from:n,to:r}))}),i.dispatch({effects:t}),!0},Ux=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:Hx},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:jx},{key:"Ctrl-Alt-[",run:Wx},{key:"Ctrl-Alt-]",run:Vx}],Kx={placeholderDOM:null,placeholderText:"…"},Sp=de.define({combine(i){return Ai(i,Kx)}});function Ap(i){let e=[Cn,Gx];return i&&e.push(Sp.of(i)),e}const ed=be.replace({widget:new class extends rn{toDOM(i){let{state:e}=i,t=e.facet(Sp),n=o=>{let s=i.lineBlockAt(i.posAtDOM(o.target)),l=hs(i.state,s.from,s.to);l&&i.dispatch({effects:no.of(l)}),o.preventDefault()};if(t.placeholderDOM)return t.placeholderDOM(i,n);let r=document.createElement("span");return r.textContent=t.placeholderText,r.setAttribute("aria-label",e.phrase("folded code")),r.title=e.phrase("unfold"),r.className="cm-foldPlaceholder",r.onclick=n,r}}}),qx={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class vl extends Ei{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function _x(i={}){let e=Object.assign(Object.assign({},qx),i),t=new vl(e,!0),n=new vl(e,!1),r=ht.fromClass(class{constructor(s){this.from=s.viewport.from,this.markers=this.buildMarkers(s)}update(s){(s.docChanged||s.viewportChanged||s.startState.facet(nn)!=s.state.facet(nn)||s.startState.field(Cn,!1)!=s.state.field(Cn,!1)||gt(s.startState)!=gt(s.state)||e.foldingChanged(s))&&(this.markers=this.buildMarkers(s.view))}buildMarkers(s){let l=new Zi;for(let a of s.viewportLineBlocks){let c=hs(s.state,a.from,a.to)?n:cs(s.state,a.from,a.to)?t:null;c&&l.add(a.from,a.from,c)}return l.finish()}}),{domEventHandlers:o}=e;return[r,Yw({class:"cm-foldGutter",markers(s){var l;return((l=s.plugin(r))===null||l===void 0?void 0:l.markers)||Be.empty},initialSpacer(){return new vl(e,!1)},domEventHandlers:Object.assign(Object.assign({},o),{click:(s,l,a)=>{if(o.click&&o.click(s,l,a))return!0;let c=hs(s.state,l.from,l.to);if(c)return s.dispatch({effects:no.of(c)}),!0;let h=cs(s.state,l.from,l.to);return h?(s.dispatch({effects:Ns.of(h)}),!0):!1}})}),Ap()]}const Gx=he.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class ro{constructor(e,t){this.specs=e;let n;function r(l){let a=Qi.newName();return(n||(n=Object.create(null)))["."+a]=l,a}const o=typeof t.all=="string"?t.all:t.all?r(t.all):void 0,s=t.scope;this.scope=s instanceof oi?l=>l.prop(Hn)==s.data:s?l=>l==s:void 0,this.style=mp(e.map(l=>({tag:l.tag,class:l.class||r(Object.assign({},l,{tag:null}))})),{all:o}).style,this.module=n?new Qi(n):null,this.themeType=t.themeType}static define(e,t){return new ro(e,t||{})}}const aa=de.define(),Rp=de.define({combine(i){return i.length?[i[0]]:null}});function bl(i){let e=i.facet(aa);return e.length?e:i.facet(Rp)}function Mp(i,e){let t=[Yx],n;return i instanceof ro&&(i.module&&t.push(he.styleModule.of(i.module)),n=i.themeType),e!=null&&e.fallback?t.push(Rp.of(i)):n?t.push(aa.computeN([he.darkTheme],r=>r.facet(he.darkTheme)==(n=="dark")?[i]:[])):t.push(aa.of(i)),t}class Xx{constructor(e){this.markCache=Object.create(null),this.tree=gt(e.state),this.decorations=this.buildDeco(e,bl(e.state))}update(e){let t=gt(e.state),n=bl(e.state),r=n!=bl(e.startState);t.length<e.view.viewport.to&&!r&&t.type==this.tree.type?this.decorations=this.decorations.map(e.changes):(t!=this.tree||e.viewportChanged||r)&&(this.tree=t,this.decorations=this.buildDeco(e.view,n))}buildDeco(e,t){if(!t||!this.tree.length)return be.none;let n=new Zi;for(let{from:r,to:o}of e.visibleRanges)bx(this.tree,t,(s,l,a)=>{n.add(s,l,this.markCache[a]||(this.markCache[a]=be.mark({class:a})))},r,o);return n.finish()}}const Yx=lr.high(ht.fromClass(Xx,{decorations:i=>i.decorations})),Jx=ro.define([{tag:P.meta,color:"#404740"},{tag:P.link,textDecoration:"underline"},{tag:P.heading,textDecoration:"underline",fontWeight:"bold"},{tag:P.emphasis,fontStyle:"italic"},{tag:P.strong,fontWeight:"bold"},{tag:P.strikethrough,textDecoration:"line-through"},{tag:P.keyword,color:"#708"},{tag:[P.atom,P.bool,P.url,P.contentSeparator,P.labelName],color:"#219"},{tag:[P.literal,P.inserted],color:"#164"},{tag:[P.string,P.deleted],color:"#a11"},{tag:[P.regexp,P.escape,P.special(P.string)],color:"#e40"},{tag:P.definition(P.variableName),color:"#00f"},{tag:P.local(P.variableName),color:"#30a"},{tag:[P.typeName,P.namespace],color:"#085"},{tag:P.className,color:"#167"},{tag:[P.special(P.variableName),P.macroName],color:"#256"},{tag:P.definition(P.propertyName),color:"#00c"},{tag:P.comment,color:"#940"},{tag:P.invalid,color:"#f00"}]),Zx=he.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Op=1e4,Dp="()[]{}",Tp=de.define({combine(i){return Ai(i,{afterCursor:!0,brackets:Dp,maxScanDistance:Op,renderMatch:tk})}}),Qx=be.mark({class:"cm-matchingBracket"}),ek=be.mark({class:"cm-nonmatchingBracket"});function tk(i){let e=[],t=i.matched?Qx:ek;return e.push(t.range(i.start.from,i.start.to)),i.end&&e.push(t.range(i.end.from,i.end.to)),e}const ik=mt.define({create(){return be.none},update(i,e){if(!e.docChanged&&!e.selection)return i;let t=[],n=e.state.facet(Tp);for(let r of e.state.selection.ranges){if(!r.empty)continue;let o=xi(e.state,r.head,-1,n)||r.head>0&&xi(e.state,r.head-1,1,n)||n.afterCursor&&(xi(e.state,r.head,1,n)||r.head<e.state.doc.length&&xi(e.state,r.head+1,-1,n));o&&(t=t.concat(n.renderMatch(o,e.state)))}return be.set(t,!0)},provide:i=>he.decorations.from(i)}),nk=[ik,Zx];function rk(i={}){return[Tp.of(i),nk]}const ok=new Re;function ca(i,e,t){let n=i.prop(e<0?Re.openedBy:Re.closedBy);if(n)return n;if(i.name.length==1){let r=t.indexOf(i.name);if(r>-1&&r%2==(e<0?1:0))return[t[r+e]]}return null}function ha(i){let e=i.type.prop(ok);return e?e(i.node):i}function xi(i,e,t,n={}){let r=n.maxScanDistance||Op,o=n.brackets||Dp,s=gt(i),l=s.resolveInner(e,t);for(let a=l;a;a=a.parent){let c=ca(a.type,t,o);if(c&&a.from<a.to){let h=ha(a);if(h&&(t>0?e>=h.from&&e<h.to:e>h.from&&e<=h.to))return sk(i,e,t,a,h,c,o)}}return lk(i,e,t,s,l.type,r,o)}function sk(i,e,t,n,r,o,s){let l=n.parent,a={from:r.from,to:r.to},c=0,h=l==null?void 0:l.cursor();if(h&&(t<0?h.childBefore(n.from):h.childAfter(n.to)))do if(t<0?h.to<=n.from:h.from>=n.to){if(c==0&&o.indexOf(h.type.name)>-1&&h.from<h.to){let d=ha(h);return{start:a,end:d?{from:d.from,to:d.to}:void 0,matched:!0}}else if(ca(h.type,t,s))c++;else if(ca(h.type,-t,s)){if(c==0){let d=ha(h);return{start:a,end:d&&d.from<d.to?{from:d.from,to:d.to}:void 0,matched:!1}}c--}}while(t<0?h.prevSibling():h.nextSibling());return{start:a,matched:!1}}function lk(i,e,t,n,r,o,s){let l=t<0?i.sliceDoc(e-1,e):i.sliceDoc(e,e+1),a=s.indexOf(l);if(a<0||a%2==0!=t>0)return null;let c={from:t<0?e-1:e,to:t>0?e+1:e},h=i.doc.iterRange(e,t>0?i.doc.length:0),d=0;for(let u=0;!h.next().done&&u<=o;){let f=h.value;t<0&&(u+=f.length);let g=e+u*t;for(let x=t>0?0:f.length-1,b=t>0?f.length:-1;x!=b;x+=t){let S=s.indexOf(f[x]);if(!(S<0||n.resolveInner(g+x,1).type!=r))if(S%2==0==t>0)d++;else{if(d==1)return{start:c,end:{from:g+x,to:g+x+1},matched:S>>1==a>>1};d--}}t>0&&(u+=f.length)}return h.done?{start:c,matched:!1}:null}function td(i,e,t,n=0,r=0){e==null&&(e=i.search(/[^\s\u00a0]/),e==-1&&(e=i.length));let o=r;for(let s=n;s<e;s++)i.charCodeAt(s)==9?o+=t-o%t:o++;return o}class Pp{constructor(e,t,n,r){this.string=e,this.tabSize=t,this.indentUnit=n,this.overrideIndent=r,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let t=this.string.charAt(this.pos),n;if(typeof e=="string"?n=t==e:n=t&&(e instanceof RegExp?e.test(t):e(t)),n)return++this.pos,t}eatWhile(e){let t=this.pos;for(;this.eat(e););return this.pos>t}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=td(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:td(this.string,null,this.tabSize)}match(e,t,n){if(typeof e=="string"){let r=s=>n?s.toLowerCase():s,o=this.string.substr(this.pos,e.length);return r(o)==r(e)?(t!==!1&&(this.pos+=e.length),!0):null}else{let r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&t!==!1&&(this.pos+=r[0].length),r)}}current(){return this.string.slice(this.start,this.pos)}}function ak(i){return{name:i.name||"",token:i.token,blankLine:i.blankLine||(()=>{}),startState:i.startState||(()=>!0),copyState:i.copyState||ck,indent:i.indent||(()=>null),languageData:i.languageData||{},tokenTable:i.tokenTable||Ya}}function ck(i){if(typeof i!="object")return i;let e={};for(let t in i){let n=i[t];e[t]=n instanceof Array?n.slice():n}return e}const id=new WeakMap;class Ga extends oi{constructor(e){let t=xx(e.languageData),n=ak(e),r,o=new class extends pp{createParse(s,l,a){return new dk(r,s,l,a)}};super(t,o,[bp.of((s,l)=>this.getIndent(s,l))],e.name),this.topNode=pk(t),r=this,this.streamParser=n,this.stateAfter=new Re({perNode:!0}),this.tokenTable=e.tokenTable?new Ip(n.tokenTable):fk}static define(e){return new Ga(e)}getIndent(e,t){let n=gt(e.state),r=n.resolve(t);for(;r&&r.type!=this.topNode;)r=r.parent;if(!r)return null;let o,{overrideIndentation:s}=e.options;s&&(o=id.get(e.state),o!=null&&o<t-1e4&&(o=void 0));let l=Xa(this,n,0,r.from,o??t),a,c;if(l?(c=l.state,a=l.pos+1):(c=this.streamParser.startState(e.unit),a=0),t-a>1e4)return null;for(;a<t;){let d=e.state.doc.lineAt(a),u=Math.min(t,d.to);if(d.length){let f=s?s(d.from):-1,g=new Pp(d.text,e.state.tabSize,e.unit,f<0?void 0:f);for(;g.pos<u-d.from;)Bp(this.streamParser.token,g,c)}else this.streamParser.blankLine(c,e.unit);if(u==t)break;a=d.to+1}let h=e.lineAt(t);return s&&o==null&&id.set(e.state,h.from),this.streamParser.indent(c,/^\s*(.*)/.exec(h.text)[1],e)}get allowsNesting(){return!1}}function Xa(i,e,t,n,r){let o=t>=n&&t+e.length<=r&&e.prop(i.stateAfter);if(o)return{state:i.streamParser.copyState(o),pos:t+e.length};for(let s=e.children.length-1;s>=0;s--){let l=e.children[s],a=t+e.positions[s],c=l instanceof Xe&&a<r&&Xa(i,l,a,n,r);if(c)return c}return null}function Lp(i,e,t,n,r){if(r&&t<=0&&n>=e.length)return e;!r&&e.type==i.topNode&&(r=!0);for(let o=e.children.length-1;o>=0;o--){let s=e.positions[o],l=e.children[o],a;if(s<n&&l instanceof Xe){if(!(a=Lp(i,l,t-s,n-s,r)))break;return r?new Xe(e.type,e.children.slice(0,o).concat(a),e.positions.slice(0,o+1),s+a.length):a}}return null}function hk(i,e,t,n){for(let r of e){let o=r.from+(r.openStart?25:0),s=r.to-(r.openEnd?25:0),l=o<=t&&s>t&&Xa(i,r.tree,0-r.offset,t,s),a;if(l&&(a=Lp(i,r.tree,t+r.offset,l.pos+r.offset,!1)))return{state:l.state,tree:a}}return{state:i.streamParser.startState(n?kn(n):4),tree:Xe.empty}}class dk{constructor(e,t,n,r){this.lang=e,this.input=t,this.fragments=n,this.ranges=r,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=r[r.length-1].to;let o=tr.get(),s=r[0].from,{state:l,tree:a}=hk(e,n,s,o==null?void 0:o.state);this.state=l,this.parsedPos=this.chunkStart=s+a.length;for(let c=0;c<a.children.length;c++)this.chunks.push(a.children[c]),this.chunkPos.push(a.positions[c]);o&&this.parsedPos<o.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(kn(o.state)),o.skipUntilInView(this.parsedPos,o.viewport.from),this.parsedPos=o.viewport.from),this.moveRangeIndex()}advance(){let e=tr.get(),t=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),n=Math.min(t,this.chunkStart+2048);for(e&&(n=Math.min(n,e.viewport.to));this.parsedPos<n;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=t?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,t),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let t=this.input.chunk(e);if(this.input.lineChunks)t==`
`&&(t="");else{let n=t.indexOf(`
`);n>-1&&(t=t.slice(0,n))}return e+t.length<=this.to?t:t.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,t=this.lineAfter(e),n=e+t.length;for(let r=this.rangeIndex;;){let o=this.ranges[r].to;if(o>=n||(t=t.slice(0,o-(n-t.length)),r++,r==this.ranges.length))break;let s=this.ranges[r].from,l=this.lineAfter(s);t+=l,n=s+l.length}return{line:t,end:n}}skipGapsTo(e,t,n){for(;;){let r=this.ranges[this.rangeIndex].to,o=e+t;if(n>0?r>o:r>=o)break;let s=this.ranges[++this.rangeIndex].from;t+=s-r}return t}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,t,n,r,o){if(this.ranges.length>1){o=this.skipGapsTo(t,o,1),t+=o;let s=this.chunk.length;o=this.skipGapsTo(n,o,-1),n+=o,r+=this.chunk.length-s}return this.chunk.push(e,t,n,r),o}parseLine(e){let{line:t,end:n}=this.nextLine(),r=0,{streamParser:o}=this.lang,s=new Pp(t,e?e.state.tabSize:4,e?kn(e.state):2);if(s.eol())o.blankLine(this.state,s.indentUnit);else for(;!s.eol();){let l=Bp(o.token,s,this.state);if(l&&(r=this.emitToken(this.lang.tokenTable.resolve(l),this.parsedPos+s.start,this.parsedPos+s.pos,4,r)),s.start>1e4)break}this.parsedPos=n,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=Xe.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:uk,topID:0,maxBufferLength:2048,reused:this.chunkReused});e=new Xe(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new Xe(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function Bp(i,e,t){e.start=e.pos;for(let n=0;n<10;n++){let r=i(e,t);if(e.pos>e.start)return r}throw new Error("Stream parser failed to advance stream.")}const Ya=Object.create(null),Xr=[Nt.none],uk=new ja(Xr),nd=[],Ep=Object.create(null);for(let[i,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Ep[i]=Np(Ya,e);class Ip{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),Ep)}resolve(e){return e?this.table[e]||(this.table[e]=Np(this.extra,e)):0}}const fk=new Ip(Ya);function yl(i,e){nd.indexOf(i)>-1||(nd.push(i),console.warn(e))}function Np(i,e){let t=null;for(let o of e.split(".")){let s=i[o]||P[o];s?typeof s=="function"?t?t=s(t):yl(o,`Modifier ${o} used at start of tag`):t?yl(o,`Tag ${o} used as modifier`):t=s:yl(o,`Unknown highlighting tag ${o}`)}if(!t)return 0;let n=e.replace(/ /g,"_"),r=Nt.define({id:Xr.length,name:n,props:[mx({[n]:t})]});return Xr.push(r),r.id}function pk(i){let e=Nt.define({id:Xr.length,name:"Document",props:[Hn.add(()=>i)]});return Xr.push(e),e}const gk=i=>{let{state:e}=i,t=e.doc.lineAt(e.selection.main.from),n=Za(i.state,t.from);return n.line?mk(i):n.block?bk(i):!1};function Ja(i,e){return({state:t,dispatch:n})=>{if(t.readOnly)return!1;let r=i(e,t);return r?(n(t.update(r)),!0):!1}}const mk=Ja(xk,0),vk=Ja(zp,0),bk=Ja((i,e)=>zp(i,e,wk(e)),0);function Za(i,e){let t=i.languageDataAt("commentTokens",e);return t.length?t[0]:{}}const Cr=50;function yk(i,{open:e,close:t},n,r){let o=i.sliceDoc(n-Cr,n),s=i.sliceDoc(r,r+Cr),l=/\s*$/.exec(o)[0].length,a=/^\s*/.exec(s)[0].length,c=o.length-l;if(o.slice(c-e.length,c)==e&&s.slice(a,a+t.length)==t)return{open:{pos:n-l,margin:l&&1},close:{pos:r+a,margin:a&&1}};let h,d;r-n<=2*Cr?h=d=i.sliceDoc(n,r):(h=i.sliceDoc(n,n+Cr),d=i.sliceDoc(r-Cr,r));let u=/^\s*/.exec(h)[0].length,f=/\s*$/.exec(d)[0].length,g=d.length-f-t.length;return h.slice(u,u+e.length)==e&&d.slice(g,g+t.length)==t?{open:{pos:n+u+e.length,margin:/\s/.test(h.charAt(u+e.length))?1:0},close:{pos:r-f-t.length,margin:/\s/.test(d.charAt(g-1))?1:0}}:null}function wk(i){let e=[];for(let t of i.selection.ranges){let n=i.doc.lineAt(t.from),r=t.to<=n.to?n:i.doc.lineAt(t.to),o=e.length-1;o>=0&&e[o].to>n.from?e[o].to=r.to:e.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:r.to})}return e}function zp(i,e,t=e.selection.ranges){let n=t.map(o=>Za(e,o.from).block);if(!n.every(o=>o))return null;let r=t.map((o,s)=>yk(e,n[s],o.from,o.to));if(i!=2&&!r.every(o=>o))return{changes:e.changes(t.map((o,s)=>r[s]?[]:[{from:o.from,insert:n[s].open+" "},{from:o.to,insert:" "+n[s].close}]))};if(i!=1&&r.some(o=>o)){let o=[];for(let s=0,l;s<r.length;s++)if(l=r[s]){let a=n[s],{open:c,close:h}=l;o.push({from:c.pos-a.open.length,to:c.pos+c.margin},{from:h.pos-h.margin,to:h.pos+a.close.length})}return{changes:o}}return null}function xk(i,e,t=e.selection.ranges){let n=[],r=-1;for(let{from:o,to:s}of t){let l=n.length,a=1e9,c=Za(e,o).line;if(c){for(let h=o;h<=s;){let d=e.doc.lineAt(h);if(d.from>r&&(o==s||s>d.from)){r=d.from;let u=/^\s*/.exec(d.text)[0].length,f=u==d.length,g=d.text.slice(u,u+c.length)==c?u:-1;u<d.text.length&&u<a&&(a=u),n.push({line:d,comment:g,token:c,indent:u,empty:f,single:!1})}h=d.to+1}if(a<1e9)for(let h=l;h<n.length;h++)n[h].indent<n[h].line.text.length&&(n[h].indent=a);n.length==l+1&&(n[l].single=!0)}}if(i!=2&&n.some(o=>o.comment<0&&(!o.empty||o.single))){let o=[];for(let{line:l,token:a,indent:c,empty:h,single:d}of n)(d||!h)&&o.push({from:l.from+c,insert:a+" "});let s=e.changes(o);return{changes:s,selection:e.selection.map(s,1)}}else if(i!=1&&n.some(o=>o.comment>=0)){let o=[];for(let{line:s,comment:l,token:a}of n)if(l>=0){let c=s.from+l,h=c+a.length;s.text[h-s.from]==" "&&h++,o.push({from:c,to:h})}return{changes:o}}return null}const da=zi.define(),kk=zi.define(),Ck=de.define(),Fp=de.define({combine(i){return Ai(i,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(n,r)=>e(n,r)||t(n,r)})}});function Sk(i){let e=0;return i.iterChangedRanges((t,n)=>e=n),e}const $p=mt.define({create(){return ki.empty},update(i,e){let t=e.state.facet(Fp),n=e.annotation(da);if(n){let a=e.docChanged?z.single(Sk(e.changes)):void 0,c=Bt.fromTransaction(e,a),h=n.side,d=h==0?i.undone:i.done;return c?d=ds(d,d.length,t.minDepth,c):d=Wp(d,e.startState.selection),new ki(h==0?n.rest:d,h==0?d:n.rest)}let r=e.annotation(kk);if((r=="full"||r=="before")&&(i=i.isolate()),e.annotation(at.addToHistory)===!1)return e.changes.empty?i:i.addMapping(e.changes.desc);let o=Bt.fromTransaction(e),s=e.annotation(at.time),l=e.annotation(at.userEvent);return o?i=i.addChanges(o,s,l,t,e):e.selection&&(i=i.addSelection(e.startState.selection,s,l,t.newGroupDelay)),(r=="full"||r=="after")&&(i=i.isolate()),i},toJSON(i){return{done:i.done.map(e=>e.toJSON()),undone:i.undone.map(e=>e.toJSON())}},fromJSON(i){return new ki(i.done.map(Bt.fromJSON),i.undone.map(Bt.fromJSON))}});function Ak(i={}){return[$p,Fp.of(i),he.domEventHandlers({beforeinput(e,t){let n=e.inputType=="historyUndo"?Hp:e.inputType=="historyRedo"?ua:null;return n?(e.preventDefault(),n(t)):!1}})]}function zs(i,e){return function({state:t,dispatch:n}){if(!e&&t.readOnly)return!1;let r=t.field($p,!1);if(!r)return!1;let o=r.pop(i,t,e);return o?(n(o),!0):!1}}const Hp=zs(0,!1),ua=zs(1,!1),Rk=zs(0,!0),Mk=zs(1,!0);class Bt{constructor(e,t,n,r,o){this.changes=e,this.effects=t,this.mapped=n,this.startSelection=r,this.selectionsAfter=o}setSelAfter(e){return new Bt(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,n;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(n=this.startSelection)===null||n===void 0?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(r=>r.toJSON())}}static fromJSON(e){return new Bt(e.changes&&lt.fromJSON(e.changes),[],e.mapped&&Ci.fromJSON(e.mapped),e.startSelection&&z.fromJSON(e.startSelection),e.selectionsAfter.map(z.fromJSON))}static fromTransaction(e,t){let n=Zt;for(let r of e.startState.facet(Ck)){let o=r(e);o.length&&(n=n.concat(o))}return!n.length&&e.changes.empty?null:new Bt(e.changes.invert(e.startState.doc),n,void 0,t||e.startState.selection,Zt)}static selection(e){return new Bt(void 0,Zt,void 0,void 0,e)}}function ds(i,e,t,n){let r=e+1>t+20?e-t-1:0,o=i.slice(r,e);return o.push(n),o}function Ok(i,e){let t=[],n=!1;return i.iterChangedRanges((r,o)=>t.push(r,o)),e.iterChangedRanges((r,o,s,l)=>{for(let a=0;a<t.length;){let c=t[a++],h=t[a++];l>=c&&s<=h&&(n=!0)}}),n}function Dk(i,e){return i.ranges.length==e.ranges.length&&i.ranges.filter((t,n)=>t.empty!=e.ranges[n].empty).length===0}function jp(i,e){return i.length?e.length?i.concat(e):i:e}const Zt=[],Tk=200;function Wp(i,e){if(i.length){let t=i[i.length-1],n=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-Tk));return n.length&&n[n.length-1].eq(e)?i:(n.push(e),ds(i,i.length-1,1e9,t.setSelAfter(n)))}else return[Bt.selection([e])]}function Pk(i){let e=i[i.length-1],t=i.slice();return t[i.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function wl(i,e){if(!i.length)return i;let t=i.length,n=Zt;for(;t;){let r=Lk(i[t-1],e,n);if(r.changes&&!r.changes.empty||r.effects.length){let o=i.slice(0,t);return o[t-1]=r,o}else e=r.mapped,t--,n=r.selectionsAfter}return n.length?[Bt.selection(n)]:Zt}function Lk(i,e,t){let n=jp(i.selectionsAfter.length?i.selectionsAfter.map(l=>l.map(e)):Zt,t);if(!i.changes)return Bt.selection(n);let r=i.changes.map(e),o=e.mapDesc(i.changes,!0),s=i.mapped?i.mapped.composeDesc(o):o;return new Bt(r,Ce.mapEffects(i.effects,e),s,i.startSelection.map(o),n)}const Bk=/^(input\.type|delete)($|\.)/;class ki{constructor(e,t,n=0,r=void 0){this.done=e,this.undone=t,this.prevTime=n,this.prevUserEvent=r}isolate(){return this.prevTime?new ki(this.done,this.undone):this}addChanges(e,t,n,r,o){let s=this.done,l=s[s.length-1];return l&&l.changes&&!l.changes.empty&&e.changes&&(!n||Bk.test(n))&&(!l.selectionsAfter.length&&t-this.prevTime<r.newGroupDelay&&r.joinToEvent(o,Ok(l.changes,e.changes))||n=="input.type.compose")?s=ds(s,s.length-1,r.minDepth,new Bt(e.changes.compose(l.changes),jp(e.effects,l.effects),l.mapped,l.startSelection,Zt)):s=ds(s,s.length,r.minDepth,e),new ki(s,Zt,t,n)}addSelection(e,t,n,r){let o=this.done.length?this.done[this.done.length-1].selectionsAfter:Zt;return o.length>0&&t-this.prevTime<r&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&Dk(o[o.length-1],e)?this:new ki(Wp(this.done,e),this.undone,t,n)}addMapping(e){return new ki(wl(this.done,e),wl(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,n){let r=e==0?this.done:this.undone;if(r.length==0)return null;let o=r[r.length-1];if(n&&o.selectionsAfter.length)return t.update({selection:o.selectionsAfter[o.selectionsAfter.length-1],annotations:da.of({side:e,rest:Pk(r)}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(o.changes){let s=r.length==1?Zt:r.slice(0,r.length-1);return o.mapped&&(s=wl(s,o.mapped)),t.update({changes:o.changes,selection:o.startSelection,effects:o.effects,annotations:da.of({side:e,rest:s}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}ki.empty=new ki(Zt,Zt);const Ek=[{key:"Mod-z",run:Hp,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:ua,preventDefault:!0},{linux:"Ctrl-Shift-z",run:ua,preventDefault:!0},{key:"Mod-u",run:Rk,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Mk,preventDefault:!0}];function ar(i,e){return z.create(i.ranges.map(e),i.mainIndex)}function Ri(i,e){return i.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function ai({state:i,dispatch:e},t){let n=ar(i.selection,t);return n.eq(i.selection)?!1:(e(Ri(i,n)),!0)}function Fs(i,e){return z.cursor(e?i.to:i.from)}function Vp(i,e){return ai(i,t=>t.empty?i.moveByChar(t,e):Fs(t,e))}function kt(i){return i.textDirectionAt(i.state.selection.main.head)==Ge.LTR}const Up=i=>Vp(i,!kt(i)),Kp=i=>Vp(i,kt(i));function qp(i,e){return ai(i,t=>t.empty?i.moveByGroup(t,e):Fs(t,e))}const Ik=i=>qp(i,!kt(i)),Nk=i=>qp(i,kt(i));function zk(i,e,t){if(e.type.prop(t))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(i.sliceDoc(e.from,e.to)))||e.firstChild}function $s(i,e,t){let n=gt(i).resolveInner(e.head),r=t?Re.closedBy:Re.openedBy;for(let a=e.head;;){let c=t?n.childAfter(a):n.childBefore(a);if(!c)break;zk(i,c,r)?n=c:a=t?c.to:c.from}let o=n.type.prop(r),s,l;return o&&(s=t?xi(i,n.from,1):xi(i,n.to,-1))&&s.matched?l=t?s.end.to:s.end.from:l=t?n.to:n.from,z.cursor(l,t?-1:1)}const Fk=i=>ai(i,e=>$s(i.state,e,!kt(i))),$k=i=>ai(i,e=>$s(i.state,e,kt(i)));function _p(i,e){return ai(i,t=>{if(!t.empty)return Fs(t,e);let n=i.moveVertically(t,e);return n.head!=t.head?n:i.moveToLineBoundary(t,e)})}const Gp=i=>_p(i,!1),Xp=i=>_p(i,!0);function Yp(i){let e=i.scrollDOM.clientHeight<i.scrollDOM.scrollHeight-2,t=0,n=0,r;if(e){for(let o of i.state.facet(he.scrollMargins)){let s=o(i);s!=null&&s.top&&(t=Math.max(s==null?void 0:s.top,t)),s!=null&&s.bottom&&(n=Math.max(s==null?void 0:s.bottom,n))}r=i.scrollDOM.clientHeight-t-n}else r=(i.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:n,selfScroll:e,height:Math.max(i.defaultLineHeight,r-5)}}function Jp(i,e){let t=Yp(i),{state:n}=i,r=ar(n.selection,s=>s.empty?i.moveVertically(s,e,t.height):Fs(s,e));if(r.eq(n.selection))return!1;let o;if(t.selfScroll){let s=i.coordsAtPos(n.selection.main.head),l=i.scrollDOM.getBoundingClientRect(),a=l.top+t.marginTop,c=l.bottom-t.marginBottom;s&&s.top>a&&s.bottom<c&&(o=he.scrollIntoView(r.main.head,{y:"start",yMargin:s.top-a}))}return i.dispatch(Ri(n,r),{effects:o}),!0}const rd=i=>Jp(i,!1),fa=i=>Jp(i,!0);function on(i,e,t){let n=i.lineBlockAt(e.head),r=i.moveToLineBoundary(e,t);if(r.head==e.head&&r.head!=(t?n.to:n.from)&&(r=i.moveToLineBoundary(e,t,!1)),!t&&r.head==n.from&&n.length){let o=/^\s*/.exec(i.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;o&&e.head!=n.from+o&&(r=z.cursor(n.from+o))}return r}const Hk=i=>ai(i,e=>on(i,e,!0)),jk=i=>ai(i,e=>on(i,e,!1)),Wk=i=>ai(i,e=>on(i,e,!kt(i))),Vk=i=>ai(i,e=>on(i,e,kt(i))),Uk=i=>ai(i,e=>z.cursor(i.lineBlockAt(e.head).from,1)),Kk=i=>ai(i,e=>z.cursor(i.lineBlockAt(e.head).to,-1));function qk(i,e,t){let n=!1,r=ar(i.selection,o=>{let s=xi(i,o.head,-1)||xi(i,o.head,1)||o.head>0&&xi(i,o.head-1,1)||o.head<i.doc.length&&xi(i,o.head+1,-1);if(!s||!s.end)return o;n=!0;let l=s.start.from==o.head?s.end.to:s.end.from;return t?z.range(o.anchor,l):z.cursor(l)});return n?(e(Ri(i,r)),!0):!1}const _k=({state:i,dispatch:e})=>qk(i,e,!1);function ti(i,e){let t=ar(i.state.selection,n=>{let r=e(n);return z.range(n.anchor,r.head,r.goalColumn,r.bidiLevel||void 0)});return t.eq(i.state.selection)?!1:(i.dispatch(Ri(i.state,t)),!0)}function Zp(i,e){return ti(i,t=>i.moveByChar(t,e))}const Qp=i=>Zp(i,!kt(i)),eg=i=>Zp(i,kt(i));function tg(i,e){return ti(i,t=>i.moveByGroup(t,e))}const Gk=i=>tg(i,!kt(i)),Xk=i=>tg(i,kt(i)),Yk=i=>ti(i,e=>$s(i.state,e,!kt(i))),Jk=i=>ti(i,e=>$s(i.state,e,kt(i)));function ig(i,e){return ti(i,t=>i.moveVertically(t,e))}const ng=i=>ig(i,!1),rg=i=>ig(i,!0);function og(i,e){return ti(i,t=>i.moveVertically(t,e,Yp(i).height))}const od=i=>og(i,!1),sd=i=>og(i,!0),Zk=i=>ti(i,e=>on(i,e,!0)),Qk=i=>ti(i,e=>on(i,e,!1)),eC=i=>ti(i,e=>on(i,e,!kt(i))),tC=i=>ti(i,e=>on(i,e,kt(i))),iC=i=>ti(i,e=>z.cursor(i.lineBlockAt(e.head).from)),nC=i=>ti(i,e=>z.cursor(i.lineBlockAt(e.head).to)),ld=({state:i,dispatch:e})=>(e(Ri(i,{anchor:0})),!0),ad=({state:i,dispatch:e})=>(e(Ri(i,{anchor:i.doc.length})),!0),cd=({state:i,dispatch:e})=>(e(Ri(i,{anchor:i.selection.main.anchor,head:0})),!0),hd=({state:i,dispatch:e})=>(e(Ri(i,{anchor:i.selection.main.anchor,head:i.doc.length})),!0),rC=({state:i,dispatch:e})=>(e(i.update({selection:{anchor:0,head:i.doc.length},userEvent:"select"})),!0),oC=({state:i,dispatch:e})=>{let t=js(i).map(({from:n,to:r})=>z.range(n,Math.min(r+1,i.doc.length)));return e(i.update({selection:z.create(t),userEvent:"select"})),!0},sC=({state:i,dispatch:e})=>{let t=ar(i.selection,n=>{var r;let o=gt(i).resolveInner(n.head,1);for(;!(o.from<n.from&&o.to>=n.to||o.to>n.to&&o.from<=n.from||!(!((r=o.parent)===null||r===void 0)&&r.parent));)o=o.parent;return z.range(o.to,o.from)});return e(Ri(i,t)),!0},lC=({state:i,dispatch:e})=>{let t=i.selection,n=null;return t.ranges.length>1?n=z.create([t.main]):t.main.empty||(n=z.create([z.cursor(t.main.head)])),n?(e(Ri(i,n)),!0):!1};function Hs(i,e){if(i.state.readOnly)return!1;let t="delete.selection",{state:n}=i,r=n.changeByRange(o=>{let{from:s,to:l}=o;if(s==l){let a=e(s);a<s?(t="delete.backward",a=Po(i,a,!1)):a>s&&(t="delete.forward",a=Po(i,a,!0)),s=Math.min(s,a),l=Math.max(l,a)}else s=Po(i,s,!1),l=Po(i,l,!0);return s==l?{range:o}:{changes:{from:s,to:l},range:z.cursor(s)}});return r.changes.empty?!1:(i.dispatch(n.update(r,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?he.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function Po(i,e,t){if(i instanceof he)for(let n of i.state.facet(he.atomicRanges).map(r=>r(i)))n.between(e,e,(r,o)=>{r<e&&o>e&&(e=t?o:r)});return e}const sg=(i,e)=>Hs(i,t=>{let{state:n}=i,r=n.doc.lineAt(t),o,s;if(!e&&t>r.from&&t<r.from+200&&!/[^ \t]/.test(o=r.text.slice(0,t-r.from))){if(o[o.length-1]=="	")return t-1;let l=eo(o,n.tabSize),a=l%kn(n)||kn(n);for(let c=0;c<a&&o[o.length-1-c]==" ";c++)t--;s=t}else s=At(r.text,t-r.from,e,e)+r.from,s==t&&r.number!=(e?n.doc.lines:1)&&(s+=e?1:-1);return s}),pa=i=>sg(i,!1),lg=i=>sg(i,!0),ag=(i,e)=>Hs(i,t=>{let n=t,{state:r}=i,o=r.doc.lineAt(n),s=r.charCategorizer(n);for(let l=null;;){if(n==(e?o.to:o.from)){n==t&&o.number!=(e?r.doc.lines:1)&&(n+=e?1:-1);break}let a=At(o.text,n-o.from,e)+o.from,c=o.text.slice(Math.min(n,a)-o.from,Math.max(n,a)-o.from),h=s(c);if(l!=null&&h!=l)break;(c!=" "||n!=t)&&(l=h),n=a}return n}),cg=i=>ag(i,!1),aC=i=>ag(i,!0),hg=i=>Hs(i,e=>{let t=i.lineBlockAt(e).to;return e<t?t:Math.min(i.state.doc.length,e+1)}),cC=i=>Hs(i,e=>{let t=i.lineBlockAt(e).from;return e>t?t:Math.max(0,e-1)}),hC=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let t=i.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:Le.of(["",""])},range:z.cursor(n.from)}));return e(i.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},dC=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let t=i.changeByRange(n=>{if(!n.empty||n.from==0||n.from==i.doc.length)return{range:n};let r=n.from,o=i.doc.lineAt(r),s=r==o.from?r-1:At(o.text,r-o.from,!1)+o.from,l=r==o.to?r+1:At(o.text,r-o.from,!0)+o.from;return{changes:{from:s,to:l,insert:i.doc.slice(r,l).append(i.doc.slice(s,r))},range:z.cursor(l)}});return t.changes.empty?!1:(e(i.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function js(i){let e=[],t=-1;for(let n of i.selection.ranges){let r=i.doc.lineAt(n.from),o=i.doc.lineAt(n.to);if(!n.empty&&n.to==o.from&&(o=i.doc.lineAt(n.to-1)),t>=r.number){let s=e[e.length-1];s.to=o.to,s.ranges.push(n)}else e.push({from:r.from,to:o.to,ranges:[n]});t=o.number+1}return e}function dg(i,e,t){if(i.readOnly)return!1;let n=[],r=[];for(let o of js(i)){if(t?o.to==i.doc.length:o.from==0)continue;let s=i.doc.lineAt(t?o.to+1:o.from-1),l=s.length+1;if(t){n.push({from:o.to,to:s.to},{from:o.from,insert:s.text+i.lineBreak});for(let a of o.ranges)r.push(z.range(Math.min(i.doc.length,a.anchor+l),Math.min(i.doc.length,a.head+l)))}else{n.push({from:s.from,to:o.from},{from:o.to,insert:i.lineBreak+s.text});for(let a of o.ranges)r.push(z.range(a.anchor-l,a.head-l))}}return n.length?(e(i.update({changes:n,scrollIntoView:!0,selection:z.create(r,i.selection.mainIndex),userEvent:"move.line"})),!0):!1}const uC=({state:i,dispatch:e})=>dg(i,e,!1),fC=({state:i,dispatch:e})=>dg(i,e,!0);function ug(i,e,t){if(i.readOnly)return!1;let n=[];for(let r of js(i))t?n.push({from:r.from,insert:i.doc.slice(r.from,r.to)+i.lineBreak}):n.push({from:r.to,insert:i.lineBreak+i.doc.slice(r.from,r.to)});return e(i.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const pC=({state:i,dispatch:e})=>ug(i,e,!1),gC=({state:i,dispatch:e})=>ug(i,e,!0),mC=i=>{if(i.state.readOnly)return!1;let{state:e}=i,t=e.changes(js(e).map(({from:r,to:o})=>(r>0?r--:o<e.doc.length&&o++,{from:r,to:o}))),n=ar(e.selection,r=>i.moveVertically(r,!0)).map(t);return i.dispatch({changes:t,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0};function vC(i,e){if(/\(\)|\[\]|\{\}/.test(i.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=gt(i).resolveInner(e),n=t.childBefore(e),r=t.childAfter(e),o;return n&&r&&n.to<=e&&r.from>=e&&(o=n.type.prop(Re.closedBy))&&o.indexOf(r.name)>-1&&i.doc.lineAt(n.to).from==i.doc.lineAt(r.from).from?{from:n.to,to:r.from}:null}const bC=fg(!1),yC=fg(!0);function fg(i){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=e.changeByRange(r=>{let{from:o,to:s}=r,l=e.doc.lineAt(o),a=!i&&o==s&&vC(e,o);i&&(o=s=(s<=l.to?l:e.doc.lineAt(s)).to);let c=new Is(e,{simulateBreak:o,simulateDoubleBreak:!!a}),h=qa(c,o);for(h==null&&(h=/^\s*/.exec(e.doc.lineAt(o).text)[0].length);s<l.to&&/\s/.test(l.text[s-l.from]);)s++;a?{from:o,to:s}=a:o>l.from&&o<l.from+100&&!/\S/.test(l.text.slice(0,o))&&(o=l.from);let d=["",Gr(e,h)];return a&&d.push(Gr(e,c.lineIndent(l.from,-1))),{changes:{from:o,to:s,insert:Le.of(d)},range:z.cursor(o+1+d[1].length)}});return t(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function Qa(i,e){let t=-1;return i.changeByRange(n=>{let r=[];for(let s=n.from;s<=n.to;){let l=i.doc.lineAt(s);l.number>t&&(n.empty||n.to>l.from)&&(e(l,r,n),t=l.number),s=l.to+1}let o=i.changes(r);return{changes:r,range:z.range(o.mapPos(n.anchor,1),o.mapPos(n.head,1))}})}const wC=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let t=Object.create(null),n=new Is(i,{overrideIndentation:o=>t[o]??-1}),r=Qa(i,(o,s,l)=>{let a=qa(n,o.from);if(a==null)return;/\S/.test(o.text)||(a=0);let c=/^\s*/.exec(o.text)[0],h=Gr(i,a);(c!=h||l.from<o.from+c.length)&&(t[o.from]=a,s.push({from:o.from,to:o.from+c.length,insert:h}))});return r.changes.empty||e(i.update(r,{userEvent:"indent"})),!0},xC=({state:i,dispatch:e})=>i.readOnly?!1:(e(i.update(Qa(i,(t,n)=>{n.push({from:t.from,insert:i.facet(Ka)})}),{userEvent:"input.indent"})),!0),kC=({state:i,dispatch:e})=>i.readOnly?!1:(e(i.update(Qa(i,(t,n)=>{let r=/^\s*/.exec(t.text)[0];if(!r)return;let o=eo(r,i.tabSize),s=0,l=Gr(i,Math.max(0,o-kn(i)));for(;s<r.length&&s<l.length&&r.charCodeAt(s)==l.charCodeAt(s);)s++;n.push({from:t.from+s,to:t.from+r.length,insert:l.slice(s)})}),{userEvent:"delete.dedent"})),!0),CC=[{key:"Ctrl-b",run:Up,shift:Qp,preventDefault:!0},{key:"Ctrl-f",run:Kp,shift:eg},{key:"Ctrl-p",run:Gp,shift:ng},{key:"Ctrl-n",run:Xp,shift:rg},{key:"Ctrl-a",run:Uk,shift:iC},{key:"Ctrl-e",run:Kk,shift:nC},{key:"Ctrl-d",run:lg},{key:"Ctrl-h",run:pa},{key:"Ctrl-k",run:hg},{key:"Ctrl-Alt-h",run:cg},{key:"Ctrl-o",run:hC},{key:"Ctrl-t",run:dC},{key:"Ctrl-v",run:fa}],SC=[{key:"ArrowLeft",run:Up,shift:Qp,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:Ik,shift:Gk,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:Wk,shift:eC,preventDefault:!0},{key:"ArrowRight",run:Kp,shift:eg,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:Nk,shift:Xk,preventDefault:!0},{mac:"Cmd-ArrowRight",run:Vk,shift:tC,preventDefault:!0},{key:"ArrowUp",run:Gp,shift:ng,preventDefault:!0},{mac:"Cmd-ArrowUp",run:ld,shift:cd},{mac:"Ctrl-ArrowUp",run:rd,shift:od},{key:"ArrowDown",run:Xp,shift:rg,preventDefault:!0},{mac:"Cmd-ArrowDown",run:ad,shift:hd},{mac:"Ctrl-ArrowDown",run:fa,shift:sd},{key:"PageUp",run:rd,shift:od},{key:"PageDown",run:fa,shift:sd},{key:"Home",run:jk,shift:Qk,preventDefault:!0},{key:"Mod-Home",run:ld,shift:cd},{key:"End",run:Hk,shift:Zk,preventDefault:!0},{key:"Mod-End",run:ad,shift:hd},{key:"Enter",run:bC},{key:"Mod-a",run:rC},{key:"Backspace",run:pa,shift:pa},{key:"Delete",run:lg},{key:"Mod-Backspace",mac:"Alt-Backspace",run:cg},{key:"Mod-Delete",mac:"Alt-Delete",run:aC},{mac:"Mod-Backspace",run:cC},{mac:"Mod-Delete",run:hg}].concat(CC.map(i=>({mac:i.key,run:i.run,shift:i.shift}))),AC=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:Fk,shift:Yk},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:$k,shift:Jk},{key:"Alt-ArrowUp",run:uC},{key:"Shift-Alt-ArrowUp",run:pC},{key:"Alt-ArrowDown",run:fC},{key:"Shift-Alt-ArrowDown",run:gC},{key:"Escape",run:lC},{key:"Mod-Enter",run:yC},{key:"Alt-l",mac:"Ctrl-l",run:oC},{key:"Mod-i",run:sC,preventDefault:!0},{key:"Mod-[",run:kC},{key:"Mod-]",run:xC},{key:"Mod-Alt-\\",run:wC},{key:"Shift-Mod-k",run:mC},{key:"Shift-Mod-\\",run:_k},{key:"Mod-/",run:gk},{key:"Alt-A",run:vk}].concat(SC);function ze(){var i=arguments[0];typeof i=="string"&&(i=document.createElement(i));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=t[n];typeof r=="string"?i.setAttribute(n,r):r!=null&&(i[n]=r)}e++}for(;e<arguments.length;e++)pg(i,arguments[e]);return i}function pg(i,e){if(typeof e=="string")i.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)i.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)pg(i,e[t]);else throw new RangeError("Unsupported child node: "+e)}const dd=typeof String.prototype.normalize=="function"?i=>i.normalize("NFKD"):i=>i;class nr{constructor(e,t,n=0,r=e.length,o,s){this.test=s,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,r),this.bufferStart=n,this.normalize=o?l=>o(dd(l)):dd,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return ut(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=Oa(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=Jt(e);let r=this.normalize(t);for(let o=0,s=n;;o++){let l=r.charCodeAt(o),a=this.match(l,s);if(a)return this.value=a,this;if(o==r.length-1)break;s==n&&o<t.length&&t.charCodeAt(o)==l&&s++}}}match(e,t){let n=null;for(let r=0;r<this.matches.length;r+=2){let o=this.matches[r],s=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?n={from:this.matches[r+1],to:t+1}:(this.matches[r]++,s=!0)),s||(this.matches.splice(r,2),r-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?n={from:t,to:t+1}:this.matches.push(1,t)),n&&this.test&&!this.test(n.from,n.to,this.buffer,this.bufferPos)&&(n=null),n}}typeof Symbol<"u"&&(nr.prototype[Symbol.iterator]=function(){return this});const gg={from:-1,to:-1,match:/.*/.exec("")},ec="gm"+(/x/.unicode==null?"":"u");class mg{constructor(e,t,n,r=0,o=e.length){if(this.text=e,this.to=o,this.curLine="",this.done=!1,this.value=gg,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new vg(e,t,n,r,o);this.re=new RegExp(t,ec+(n!=null&&n.ignoreCase?"i":"")),this.test=n==null?void 0:n.test,this.iter=e.iter();let s=e.lineAt(r);this.curLineStart=s.from,this.matchPos=us(e,r),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let n=this.curLineStart+t.index,r=n+t[0].length;if(this.matchPos=us(this.text,r+(n==r?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<r||n>this.value.to)&&(!this.test||this.test(n,r,t)))return this.value={from:n,to:r,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const xl=new WeakMap;class _n{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,n){let r=xl.get(e);if(!r||r.from>=n||r.to<=t){let l=new _n(t,e.sliceString(t,n));return xl.set(e,l),l}if(r.from==t&&r.to==n)return r;let{text:o,from:s}=r;return s>t&&(o=e.sliceString(t,s)+o,s=t),r.to<n&&(o+=e.sliceString(r.to,n)),xl.set(e,new _n(s,o)),new _n(t,o.slice(t-s,n-s))}}class vg{constructor(e,t,n,r,o){this.text=e,this.to=o,this.done=!1,this.value=gg,this.matchPos=us(e,r),this.re=new RegExp(t,ec+(n!=null&&n.ignoreCase?"i":"")),this.test=n==null?void 0:n.test,this.flat=_n.get(e,r,this.chunkEnd(r+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let n=this.flat.from+t.index,r=n+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(n,r,t)))return this.value={from:n,to:r,match:t},this.matchPos=us(this.text,r+(n==r?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=_n.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(mg.prototype[Symbol.iterator]=vg.prototype[Symbol.iterator]=function(){return this});function RC(i){try{return new RegExp(i,ec),!0}catch{return!1}}function us(i,e){if(e>=i.length)return e;let t=i.lineAt(e),n;for(;e<t.to&&(n=t.text.charCodeAt(e-t.from))>=56320&&n<57344;)e++;return e}function ga(i){let e=ze("input",{class:"cm-textfield",name:"line"}),t=ze("form",{class:"cm-gotoLine",onkeydown:r=>{r.keyCode==27?(r.preventDefault(),i.dispatch({effects:fs.of(!1)}),i.focus()):r.keyCode==13&&(r.preventDefault(),n())},onsubmit:r=>{r.preventDefault(),n()}},ze("label",i.state.phrase("Go to line"),": ",e)," ",ze("button",{class:"cm-button",type:"submit"},i.state.phrase("go")));function n(){let r=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(e.value);if(!r)return;let{state:o}=i,s=o.doc.lineAt(o.selection.main.head),[,l,a,c,h]=r,d=c?+c.slice(1):0,u=a?+a:s.number;if(a&&h){let g=u/100;l&&(g=g*(l=="-"?-1:1)+s.number/o.doc.lines),u=Math.round(o.doc.lines*g)}else a&&l&&(u=u*(l=="-"?-1:1)+s.number);let f=o.doc.line(Math.max(1,Math.min(o.doc.lines,u)));i.dispatch({effects:fs.of(!1),selection:z.cursor(f.from+Math.max(0,Math.min(d,f.length))),scrollIntoView:!0}),i.focus()}return{dom:t}}const fs=Ce.define(),ud=mt.define({create(){return!0},update(i,e){for(let t of e.effects)t.is(fs)&&(i=t.value);return i},provide:i=>_r.from(i,e=>e?ga:null)}),MC=i=>{let e=qr(i,ga);if(!e){let t=[fs.of(!0)];i.state.field(ud,!1)==null&&t.push(Ce.appendConfig.of([ud,OC])),i.dispatch({effects:t}),e=qr(i,ga)}return e&&e.dom.querySelector("input").focus(),!0},OC=he.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),DC={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},bg=de.define({combine(i){return Ai(i,DC,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function TC(i){let e=[IC,EC];return i&&e.push(bg.of(i)),e}const PC=be.mark({class:"cm-selectionMatch"}),LC=be.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function fd(i,e,t,n){return(t==0||i(e.sliceDoc(t-1,t))!=Ve.Word)&&(n==e.doc.length||i(e.sliceDoc(n,n+1))!=Ve.Word)}function BC(i,e,t,n){return i(e.sliceDoc(t,t+1))==Ve.Word&&i(e.sliceDoc(n-1,n))==Ve.Word}const EC=ht.fromClass(class{constructor(i){this.decorations=this.getDeco(i)}update(i){(i.selectionSet||i.docChanged||i.viewportChanged)&&(this.decorations=this.getDeco(i.view))}getDeco(i){let e=i.state.facet(bg),{state:t}=i,n=t.selection;if(n.ranges.length>1)return be.none;let r=n.main,o,s=null;if(r.empty){if(!e.highlightWordAroundCursor)return be.none;let a=t.wordAt(r.head);if(!a)return be.none;s=t.charCategorizer(r.head),o=t.sliceDoc(a.from,a.to)}else{let a=r.to-r.from;if(a<e.minSelectionLength||a>200)return be.none;if(e.wholeWords){if(o=t.sliceDoc(r.from,r.to),s=t.charCategorizer(r.head),!(fd(s,t,r.from,r.to)&&BC(s,t,r.from,r.to)))return be.none}else if(o=t.sliceDoc(r.from,r.to).trim(),!o)return be.none}let l=[];for(let a of i.visibleRanges){let c=new nr(t.doc,o,a.from,a.to);for(;!c.next().done;){let{from:h,to:d}=c.value;if((!s||fd(s,t,h,d))&&(r.empty&&h<=r.from&&d>=r.to?l.push(LC.range(h,d)):(h>=r.to||d<=r.from)&&l.push(PC.range(h,d)),l.length>e.maxMatches))return be.none}}return be.set(l)}},{decorations:i=>i.decorations}),IC=he.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),NC=({state:i,dispatch:e})=>{let{selection:t}=i,n=z.create(t.ranges.map(r=>i.wordAt(r.head)||z.cursor(r.head)),t.mainIndex);return n.eq(t)?!1:(e(i.update({selection:n})),!0)};function zC(i,e){let{main:t,ranges:n}=i.selection,r=i.wordAt(t.head),o=r&&r.from==t.from&&r.to==t.to;for(let s=!1,l=new nr(i.doc,e,n[n.length-1].to);;)if(l.next(),l.done){if(s)return null;l=new nr(i.doc,e,0,Math.max(0,n[n.length-1].from-1)),s=!0}else{if(s&&n.some(a=>a.from==l.value.from))continue;if(o){let a=i.wordAt(l.value.from);if(!a||a.from!=l.value.from||a.to!=l.value.to)continue}return l.value}}const FC=({state:i,dispatch:e})=>{let{ranges:t}=i.selection;if(t.some(o=>o.from===o.to))return NC({state:i,dispatch:e});let n=i.sliceDoc(t[0].from,t[0].to);if(i.selection.ranges.some(o=>i.sliceDoc(o.from,o.to)!=n))return!1;let r=zC(i,n);return r?(e(i.update({selection:i.selection.addRange(z.range(r.from,r.to),!1),effects:he.scrollIntoView(r.to)})),!0):!1},cr=de.define({combine(i){return Ai(i,{top:!1,caseSensitive:!1,literal:!1,wholeWord:!1,createPanel:e=>new YC(e),scrollToMatch:e=>he.scrollIntoView(e)})}});class yg{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||RC(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,n)=>n=="n"?`
`:n=="r"?"\r":n=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new WC(this):new HC(this)}getCursor(e,t=0,n){let r=e.doc?e:Te.create({doc:e});return n==null&&(n=r.doc.length),this.regexp?In(this,r,t,n):En(this,r,t,n)}}class wg{constructor(e){this.spec=e}}function En(i,e,t,n){return new nr(e.doc,i.unquoted,t,n,i.caseSensitive?void 0:r=>r.toLowerCase(),i.wholeWord?$C(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function $C(i,e){return(t,n,r,o)=>((o>t||o+r.length<n)&&(o=Math.max(0,t-2),r=i.sliceString(o,Math.min(i.length,n+2))),(e(ps(r,t-o))!=Ve.Word||e(gs(r,t-o))!=Ve.Word)&&(e(gs(r,n-o))!=Ve.Word||e(ps(r,n-o))!=Ve.Word))}class HC extends wg{constructor(e){super(e)}nextMatch(e,t,n){let r=En(this.spec,e,n,e.doc.length).nextOverlapping();return r.done&&(r=En(this.spec,e,0,t).nextOverlapping()),r.done?null:r.value}prevMatchInRange(e,t,n){for(let r=n;;){let o=Math.max(t,r-1e4-this.spec.unquoted.length),s=En(this.spec,e,o,r),l=null;for(;!s.nextOverlapping().done;)l=s.value;if(l)return l;if(o==t)return null;r-=1e4}}prevMatch(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let n=En(this.spec,e,0,e.doc.length),r=[];for(;!n.next().done;){if(r.length>=t)return null;r.push(n.value)}return r}highlight(e,t,n,r){let o=En(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));for(;!o.next().done;)r(o.value.from,o.value.to)}}function In(i,e,t,n){return new mg(e.doc,i.search,{ignoreCase:!i.caseSensitive,test:i.wholeWord?jC(e.charCategorizer(e.selection.main.head)):void 0},t,n)}function ps(i,e){return i.slice(At(i,e,!1),e)}function gs(i,e){return i.slice(e,At(i,e))}function jC(i){return(e,t,n)=>!n[0].length||(i(ps(n.input,n.index))!=Ve.Word||i(gs(n.input,n.index))!=Ve.Word)&&(i(gs(n.input,n.index+n[0].length))!=Ve.Word||i(ps(n.input,n.index+n[0].length))!=Ve.Word)}class WC extends wg{nextMatch(e,t,n){let r=In(this.spec,e,n,e.doc.length).next();return r.done&&(r=In(this.spec,e,0,t).next()),r.done?null:r.value}prevMatchInRange(e,t,n){for(let r=1;;r++){let o=Math.max(t,n-r*1e4),s=In(this.spec,e,o,n),l=null;for(;!s.next().done;)l=s.value;if(l&&(o==t||l.from>o+10))return l;if(o==t)return null}}prevMatch(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace.replace(/\$([$&\d+])/g,(t,n)=>n=="$"?"$":n=="&"?e.match[0]:n!="0"&&+n<e.match.length?e.match[n]:t))}matchAll(e,t){let n=In(this.spec,e,0,e.doc.length),r=[];for(;!n.next().done;){if(r.length>=t)return null;r.push(n.value)}return r}highlight(e,t,n,r){let o=In(this.spec,e,Math.max(0,t-250),Math.min(n+250,e.doc.length));for(;!o.next().done;)r(o.value.from,o.value.to)}}const Yr=Ce.define(),tc=Ce.define(),Gi=mt.define({create(i){return new kl(ma(i).create(),null)},update(i,e){for(let t of e.effects)t.is(Yr)?i=new kl(t.value.create(),i.panel):t.is(tc)&&(i=new kl(i.query,t.value?ic:null));return i},provide:i=>_r.from(i,e=>e.panel)});class kl{constructor(e,t){this.query=e,this.panel=t}}const VC=be.mark({class:"cm-searchMatch"}),UC=be.mark({class:"cm-searchMatch cm-searchMatch-selected"}),KC=ht.fromClass(class{constructor(i){this.view=i,this.decorations=this.highlight(i.state.field(Gi))}update(i){let e=i.state.field(Gi);(e!=i.startState.field(Gi)||i.docChanged||i.selectionSet||i.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:i,panel:e}){if(!e||!i.spec.valid)return be.none;let{view:t}=this,n=new Zi;for(let r=0,o=t.visibleRanges,s=o.length;r<s;r++){let{from:l,to:a}=o[r];for(;r<s-1&&a>o[r+1].from-2*250;)a=o[++r].to;i.highlight(t.state,l,a,(c,h)=>{let d=t.state.selection.ranges.some(u=>u.from==c&&u.to==h);n.add(c,h,d?UC:VC)})}return n.finish()}},{decorations:i=>i.decorations});function oo(i){return e=>{let t=e.state.field(Gi,!1);return t&&t.query.spec.valid?i(e,t):xg(e)}}const ms=oo((i,{query:e})=>{let{to:t}=i.state.selection.main,n=e.nextMatch(i.state,t,t);if(!n)return!1;let r=z.single(n.from,n.to),o=i.state.facet(cr);return i.dispatch({selection:r,effects:[nc(i,n),o.scrollToMatch(r.main)],userEvent:"select.search"}),!0}),vs=oo((i,{query:e})=>{let{state:t}=i,{from:n}=t.selection.main,r=e.prevMatch(t,n,n);if(!r)return!1;let o=z.single(r.from,r.to),s=i.state.facet(cr);return i.dispatch({selection:o,effects:[nc(i,r),s.scrollToMatch(o.main)],userEvent:"select.search"}),!0}),qC=oo((i,{query:e})=>{let t=e.matchAll(i.state,1e3);return!t||!t.length?!1:(i.dispatch({selection:z.create(t.map(n=>z.range(n.from,n.to))),userEvent:"select.search.matches"}),!0)}),_C=({state:i,dispatch:e})=>{let t=i.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:n,to:r}=t.main,o=[],s=0;for(let l=new nr(i.doc,i.sliceDoc(n,r));!l.next().done;){if(o.length>1e3)return!1;l.value.from==n&&(s=o.length),o.push(z.range(l.value.from,l.value.to))}return e(i.update({selection:z.create(o,s),userEvent:"select.search.matches"})),!0},pd=oo((i,{query:e})=>{let{state:t}=i,{from:n,to:r}=t.selection.main;if(t.readOnly)return!1;let o=e.nextMatch(t,n,n);if(!o)return!1;let s=[],l,a,c=[];if(o.from==n&&o.to==r&&(a=t.toText(e.getReplacement(o)),s.push({from:o.from,to:o.to,insert:a}),o=e.nextMatch(t,o.from,o.to),c.push(he.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(n).number)+"."))),o){let h=s.length==0||s[0].from>=o.to?0:o.to-o.from-a.length;l=z.single(o.from-h,o.to-h),c.push(nc(i,o)),c.push(t.facet(cr).scrollToMatch(l.main))}return i.dispatch({changes:s,selection:l,effects:c,userEvent:"input.replace"}),!0}),GC=oo((i,{query:e})=>{if(i.state.readOnly)return!1;let t=e.matchAll(i.state,1e9).map(r=>{let{from:o,to:s}=r;return{from:o,to:s,insert:e.getReplacement(r)}});if(!t.length)return!1;let n=i.state.phrase("replaced $ matches",t.length)+".";return i.dispatch({changes:t,effects:he.announce.of(n),userEvent:"input.replace.all"}),!0});function ic(i){return i.state.facet(cr).createPanel(i)}function ma(i,e){var t,n,r,o;let s=i.selection.main,l=s.empty||s.to>s.from+100?"":i.sliceDoc(s.from,s.to);if(e&&!l)return e;let a=i.facet(cr);return new yg({search:((t=e==null?void 0:e.literal)!==null&&t!==void 0?t:a.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(n=e==null?void 0:e.caseSensitive)!==null&&n!==void 0?n:a.caseSensitive,literal:(r=e==null?void 0:e.literal)!==null&&r!==void 0?r:a.literal,wholeWord:(o=e==null?void 0:e.wholeWord)!==null&&o!==void 0?o:a.wholeWord})}const xg=i=>{let e=i.state.field(Gi,!1);if(e&&e.panel){let t=qr(i,ic);if(!t)return!1;let n=t.dom.querySelector("[main-field]");if(n&&n!=i.root.activeElement){let r=ma(i.state,e.query.spec);r.valid&&i.dispatch({effects:Yr.of(r)}),n.focus(),n.select()}}else i.dispatch({effects:[tc.of(!0),e?Yr.of(ma(i.state,e.query.spec)):Ce.appendConfig.of(ZC)]});return!0},kg=i=>{let e=i.state.field(Gi,!1);if(!e||!e.panel)return!1;let t=qr(i,ic);return t&&t.dom.contains(i.root.activeElement)&&i.focus(),i.dispatch({effects:tc.of(!1)}),!0},XC=[{key:"Mod-f",run:xg,scope:"editor search-panel"},{key:"F3",run:ms,shift:vs,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:ms,shift:vs,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:kg,scope:"editor search-panel"},{key:"Mod-Shift-l",run:_C},{key:"Alt-g",run:MC},{key:"Mod-d",run:FC,preventDefault:!0}];class YC{constructor(e){this.view=e;let t=this.query=e.state.field(Gi).query.spec;this.commit=this.commit.bind(this),this.searchField=ze("input",{value:t.search,placeholder:jt(e,"Find"),"aria-label":jt(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=ze("input",{value:t.replace,placeholder:jt(e,"Replace"),"aria-label":jt(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=ze("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=ze("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=ze("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function n(r,o,s){return ze("button",{class:"cm-button",name:r,onclick:o,type:"button"},s)}this.dom=ze("div",{onkeydown:r=>this.keydown(r),class:"cm-search"},[this.searchField,n("next",()=>ms(e),[jt(e,"next")]),n("prev",()=>vs(e),[jt(e,"previous")]),n("select",()=>qC(e),[jt(e,"all")]),ze("label",null,[this.caseField,jt(e,"match case")]),ze("label",null,[this.reField,jt(e,"regexp")]),ze("label",null,[this.wordField,jt(e,"by word")]),...e.state.readOnly?[]:[ze("br"),this.replaceField,n("replace",()=>pd(e),[jt(e,"replace")]),n("replaceAll",()=>GC(e),[jt(e,"replace all")])],ze("button",{name:"close",onclick:()=>kg(e),"aria-label":jt(e,"close"),type:"button"},["×"])])}commit(){let e=new yg({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Yr.of(e)}))}keydown(e){aw(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?vs:ms)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),pd(this.view))}update(e){for(let t of e.transactions)for(let n of t.effects)n.is(Yr)&&!n.value.eq(this.query)&&this.setQuery(n.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(cr).top}}function jt(i,e){return i.state.phrase(e)}const Lo=30,Bo=/[\s\.,:;?!]/;function nc(i,{from:e,to:t}){let n=i.state.doc.lineAt(e),r=i.state.doc.lineAt(t).to,o=Math.max(n.from,e-Lo),s=Math.min(r,t+Lo),l=i.state.sliceDoc(o,s);if(o!=n.from){for(let a=0;a<Lo;a++)if(!Bo.test(l[a+1])&&Bo.test(l[a])){l=l.slice(a);break}}if(s!=r){for(let a=l.length-1;a>l.length-Lo;a--)if(!Bo.test(l[a-1])&&Bo.test(l[a])){l=l.slice(0,a);break}}return he.announce.of(`${i.state.phrase("current match")}. ${l} ${i.state.phrase("on line")} ${n.number}.`)}const JC=he.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),ZC=[Gi,lr.lowest(KC),JC];class Cg{constructor(e,t,n){this.state=e,this.pos=t,this.explicit=n,this.abortListeners=[]}tokenBefore(e){let t=gt(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),n=Math.max(t.from,this.pos-250),r=t.text.slice(n-t.from,this.pos-t.from),o=r.search(Sg(e,!1));return o<0?null:{from:n+o,to:this.pos,text:r.slice(o)}}get aborted(){return this.abortListeners==null}addEventListener(e,t){e=="abort"&&this.abortListeners&&this.abortListeners.push(t)}}function gd(i){let e=Object.keys(i).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function QC(i){let e=Object.create(null),t=Object.create(null);for(let{label:r}of i){e[r[0]]=!0;for(let o=1;o<r.length;o++)t[r[o]]=!0}let n=gd(e)+gd(t)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function e2(i){let e=i.map(r=>typeof r=="string"?{label:r}:r),[t,n]=e.every(r=>/^\w+$/.test(r.label))?[/\w*$/,/\w+$/]:QC(e);return r=>{let o=r.matchBefore(n);return o||r.explicit?{from:o?o.from:r.pos,options:e,validFor:t}:null}}class md{constructor(e,t,n,r){this.completion=e,this.source=t,this.match=n,this.score=r}}function Xi(i){return i.selection.main.from}function Sg(i,e){var t;let{source:n}=i,r=e&&n[0]!="^",o=n[n.length-1]!="$";return!r&&!o?i:new RegExp(`${r?"^":""}(?:${n})${o?"$":""}`,(t=i.flags)!==null&&t!==void 0?t:i.ignoreCase?"i":"")}const t2=zi.define();function i2(i,e,t,n){let{main:r}=i.selection,o=n-t;return Object.assign(Object.assign({},i.changeByRange(s=>s!=r&&o&&i.sliceDoc(s.from-o,s.from+n-r.from)!=i.sliceDoc(t,n)?{range:s}:{changes:{from:s.from-o,to:n==r.from?s.to:s.from+n-r.from,insert:e},range:z.cursor(s.from-o+e.length)})),{userEvent:"input.complete"})}function Ag(i,e){const t=e.completion.apply||e.completion.label;let n=e.source;typeof t=="string"?i.dispatch(Object.assign(Object.assign({},i2(i.state,t,n.from,n.to)),{annotations:t2.of(e.completion)})):t(i,e.completion,n.from,n.to)}const vd=new WeakMap;function n2(i){if(!Array.isArray(i))return i;let e=vd.get(i);return e||vd.set(i,e=e2(i)),e}const rc=Ce.define(),Jr=Ce.define();class r2{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[];for(let t=0;t<e.length;){let n=ut(e,t),r=Jt(n);this.chars.push(n);let o=e.slice(t,t+r),s=o.toUpperCase();this.folded.push(ut(s==o?o.toLowerCase():s,0)),t+=r}this.astral=e.length!=this.chars.length}match(e){if(this.pattern.length==0)return[0];if(e.length<this.pattern.length)return null;let{chars:t,folded:n,any:r,precise:o,byWord:s}=this;if(t.length==1){let A=ut(e,0),O=Jt(A),R=O==e.length?0:-100;if(A!=t[0])if(A==n[0])R+=-200;else return null;return[R,0,O]}let l=e.indexOf(this.pattern);if(l==0)return[e.length==this.pattern.length?0:-100,0,this.pattern.length];let a=t.length,c=0;if(l<0){for(let A=0,O=Math.min(e.length,200);A<O&&c<a;){let R=ut(e,A);(R==t[c]||R==n[c])&&(r[c++]=A),A+=Jt(R)}if(c<a)return null}let h=0,d=0,u=!1,f=0,g=-1,x=-1,b=/[a-z]/.test(e),S=!0;for(let A=0,O=Math.min(e.length,200),R=0;A<O&&d<a;){let k=ut(e,A);l<0&&(h<a&&k==t[h]&&(o[h++]=A),f<a&&(k==t[f]||k==n[f]?(f==0&&(g=A),x=A+1,f++):f=0));let C,w=k<255?k>=48&&k<=57||k>=97&&k<=122?2:k>=65&&k<=90?1:0:(C=Oa(k))!=C.toLowerCase()?1:C!=C.toUpperCase()?2:0;(!A||w==1&&b||R==0&&w!=0)&&(t[d]==k||n[d]==k&&(u=!0)?s[d++]=A:s.length&&(S=!1)),R=w,A+=Jt(k)}return d==a&&s[0]==0&&S?this.result(-100+(u?-200:0),s,e):f==a&&g==0?[-200-e.length+(x==e.length?0:-100),0,x]:l>-1?[-700-e.length,l,l+this.pattern.length]:f==a?[-200+-700-e.length,g,x]:d==a?this.result(-100+(u?-200:0)+-700+(S?0:-1100),s,e):t.length==2?null:this.result((r[0]?-700:0)+-200+-1100,r,e)}result(e,t,n){let r=[e-n.length],o=1;for(let s of t){let l=s+(this.astral?Jt(ut(n,s)):1);o>1&&r[o-1]==s?r[o-1]=l:(r[o++]=s,r[o++]=l)}return r}}const Et=de.define({combine(i){return Ai(i,{activateOnTyping:!0,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:o2,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>n=>bd(e(n),t(n)),optionClass:(e,t)=>n=>bd(e(n),t(n)),addToOptions:(e,t)=>e.concat(t)})}});function bd(i,e){return i?e?i+" "+e:i:e}function o2(i,e,t,n,r){let o=i.textDirection==Ge.RTL,s=o,l=!1,a="top",c,h,d=e.left-r.left,u=r.right-e.right,f=n.right-n.left,g=n.bottom-n.top;if(s&&d<Math.min(f,u)?s=!1:!s&&u<Math.min(f,d)&&(s=!0),f<=(s?d:u))c=Math.max(r.top,Math.min(t.top,r.bottom-g))-e.top,h=Math.min(400,s?d:u);else{l=!0,h=Math.min(400,(o?e.right:r.right-e.left)-30);let x=r.bottom-e.bottom;x>=g||x>e.top?c=t.bottom-e.top:(a="bottom",c=e.bottom-t.top)}return{style:`${a}: ${c}px; max-width: ${h}px`,class:"cm-completionInfo-"+(l?o?"left-narrow":"right-narrow":s?"left":"right")}}function s2(i){let e=i.addToOptions.slice();return i.icons&&e.push({render(t){let n=document.createElement("div");return n.classList.add("cm-completionIcon"),t.type&&n.classList.add(...t.type.split(/\s+/g).map(r=>"cm-completionIcon-"+r)),n.setAttribute("aria-hidden","true"),n},position:20}),e.push({render(t,n,r){let o=document.createElement("span");o.className="cm-completionLabel";let{label:s}=t,l=0;for(let a=1;a<r.length;){let c=r[a++],h=r[a++];c>l&&o.appendChild(document.createTextNode(s.slice(l,c)));let d=o.appendChild(document.createElement("span"));d.appendChild(document.createTextNode(s.slice(c,h))),d.className="cm-completionMatchedText",l=h}return l<s.length&&o.appendChild(document.createTextNode(s.slice(l))),o},position:50},{render(t){if(!t.detail)return null;let n=document.createElement("span");return n.className="cm-completionDetail",n.textContent=t.detail,n},position:80}),e.sort((t,n)=>t.position-n.position).map(t=>t.render)}function yd(i,e,t){if(i<=t)return{from:0,to:i};if(e<0&&(e=0),e<=i>>1){let r=Math.floor(e/t);return{from:r*t,to:(r+1)*t}}let n=Math.floor((i-e)/t);return{from:i-(n+1)*t,to:i-n*t}}class l2{constructor(e,t){this.view=e,this.stateField=t,this.info=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let n=e.state.field(t),{options:r,selected:o}=n.open,s=e.state.facet(Et);this.optionContent=s2(s),this.optionClass=s.optionClass,this.tooltipClass=s.tooltipClass,this.range=yd(r.length,o,s.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",l=>{for(let a=l.target,c;a&&a!=this.dom;a=a.parentNode)if(a.nodeName=="LI"&&(c=/-(\d+)$/.exec(a.id))&&+c[1]<r.length){Ag(e,r[+c[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let a=e.state.field(this.stateField,!1);a&&a.tooltip&&e.state.facet(Et).closeOnBlur&&l.relatedTarget!=e.contentDOM&&e.dispatch({effects:Jr.of(null)})}),this.list=this.dom.appendChild(this.createListBox(r,n.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}mount(){this.updateSel()}update(e){var t,n,r;let o=e.state.field(this.stateField),s=e.startState.field(this.stateField);this.updateTooltipClass(e.state),o!=s&&(this.updateSel(),((t=o.open)===null||t===void 0?void 0:t.disabled)!=((n=s.open)===null||n===void 0?void 0:n.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!(!((r=o.open)===null||r===void 0)&&r.disabled)))}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let n of this.currentClass.split(" "))n&&this.dom.classList.remove(n);for(let n of t.split(" "))n&&this.dom.classList.add(n);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=yd(t.options.length,t.selected,this.view.state.facet(Et).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(t.options,e.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})),this.updateSelectedOption(t.selected)){this.info&&(this.info.remove(),this.info=null);let{completion:n}=t.options[t.selected],{info:r}=n;if(!r)return;let o=typeof r=="string"?document.createTextNode(r):r(n);if(!o)return;"then"in o?o.then(s=>{s&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(s)}).catch(s=>Qt(this.view.state,s,"completion info")):this.addInfoPane(o)}}addInfoPane(e){let t=this.info=document.createElement("div");t.className="cm-tooltip cm-completionInfo",t.appendChild(e),this.dom.appendChild(t),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let n=this.list.firstChild,r=this.range.from;n;n=n.nextSibling,r++)n.nodeName!="LI"||!n.id?r--:r==e?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),t=n):n.hasAttribute("aria-selected")&&n.removeAttribute("aria-selected");return t&&c2(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),r=e.getBoundingClientRect(),o=this.space;if(!o){let s=this.dom.ownerDocument.defaultView||window;o={left:0,top:0,right:s.innerWidth,bottom:s.innerHeight}}return r.top>Math.min(o.bottom,t.bottom)-10||r.bottom<Math.max(o.top,t.top)+10?null:this.view.state.facet(Et).positionInfo(this.view,t,r,n,o)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,n){const r=document.createElement("ul");r.id=t,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true"),r.setAttribute("aria-label",this.view.state.phrase("Completions"));let o=null;for(let s=n.from;s<n.to;s++){let{completion:l,match:a}=e[s],{section:c}=l;if(c){let u=typeof c=="string"?c:c.name;if(u!=o&&(s>n.from||n.from==0))if(o=u,typeof c!="string"&&c.header)r.appendChild(c.header(c));else{let f=r.appendChild(document.createElement("completion-section"));f.textContent=u}}const h=r.appendChild(document.createElement("li"));h.id=t+"-"+s,h.setAttribute("role","option");let d=this.optionClass(l);d&&(h.className=d);for(let u of this.optionContent){let f=u(l,this.view.state,a);f&&h.appendChild(f)}}return n.from&&r.classList.add("cm-completionListIncompleteTop"),n.to<e.length&&r.classList.add("cm-completionListIncompleteBottom"),r}}function a2(i){return e=>new l2(e,i)}function c2(i,e){let t=i.getBoundingClientRect(),n=e.getBoundingClientRect();n.top<t.top?i.scrollTop-=t.top-n.top:n.bottom>t.bottom&&(i.scrollTop+=n.bottom-t.bottom)}function wd(i){return(i.boost||0)*100+(i.apply?10:0)+(i.info?5:0)+(i.type?1:0)}function h2(i,e){let t=[],n=null,r=a=>{t.push(a);let{section:c}=a.completion;if(c){n||(n=[]);let h=typeof c=="string"?c:c.name;n.some(d=>d.name==h)||n.push(typeof c=="string"?{name:h}:c)}};for(let a of i)if(a.hasResult())if(a.result.filter===!1){let c=a.result.getMatch;for(let h of a.result.options){let d=[1e9-t.length];if(c)for(let u of c(h))d.push(u);r(new md(h,a,d,d[0]))}}else{let c=new r2(e.sliceDoc(a.from,a.to)),h;for(let d of a.result.options)(h=c.match(d.label))&&r(new md(d,a,h,h[0]+(d.boost||0)))}if(n){let a=Object.create(null),c=0,h=(d,u)=>{var f,g;return((f=d.rank)!==null&&f!==void 0?f:1e9)-((g=u.rank)!==null&&g!==void 0?g:1e9)||(d.name<u.name?-1:1)};for(let d of n.sort(h))c-=1e5,a[d.name]=c;for(let d of t){let{section:u}=d.completion;u&&(d.score+=a[typeof u=="string"?u:u.name])}}let o=[],s=null,l=e.facet(Et).compareCompletions;for(let a of t.sort((c,h)=>h.score-c.score||l(c.completion,h.completion)))!s||s.label!=a.completion.label||s.detail!=a.completion.detail||s.type!=null&&a.completion.type!=null&&s.type!=a.completion.type||s.apply!=a.completion.apply?o.push(a):wd(a.completion)>wd(s)&&(o[o.length-1]=a),s=a.completion;return o}class jn{constructor(e,t,n,r,o,s){this.options=e,this.attrs=t,this.tooltip=n,this.timestamp=r,this.selected=o,this.disabled=s}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new jn(this.options,xd(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,n,r,o){let s=h2(e,t);if(!s.length)return r&&e.some(a=>a.state==1)?new jn(r.options,r.attrs,r.tooltip,r.timestamp,r.selected,!0):null;let l=t.facet(Et).selectOnOpen?0:-1;if(r&&r.selected!=l&&r.selected!=-1){let a=r.options[r.selected].completion;for(let c=0;c<s.length;c++)if(s[c].completion==a){l=c;break}}return new jn(s,xd(n,l),{pos:e.reduce((a,c)=>c.hasResult()?Math.min(a,c.from):a,1e8),create:a2(Yt),above:o.aboveCursor},r?r.timestamp:Date.now(),l,!1)}map(e){return new jn(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class bs{constructor(e,t,n){this.active=e,this.id=t,this.open=n}static start(){return new bs(f2,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,n=t.facet(Et),r=(n.override||t.languageDataAt("autocomplete",Xi(t)).map(n2)).map(s=>(this.active.find(l=>l.source==s)||new Pt(s,this.active.some(l=>l.state!=0)?1:0)).update(e,n));r.length==this.active.length&&r.every((s,l)=>s==this.active[l])&&(r=this.active);let o=this.open;o&&e.docChanged&&(o=o.map(e.changes)),e.selection||r.some(s=>s.hasResult()&&e.changes.touchesRange(s.from,s.to))||!d2(r,this.active)?o=jn.build(r,t,this.id,o,n):o&&o.disabled&&!r.some(s=>s.state==1)&&(o=null),!o&&r.every(s=>s.state!=1)&&r.some(s=>s.hasResult())&&(r=r.map(s=>s.hasResult()?new Pt(s.source,0):s));for(let s of e.effects)s.is(Mg)&&(o=o&&o.setSelected(s.value,this.id));return r==this.active&&o==this.open?this:new bs(r,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:u2}}function d2(i,e){if(i==e)return!0;for(let t=0,n=0;;){for(;t<i.length&&!i[t].hasResult;)t++;for(;n<e.length&&!e[n].hasResult;)n++;let r=t==i.length,o=n==e.length;if(r||o)return r==o;if(i[t++].result!=e[n++].result)return!1}}const u2={"aria-autocomplete":"list"};function xd(i,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":i};return e>-1&&(t["aria-activedescendant"]=i+"-"+e),t}const f2=[];function va(i){return i.isUserEvent("input.type")?"input":i.isUserEvent("delete.backward")?"delete":null}class Pt{constructor(e,t,n=-1){this.source=e,this.state=t,this.explicitPos=n}hasResult(){return!1}update(e,t){let n=va(e),r=this;n?r=r.handleUserEvent(e,n,t):e.docChanged?r=r.handleChange(e):e.selection&&r.state!=0&&(r=new Pt(r.source,0));for(let o of e.effects)if(o.is(rc))r=new Pt(r.source,1,o.value?Xi(e.state):-1);else if(o.is(Jr))r=new Pt(r.source,0);else if(o.is(Rg))for(let s of o.value)s.source==r.source&&(r=s);return r}handleUserEvent(e,t,n){return t=="delete"||!n.activateOnTyping?this.map(e.changes):new Pt(this.source,1)}handleChange(e){return e.changes.touchesRange(Xi(e.startState))?new Pt(this.source,0):this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new Pt(this.source,this.state,e.mapPos(this.explicitPos))}}class Er extends Pt{constructor(e,t,n,r,o){super(e,2,t),this.result=n,this.from=r,this.to=o}hasResult(){return!0}handleUserEvent(e,t,n){var r;let o=e.changes.mapPos(this.from),s=e.changes.mapPos(this.to,1),l=Xi(e.state);if((this.explicitPos<0?l<=o:l<this.from)||l>s||t=="delete"&&Xi(e.startState)==this.from)return new Pt(this.source,t=="input"&&n.activateOnTyping?1:0);let a=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos),c;return p2(this.result.validFor,e.state,o,s)?new Er(this.source,a,this.result,o,s):this.result.update&&(c=this.result.update(this.result,o,s,new Cg(e.state,l,a>=0)))?new Er(this.source,a,c,c.from,(r=c.to)!==null&&r!==void 0?r:Xi(e.state)):new Pt(this.source,1,a)}handleChange(e){return e.changes.touchesRange(this.from,this.to)?new Pt(this.source,0):this.map(e.changes)}map(e){return e.empty?this:new Er(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1))}}function p2(i,e,t,n){if(!i)return!1;let r=e.sliceDoc(t,n);return typeof i=="function"?i(r,t,n,e):Sg(i,!0).test(r)}const Rg=Ce.define({map(i,e){return i.map(t=>t.map(e))}}),Mg=Ce.define(),Yt=mt.define({create(){return bs.start()},update(i,e){return i.update(e)},provide:i=>[$a.from(i,e=>e.tooltip),he.contentAttributes.from(i,e=>e.attrs)]});function Eo(i,e="option"){return t=>{let n=t.state.field(Yt,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<t.state.facet(Et).interactionDelay)return!1;let r=1,o;e=="page"&&(o=ap(t,n.open.tooltip))&&(r=Math.max(2,Math.floor(o.dom.offsetHeight/o.dom.querySelector("li").offsetHeight)-1));let{length:s}=n.open.options,l=n.open.selected>-1?n.open.selected+r*(i?1:-1):i?0:s-1;return l<0?l=e=="page"?0:s-1:l>=s&&(l=e=="page"?s-1:0),t.dispatch({effects:Mg.of(l)}),!0}}const g2=i=>{let e=i.state.field(Yt,!1);return i.state.readOnly||!e||!e.open||e.open.selected<0||Date.now()-e.open.timestamp<i.state.facet(Et).interactionDelay?!1:(e.open.disabled||Ag(i,e.open.options[e.open.selected]),!0)},m2=i=>i.state.field(Yt,!1)?(i.dispatch({effects:rc.of(!0)}),!0):!1,v2=i=>{let e=i.state.field(Yt,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(i.dispatch({effects:Jr.of(null)}),!0)};class b2{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const kd=50,y2=50,w2=1e3,x2=ht.fromClass(class{constructor(i){this.view=i,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let e of i.state.field(Yt).active)e.state==1&&this.startQuery(e)}update(i){let e=i.state.field(Yt);if(!i.selectionSet&&!i.docChanged&&i.startState.field(Yt)==e)return;let t=i.transactions.some(n=>(n.selection||n.docChanged)&&!va(n));for(let n=0;n<this.running.length;n++){let r=this.running[n];if(t||r.updates.length+i.transactions.length>y2&&Date.now()-r.time>w2){for(let o of r.context.abortListeners)try{o()}catch(s){Qt(this.view.state,s)}r.context.abortListeners=null,this.running.splice(n--,1)}else r.updates.push(...i.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=e.active.some(n=>n.state==1&&!this.running.some(r=>r.active.source==n.source))?setTimeout(()=>this.startUpdate(),kd):-1,this.composing!=0)for(let n of i.transactions)va(n)=="input"?this.composing=2:this.composing==2&&n.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:i}=this.view,e=i.field(Yt);for(let t of e.active)t.state==1&&!this.running.some(n=>n.active.source==t.source)&&this.startQuery(t)}startQuery(i){let{state:e}=this.view,t=Xi(e),n=new Cg(e,t,i.explicitPos==t),r=new b2(i,n);this.running.push(r),Promise.resolve(i.source(n)).then(o=>{r.context.aborted||(r.done=o||null,this.scheduleAccept())},o=>{this.view.dispatch({effects:Jr.of(null)}),Qt(this.view.state,o)})}scheduleAccept(){this.running.every(i=>i.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),kd))}accept(){var i;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(Et);for(let n=0;n<this.running.length;n++){let r=this.running[n];if(r.done===void 0)continue;if(this.running.splice(n--,1),r.done){let s=new Er(r.active.source,r.active.explicitPos,r.done,r.done.from,(i=r.done.to)!==null&&i!==void 0?i:Xi(r.updates.length?r.updates[0].startState:this.view.state));for(let l of r.updates)s=s.update(l,t);if(s.hasResult()){e.push(s);continue}}let o=this.view.state.field(Yt).active.find(s=>s.source==r.active.source);if(o&&o.state==1)if(r.done==null){let s=new Pt(r.active.source,0);for(let l of r.updates)s=s.update(l,t);s.state!=1&&e.push(s)}else this.startQuery(o)}e.length&&this.view.dispatch({effects:Rg.of(e)})}},{eventHandlers:{blur(i){let e=this.view.state.field(Yt,!1);if(e&&e.tooltip&&this.view.state.facet(Et).closeOnBlur){let t=e.open&&ap(this.view,e.open.tooltip);(!t||!t.dom.contains(i.relatedTarget))&&this.view.dispatch({effects:Jr.of(null)})}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:rc.of(!1)}),20),this.composing=0}}}),k2=he.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),Zr={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},fn=Ce.define({map(i,e){return e.mapPos(i,-1,St.TrackAfter)??void 0}}),oc=new class extends yn{};oc.startSide=1;oc.endSide=-1;const Og=mt.define({create(){return Be.empty},update(i,e){if(e.selection){let t=e.state.doc.lineAt(e.selection.main.head).from,n=e.startState.doc.lineAt(e.startState.selection.main.head).from;t!=e.changes.mapPos(n,-1)&&(i=Be.empty)}i=i.map(e.changes);for(let t of e.effects)t.is(fn)&&(i=i.update({add:[oc.range(t.value,t.value+1)]}));return i}});function C2(){return[A2,Og]}const Cl="()[]{}<>";function Dg(i){for(let e=0;e<Cl.length;e+=2)if(Cl.charCodeAt(e)==i)return Cl.charAt(e+1);return Oa(i<128?i:i+1)}function Tg(i,e){return i.languageDataAt("closeBrackets",e)[0]||Zr}const S2=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),A2=he.inputHandler.of((i,e,t,n)=>{if((S2?i.composing:i.compositionStarted)||i.state.readOnly)return!1;let r=i.state.selection.main;if(n.length>2||n.length==2&&Jt(ut(n,0))==1||e!=r.from||t!=r.to)return!1;let o=O2(i.state,n);return o?(i.dispatch(o),!0):!1}),R2=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let t=Tg(i,i.selection.main.head).brackets||Zr.brackets,n=null,r=i.changeByRange(o=>{if(o.empty){let s=D2(i.doc,o.head);for(let l of t)if(l==s&&Ws(i.doc,o.head)==Dg(ut(l,0)))return{changes:{from:o.head-l.length,to:o.head+l.length},range:z.cursor(o.head-l.length)}}return{range:n=o}});return n||e(i.update(r,{scrollIntoView:!0,userEvent:"delete.backward"})),!n},M2=[{key:"Backspace",run:R2}];function O2(i,e){let t=Tg(i,i.selection.main.head),n=t.brackets||Zr.brackets;for(let r of n){let o=Dg(ut(r,0));if(e==r)return o==r?L2(i,r,n.indexOf(r+r+r)>-1,t):T2(i,r,o,t.before||Zr.before);if(e==o&&Pg(i,i.selection.main.from))return P2(i,r,o)}return null}function Pg(i,e){let t=!1;return i.field(Og).between(0,i.doc.length,n=>{n==e&&(t=!0)}),t}function Ws(i,e){let t=i.sliceString(e,e+2);return t.slice(0,Jt(ut(t,0)))}function D2(i,e){let t=i.sliceString(e-2,e);return Jt(ut(t,0))==t.length?t:t.slice(1)}function T2(i,e,t,n){let r=null,o=i.changeByRange(s=>{if(!s.empty)return{changes:[{insert:e,from:s.from},{insert:t,from:s.to}],effects:fn.of(s.to+e.length),range:z.range(s.anchor+e.length,s.head+e.length)};let l=Ws(i.doc,s.head);return!l||/\s/.test(l)||n.indexOf(l)>-1?{changes:{insert:e+t,from:s.head},effects:fn.of(s.head+e.length),range:z.cursor(s.head+e.length)}:{range:r=s}});return r?null:i.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function P2(i,e,t){let n=null,r=i.changeByRange(o=>o.empty&&Ws(i.doc,o.head)==t?{changes:{from:o.head,to:o.head+t.length,insert:t},range:z.cursor(o.head+t.length)}:n={range:o});return n?null:i.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function L2(i,e,t,n){let r=n.stringPrefixes||Zr.stringPrefixes,o=null,s=i.changeByRange(l=>{if(!l.empty)return{changes:[{insert:e,from:l.from},{insert:e,from:l.to}],effects:fn.of(l.to+e.length),range:z.range(l.anchor+e.length,l.head+e.length)};let a=l.head,c=Ws(i.doc,a),h;if(c==e){if(Cd(i,a))return{changes:{insert:e+e,from:a},effects:fn.of(a+e.length),range:z.cursor(a+e.length)};if(Pg(i,a)){let d=t&&i.sliceDoc(a,a+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:a,to:a+d.length,insert:d},range:z.cursor(a+d.length)}}}else{if(t&&i.sliceDoc(a-2*e.length,a)==e+e&&(h=Sd(i,a-2*e.length,r))>-1&&Cd(i,h))return{changes:{insert:e+e+e+e,from:a},effects:fn.of(a+e.length),range:z.cursor(a+e.length)};if(i.charCategorizer(a)(c)!=Ve.Word&&Sd(i,a,r)>-1&&!B2(i,a,e,r))return{changes:{insert:e+e,from:a},effects:fn.of(a+e.length),range:z.cursor(a+e.length)}}return{range:o=l}});return o?null:i.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function Cd(i,e){let t=gt(i).resolveInner(e+1);return t.parent&&t.from==e}function B2(i,e,t,n){let r=gt(i).resolveInner(e,-1),o=n.reduce((s,l)=>Math.max(s,l.length),0);for(let s=0;s<5;s++){let l=i.sliceDoc(r.from,Math.min(r.to,r.from+t.length+o)),a=l.indexOf(t);if(!a||a>-1&&n.indexOf(l.slice(0,a))>-1){let h=r.firstChild;for(;h&&h.from==r.from&&h.to-h.from>t.length+a;){if(i.sliceDoc(h.to-t.length,h.to)==t)return!1;h=h.firstChild}return!0}let c=r.to==e&&r.parent;if(!c)break;r=c}return!1}function Sd(i,e,t){let n=i.charCategorizer(e);if(n(i.sliceDoc(e-1,e))!=Ve.Word)return e;for(let r of t){let o=e-r.length;if(i.sliceDoc(o,e)==r&&n(i.sliceDoc(o-1,o))!=Ve.Word)return o}return-1}function E2(i={}){return[Yt,Et.of(i),x2,I2,k2]}const Lg=[{key:"Ctrl-Space",run:m2},{key:"Escape",run:v2},{key:"ArrowDown",run:Eo(!0)},{key:"ArrowUp",run:Eo(!1)},{key:"PageDown",run:Eo(!0,"page")},{key:"PageUp",run:Eo(!1,"page")},{key:"Enter",run:g2}],I2=lr.highest(Es.computeN([Et],i=>i.facet(Et).defaultKeymap?[Lg]:[]));class N2{constructor(e,t,n){this.from=e,this.to=t,this.diagnostic=n}}class hn{constructor(e,t,n){this.diagnostics=e,this.panel=t,this.selected=n}static init(e,t,n){let r=e,o=n.facet(Ig).markerFilter;o&&(r=o(r));let s=be.set(r.map(l=>l.from==l.to||l.from==l.to-1&&n.doc.lineAt(l.from).to==l.from?be.widget({widget:new K2(l),diagnostic:l}).range(l.from):be.mark({attributes:{class:"cm-lintRange cm-lintRange-"+l.severity},diagnostic:l}).range(l.from,l.to)),!0);return new hn(s,t,rr(s))}}function rr(i,e=null,t=0){let n=null;return i.between(t,1e9,(r,o,{spec:s})=>{if(!(e&&s.diagnostic!=e))return n=new N2(r,o,s.diagnostic),!1}),n}function z2(i,e){return!!(i.effects.some(t=>t.is(Bg))||i.changes.touchesRange(e.pos))}function F2(i,e){return i.field(Kt,!1)?e:e.concat(Ce.appendConfig.of(G2))}const Bg=Ce.define(),sc=Ce.define(),Eg=Ce.define(),Kt=mt.define({create(){return new hn(be.none,null,null)},update(i,e){if(e.docChanged){let t=i.diagnostics.map(e.changes),n=null;if(i.selected){let r=e.changes.mapPos(i.selected.from,1);n=rr(t,i.selected.diagnostic,r)||rr(t,null,r)}i=new hn(t,i.panel,n)}for(let t of e.effects)t.is(Bg)?i=hn.init(t.value,i.panel,e.state):t.is(sc)?i=new hn(i.diagnostics,t.value?Vs.open:null,i.selected):t.is(Eg)&&(i=new hn(i.diagnostics,i.panel,t.value));return i},provide:i=>[_r.from(i,e=>e.panel),he.decorations.from(i,e=>e.diagnostics)]}),$2=be.mark({class:"cm-lintRange cm-lintRange-active"});function H2(i,e,t){let{diagnostics:n}=i.state.field(Kt),r=[],o=2e8,s=0;n.between(e-(t<0?1:0),e+(t>0?1:0),(a,c,{spec:h})=>{e>=a&&e<=c&&(a==c||(e>a||t>0)&&(e<c||t<0))&&(r.push(h.diagnostic),o=Math.min(a,o),s=Math.max(c,s))});let l=i.state.facet(Ig).tooltipFilter;return l&&(r=l(r)),r.length?{pos:o,end:s,above:i.state.doc.lineAt(o).to<s,create(){return{dom:j2(i,r)}}}:null}function j2(i,e){return ze("ul",{class:"cm-tooltip-lint"},e.map(t=>zg(i,t,!1)))}const W2=i=>{let e=i.state.field(Kt,!1);(!e||!e.panel)&&i.dispatch({effects:F2(i.state,[sc.of(!0)])});let t=qr(i,Vs.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},Ad=i=>{let e=i.state.field(Kt,!1);return!e||!e.panel?!1:(i.dispatch({effects:sc.of(!1)}),!0)},V2=i=>{let e=i.state.field(Kt,!1);if(!e)return!1;let t=i.state.selection.main,n=e.diagnostics.iter(t.to+1);return!n.value&&(n=e.diagnostics.iter(0),!n.value||n.from==t.from&&n.to==t.to)?!1:(i.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),!0)},U2=[{key:"Mod-Shift-m",run:W2,preventDefault:!0},{key:"F8",run:V2}],Ig=de.define({combine(i){return Object.assign({sources:i.map(e=>e.source)},Ai(i.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:(e,t)=>e?t?n=>e(n)||t(n):e:t}))}});function Ng(i){let e=[];if(i)e:for(let{name:t}of i){for(let n=0;n<t.length;n++){let r=t[n];if(/[a-zA-Z]/.test(r)&&!e.some(o=>o.toLowerCase()==r.toLowerCase())){e.push(r);continue e}}e.push("")}return e}function zg(i,e,t){var n;let r=t?Ng(e.actions):[];return ze("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},ze("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage():e.message),(n=e.actions)===null||n===void 0?void 0:n.map((o,s)=>{let l=!1,a=u=>{if(u.preventDefault(),l)return;l=!0;let f=rr(i.state.field(Kt).diagnostics,e);f&&o.apply(i,f.from,f.to)},{name:c}=o,h=r[s]?c.indexOf(r[s]):-1,d=h<0?c:[c.slice(0,h),ze("u",c.slice(h,h+1)),c.slice(h+1)];return ze("button",{type:"button",class:"cm-diagnosticAction",onclick:a,onmousedown:a,"aria-label":` Action: ${c}${h<0?"":` (access key "${r[s]})"`}.`},d)}),e.source&&ze("div",{class:"cm-diagnosticSource"},e.source))}class K2 extends rn{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return ze("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class Rd{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=zg(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Vs{constructor(e){this.view=e,this.items=[];let t=r=>{if(r.keyCode==27)Ad(this.view),this.view.focus();else if(r.keyCode==38||r.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(r.keyCode==40||r.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(r.keyCode==36)this.moveSelection(0);else if(r.keyCode==35)this.moveSelection(this.items.length-1);else if(r.keyCode==13)this.view.focus();else if(r.keyCode>=65&&r.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:o}=this.items[this.selectedIndex],s=Ng(o.actions);for(let l=0;l<s.length;l++)if(s[l].toUpperCase().charCodeAt(0)==r.keyCode){let a=rr(this.view.state.field(Kt).diagnostics,o);a&&o.actions[l].apply(e,a.from,a.to)}}else return;r.preventDefault()},n=r=>{for(let o=0;o<this.items.length;o++)this.items[o].dom.contains(r.target)&&this.moveSelection(o)};this.list=ze("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:n}),this.dom=ze("div",{class:"cm-panel-lint"},this.list,ze("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>Ad(this.view)},"×")),this.update()}get selectedIndex(){let e=this.view.state.field(Kt).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(Kt),n=0,r=!1,o=null;for(e.between(0,this.view.state.doc.length,(s,l,{spec:a})=>{let c=-1,h;for(let d=n;d<this.items.length;d++)if(this.items[d].diagnostic==a.diagnostic){c=d;break}c<0?(h=new Rd(this.view,a.diagnostic),this.items.splice(n,0,h),r=!0):(h=this.items[c],c>n&&(this.items.splice(n,c-n),r=!0)),t&&h.diagnostic==t.diagnostic?h.dom.hasAttribute("aria-selected")||(h.dom.setAttribute("aria-selected","true"),o=h):h.dom.hasAttribute("aria-selected")&&h.dom.removeAttribute("aria-selected"),n++});n<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)r=!0,this.items.pop();this.items.length==0&&(this.items.push(new Rd(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),r=!0),o?(this.list.setAttribute("aria-activedescendant",o.id),this.view.requestMeasure({key:this,read:()=>({sel:o.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:s,panel:l})=>{s.top<l.top?this.list.scrollTop-=l.top-s.top:s.bottom>l.bottom&&(this.list.scrollTop+=s.bottom-l.bottom)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),r&&this.sync()}sync(){let e=this.list.firstChild;function t(){let n=e;e=n.nextSibling,n.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;e!=n.dom;)t();e=n.dom.nextSibling}else this.list.insertBefore(n.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(Kt),n=rr(t.diagnostics,this.items[e].diagnostic);n&&this.view.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:Eg.of(n)})}static open(e){return new Vs(e)}}function q2(i,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(i)}</svg>')`}function Sl(i){return q2(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${i}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const _2=he.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Sl("#d11")},".cm-lintRange-warning":{backgroundImage:Sl("orange")},".cm-lintRange-info":{backgroundImage:Sl("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),G2=[Kt,he.decorations.compute([Kt],i=>{let{selected:e,panel:t}=i.field(Kt);return!e||!t||e.from==e.to?be.none:be.set([$2.range(e.from,e.to)])}),_w(H2,{hideOn:z2}),_2],X2=(()=>[ix(),ox(),Aw(),Ak(),_x(),pw(),yw(),Te.allowMultipleSelections.of(!0),Ex(),Mp(Jx,{fallback:!0}),rk(),C2(),E2(),zw(),Hw(),Pw(),TC(),Es.of([...M2,...AC,...XC,...Ek,...Ux,...Lg,...U2])])();var Y2=i=>{var{theme:e,settings:t={},styles:n=[]}=i,r={".cm-gutters":{}},o={};t.background&&(o.backgroundColor=t.background),t.foreground&&(o.color=t.foreground),(t.background||t.foreground)&&(r["&"]=o),t.fontFamily&&(r["&.cm-editor .cm-scroller"]={fontFamily:t.fontFamily}),t.gutterBackground&&(r[".cm-gutters"].backgroundColor=t.gutterBackground),t.gutterForeground&&(r[".cm-gutters"].color=t.gutterForeground),t.gutterBorder&&(r[".cm-gutters"].borderRightColor=t.gutterBorder),t.caret&&(r[".cm-content"]={caretColor:t.caret},r[".cm-cursor, .cm-dropCursor"]={borderLeftColor:t.caret});var s={};t.gutterActiveForeground&&(s.color=t.gutterActiveForeground),t.lineHighlight&&(r[".cm-activeLine"]={backgroundColor:t.lineHighlight},s.backgroundColor=t.lineHighlight),r[".cm-activeLineGutter"]=s,t.selection&&(r["&.cm-focused .cm-selectionBackground, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={backgroundColor:t.selection}),t.selectionMatch&&(r["& .cm-selectionMatch"]={backgroundColor:t.selectionMatch});var l=he.theme(r,{dark:e==="dark"}),a=ro.define(n),c=[l,Mp(a)];return c},J2={background:"#1e1e1e",foreground:"#9cdcfe",caret:"#c6c6c6",selection:"#6199ff2f",selectionMatch:"#72a1ff59",lineHighlight:"#ffffff0f",gutterBackground:"#1e1e1e",gutterForeground:"#838383",gutterActiveForeground:"#fff",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'};function Z2(i){var{theme:e="dark",settings:t={},styles:n=[]}=i||{};return Y2({theme:e,settings:Rl({},J2,t),styles:[{tag:[P.keyword,P.operatorKeyword,P.modifier,P.color,P.constant(P.name),P.standard(P.name),P.standard(P.tagName),P.special(P.brace),P.atom,P.bool,P.special(P.variableName)],color:"#569cd6"},{tag:[P.controlKeyword,P.moduleKeyword],color:"#c586c0"},{tag:[P.name,P.deleted,P.character,P.macroName,P.propertyName,P.variableName,P.labelName,P.definition(P.name)],color:"#9cdcfe"},{tag:P.heading,fontWeight:"bold",color:"#9cdcfe"},{tag:[P.typeName,P.className,P.tagName,P.number,P.changed,P.annotation,P.self,P.namespace],color:"#4ec9b0"},{tag:[P.function(P.variableName),P.function(P.propertyName)],color:"#dcdcaa"},{tag:[P.number],color:"#b5cea8"},{tag:[P.operator,P.punctuation,P.separator,P.url,P.escape,P.regexp],color:"#d4d4d4"},{tag:[P.regexp],color:"#d16969"},{tag:[P.special(P.string),P.processingInstruction,P.string,P.inserted],color:"#ce9178"},{tag:[P.angleBracket],color:"#808080"},{tag:P.strong,fontWeight:"bold"},{tag:P.emphasis,fontStyle:"italic"},{tag:P.strikethrough,textDecoration:"line-through"},{tag:[P.meta,P.comment],color:"#6a9955"},{tag:P.link,color:"#6a9955",textDecoration:"underline"},{tag:P.invalid,color:"#ff0000"},...n]})}var Md=Z2();const Q2=xe({__name:"CodeEditor",props:{fs:{},height:{},theme:{},langParserMap:{},extLangMap:{},onCloseUnsaved:{},onErrorSaveFile:{}},setup(i,{expose:e}){const t=i,{fs:n,langParserMap:r,extLangMap:o,onCloseUnsaved:s,onErrorSaveFile:l}=Ms(t),{height:a,theme:c}=As(t);let h;const d=K(),u={};for(const[$,te]of Object.entries(r))u[$]=Ga.define(te);function f($){const te=$.split(".");if(te.length>1){const E=te[te.length-1];if(E in o)return o[E]}return""}const g=[{key:"Mod-s",run:()=>{const $=C.value;return W[$]&&ne($).catch(()=>0),!0}}],x=new Yn;function b(){h.dispatch({effects:x.reconfigure(c.value==="dark"?Md:[])})}Lt(c,()=>{C.value&&b()});const S=new Yn;function A(){return he.theme({"&":{height:a.value}})}function O(){h.dispatch({effects:S.reconfigure(A())})}Lt(a,()=>{C.value&&O()});const R=[X2,Es.of(g),he.updateListener.of($=>{$.docChanged&&(W[C.value].value=$.state.doc.toString()!==v[C.value])})],k=K([]),C=K(""),w=[],D={},v={},W={};Lt(C,($,te)=>{if(te&&(D[te]=h.state),$){h.setState(D[$]),b(),O();const E=w.indexOf($);if(E>=0){for(let V=E;V<w.length-1;++V)w[V]=w[V+1];w[w.length-1]=$}else w.push($)}});async function q($){if(!k.value.includes($)){const te=await n.readFile($),E=new TextDecoder("utf-8",{fatal:!0}).decode(te),V=[...R,x.of(c.value==="dark"?Md:[]),S.of(A())],H=f($);H&&V.push(u[H]);const G=Te.create({doc:E,extensions:V});D[$]=G,v[$]=E,W[$]=K(!1),k.value.push($)}C.value=$}async function ne($){const te=($===C.value?h.state:D[$]).doc.toString();try{await n.writeFile($,te)}catch(E){throw l&&l($),E}v[$]=te,W[$].value=!1}function Y($){delete D[$],k.value=k.value.filter(E=>E!==$);const te=w.indexOf($);w.splice(te,1),$===C.value&&(C.value=w.length?w[w.length-1]:"")}function re($){const te=()=>Y($);W[$].value?s($,()=>ne($).then(()=>Y($)).catch(()=>{}),te):te()}function oe($){return W[$].value?`${$} ⚬`:$}return Yi(()=>{h=new he({parent:d.value})}),e({openFile:q}),($,te)=>vn((si(),bn("div",null,[it(we(i1),{value:C.value,"onUpdate:value":te[0]||(te[0]=E=>C.value=E),type:"card",closable:"",onClose:re},{default:Vt(()=>[(si(!0),bn(Ji,null,Om(k.value,E=>(si(),Rs(we(Go),{key:E,name:E,tab:oe(E)},null,8,["name","tab"]))),128))]),_:1},8,["value"]),Gn("div",{ref_key:"editor",ref:d},null,512)],512)),[[Nr,k.value.length]])}}),eS={style:{display:"flex"}},tS={style:{width:"20%","margin-top":"17px"}},iS=xe({__name:"WasmCodeCore",props:{height:{},theme:{default:void 0},fs:{},langParserMap:{default:()=>({})},extLangMap:{default:()=>({})},onCloseUnsaved:{},onErrorOpenFile:{default:void 0},onErrorNonText:{default:void 0},onErrorSaveFile:{default:void 0},onNewFile:{},onNewFolder:{},onErrorPaste:{default:void 0},onUpload:{},onRename:{},onDeleteFile:{default:(i,e)=>e(i)},onDeleteFolder:{default:(i,e)=>e(i)},onErrorDownload:{default:void 0}},setup(i,{expose:e}){const t=i,{fs:n,onCloseUnsaved:r,onErrorOpenFile:o,onErrorNonText:s,onErrorSaveFile:l,onNewFile:a,onNewFolder:c,onErrorPaste:h,onUpload:d,onRename:u,onDeleteFile:f,onDeleteFolder:g}=Ms(t),{height:x,theme:b}=As(t),S=K(),A=K();async function O(C){try{await A.value.openFile(C)}catch(w){w.name==="TypeError"?s&&s(C):o&&o(C)}}const R=_d(),k=fe(()=>b.value||R.value);return e({expandFolder(C){return S.value.expandFolder(C)}}),(C,w)=>(si(),Rs(we(Xd),{theme:k.value==="dark"?we(Gd):null},{default:Vt(()=>[it(we(Sm),null,{default:Vt(()=>[Gn("div",eS,[Gn("div",tS,[it(Sb,{ref_key:"fm",ref:S,fs:we(n),height:we(x),"on-open-file":O,"on-new-file":we(a),"on-new-folder":we(c),"on-error-paste":we(h),"on-upload":we(d),"on-rename":we(u),"on-delete-file":we(f),"on-delete-folder":we(g),"on-error-download":C.onErrorDownload},null,8,["fs","height","on-new-file","on-new-folder","on-error-paste","on-upload","on-rename","on-delete-file","on-delete-folder","on-error-download"])]),it(Q2,{ref_key:"ce",ref:A,style:{width:"80%"},fs:we(n),height:we(x),theme:k.value,"lang-parser-map":C.langParserMap,"ext-lang-map":C.extLangMap,"on-close-unsaved":we(r),"on-error-save-file":we(l)},null,8,["fs","height","theme","lang-parser-map","ext-lang-map","on-close-unsaved","on-error-save-file"])])]),_:1})]),_:1},8,["theme"]))}}),nS=xe({__name:"WasmCodeWrapper",props:{fs:{},height:{},theme:{},langParserMap:{},extLangMap:{}},setup(i,{expose:e}){const t=K(),n=kv(),r=Hv();function o(k,C,w){n.warning({title:`Do you want to save the changes you made to ${k}?`,content:"Your changes will be lost if you don't save them.",positiveText:"Save",negativeText:"Don't save",onPositiveClick:C,onNegativeClick:w})}function s(k){r.error(`Cannot open ${k}`)}function l(k){r.error(`Non UTF-8 file ${k} can't be opened`)}function a(k){r.error(`Cannot save ${k}`)}function c(k,C,w,D){const v=K(""),W=n.info({title:C,content:()=>[k,m(Dm,{clearable:!0,value:v.value,onKeyup:q=>{q.key==="Enter"&&(D(v.value),W.destroy())},"onUpdate:value":q=>{v.value=q}})],positiveText:w,onPositiveClick:()=>D(v.value)})}function h(k){return(C,w)=>{c(C,`Set ${k} name`,"Create",D=>w(C+D).catch(v=>{v.name==="PathExistsError"?r.error("Name already exists in the folder"):r.error(`Cannot create ${k}`)}))}}const d=h("file"),u=h("folder");function f(k){r.error(`Cannot paste under ${k}`)}const g=K([]);function x(k,C){n.info({title:"Select files to upload",content:()=>[k,m(H1,{multiple:!0,fileList:g.value,"onUpdate:fileList":w=>{g.value=w}},[m(Ou,["Click, or drag files to this area"])])],positiveText:"Upload",negativeText:"Clear all",onPositiveClick:async()=>{const w=await Promise.all(g.value.map(async D=>({name:D.name,content:new Uint8Array(await D.file.arrayBuffer())})));try{await C(w),g.value=[]}catch{r.error(`Cannot upload to ${k}`)}},onNegativeClick:()=>(g.value=[],!1)})}function b(k,C){c(k,"Set new name","Rename",w=>C(w).catch(()=>r.error("Cannot rename")))}function S(k){return(C,w)=>{const D=n.warning({title:`Are you sure you want to delete ${C}?`,content:`The ${k} cannot be restored.`,positiveText:"Delete",negativeText:"Cancel",onPositiveClick:()=>w(C).catch(()=>r.error(`Cannot remove ${k}`)),onNegativeClick:()=>D.destroy()})}}const A=S("file"),O=S("folder");function R(k){r.error(`Cannot download ${k}`)}return e({expandFolder(k){return t.value.expandFolder(k)}}),(k,C)=>(si(),Rs(iS,{ref_key:"wcc",ref:t,fs:k.fs,theme:k.theme,height:k.height,"lang-parser-map":k.langParserMap,"ext-lang-map":k.extLangMap,"on-close-unsaved":o,"on-error-open-file":s,"on-error-non-text":l,"on-error-save-file":a,"on-new-file":we(d),"on-new-folder":we(u),"on-error-paste":f,"on-upload":x,"on-rename":b,"on-delete-file":we(A),"on-delete-folder":we(O),"on-error-download":R},null,8,["fs","theme","height","lang-parser-map","ext-lang-map","on-new-file","on-new-folder","on-delete-file","on-delete-folder"]))}}),rS=xe({__name:"WasmCode",props:{fs:{},height:{},theme:{default:void 0},langParserMap:{default:()=>({})},extLangMap:{default:()=>({})}},setup(i,{expose:e}){const t=i,{theme:n}=As(t),r=_d(),o=fe(()=>n.value||r.value),s=K();return e({expandFolder(l){return s.value.expandFolder(l)}}),(l,a)=>(si(),Rs(we(Xd),{theme:o.value==="dark"?we(Gd):null},{default:Vt(()=>[it(we(xv),null,{default:Vt(()=>[it(we($v),null,{default:Vt(()=>[it(nS,{ref_key:"wcw",ref:s,fs:l.fs,theme:o.value,height:l.height,"lang-parser-map":l.langParserMap,"ext-lang-map":l.extLangMap},null,8,["fs","theme","height","lang-parser-map","ext-lang-map"])]),_:1})]),_:1})]),_:1},8,["theme"]))}}),sS=xe({__name:"MyEditor",props:{menu:{}},setup(i){const e=i,t={json:j1,lua:X1,yaml:Z1},n={json:"json",lua:"lua",yaml:"yaml"},{menu:r}=Ms(e),o=jv();Tm.control("deployStatus",async(l,a)=>{const c={duration:5e3,keepAliveOnHover:!0};switch(l){case"start":o.info({content:"Deployment started",...c}),r==null||r.setLoading(!0);break;case"failure":o.error({content:"Deployment failed",...c}),r==null||r.setLoading(!1);break;case"success":o.success({content:"Deployment succeeded",...c}),Pm.value=!0,fc.value=[];{const h=JSON.parse(a);for(const u of h)fc.value.push({label:u.name,value:u.id});const d=h[0].id;await Lm(d),r==null||r.displayIME(d)}r==null||r.setLoading(!1);break}});const s=K();return Yi(()=>{["/","/rime/","/usr/","/usr/local/","/usr/local/share/","/usr/local/share/opencc/"].forEach(s.value.expandFolder)}),(l,a)=>(si(),bn("div",null,[it(we(wi),{secondary:"",type:"info",onClick:a[0]||(a[0]=c=>we(Em)())},{default:Vt(()=>[Bm(" Deploy ")]),_:1}),it(we(rS),{ref_key:"wc",ref:s,fs:we(Im),height:"80vh","lang-parser-map":t,"ext-lang-map":n},null,8,["fs"])]))}});export{sS as default};
